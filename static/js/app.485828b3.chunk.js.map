{"version":3,"sources":["D2App/components/App/App.module.css","D2App/styles/theme.js","D2App/constants/actions.js","D2App/constants/development.js","D2App/utils/helpers.js","D2App/utils/createRecipientSearchQuery.js","D2App/api/api.js","D2App/actions/index.js","D2App/components/Common/CustomSnackBar.js","D2App/utils/history.js","D2App/components/Attachments/Attachments.js","D2App/components/MessageConversation/Message.js","D2App/components/Attachments/AttachmentUploadButton.js","D2App/components/MessageConversation/ReplyCard.js","D2App/components/Common/SuggestionField.js","D2App/components/Common/ExtendedChoiceLabel.js","D2App/styles/messageConversationStyles.js","D2App/components/MessageConversation/MessageConversation.js","D2App/components/List/MessageTypeItem.js","D2App/components/List/SidebarList.js","D2App/styles/style.js","D2App/components/List/ListItemHeader.js","D2App/components/List/MessageConversationListItem.js","D2App/components/List/MessageConversationList.js","D2App/components/MessageConversation/CreateMessage.js","D2App/constants/extendedChoices.js","D2App/components/Common/DialogWithReduxState.js","D2App/components/Common/AssignToDialog.js","D2App/components/Common/ToolbarExtendedChoicePicker.js","D2App/components/Common/Toolbar.js","D2App/components/MessagingCenter/MessagingCenter.js","D2App/components/App/Routes.js","D2App/components/App/App.js","D2App/constants/messageTypes.js","D2App/reducers/messageReducer.js","D2App/store.js","D2App/components/App/AppWrapper.js"],"names":["module","exports","getMuiTheme","palette","negative","pinkA200","blue50","primary1Color","primary2Color","blue100","primary3Color","blue300","primary4Color","blue500","accent1Color","grey50","accent2Color","grey100","accent3Color","grey300","accent4Color","grey500","followUp","orange500","darkGray","grey700","superDarkGray","grey900","textColor","darkBlack","alternateTextColor","white","canvasColor","borderColor","clockCircleColor","fade","shadowColor","fullBlack","SET_CURRENT_USER","SET_CURRENT_USER_SUCCESS","SET_CURRENT_USER_ERROR","LOAD_MESSAGE_CONVERSATIONS","MESSAGE_CONVERSATIONS_LOAD_SUCCESS","MESSAGE_CONVERSATIONS_DELETE_SUCCESS","MESSAGE_CONVERSATIONS_DELETE_ERROR","MESSAGE_CONVERSATION_UPDATE_SUCCESS","MESSAGE_CONVERSATION_UPDATE_ERROR","SEND_MESSAGE_SUCCESS","SEND_MESSAGE_ERROR","SET_FILTER","DISPLAY_SNACK_MESSAGE","CLEAR_SNACK_MESSAGE","SET_CHECKED","SET_ALL_CHECKED","CLEAR_CHECKED","SET_SELECTED_MESSAGE_TYPE","CLEAR_SELECTED_MESSAGE_CONVERSATION","SET_SELECTED_MESSAGE_CONVERSATION","SET_SELECTED_MESSAGE_CONVERSATION_SUCCESS","UPDATE_INPUT_FIELDS","SET_IN_FEEDBACK_RECIPIENT_GROUP","SET_DISPLAY_TIME_DIFF_SUCCESS","ADD_RECIPIENT_BY_ID_SUCCESS","ADD_ATTACHMENT","ADD_ATTACHMENT_SUCCESS","ADD_ATTACHMENT_ERROR","REMOVE_ATTACHMENT","CLEAR_ATTACHMENTS","CANCEL_ATTACHMENT","SET_DHIS2_CORE_VERSION","fontFamily","NEUTRAL","POSITIVE","NEGATIVE","findIndexOfId","list","id","len","length","index","debounce","fn","delay","timer","context","this","args","arguments","clearTimeout","setTimeout","apply","supportsAttachments","dhis2CoreVersion","createOrganisationUnitQuery","searchValue","resource","params","fields","pageSize","filter","createUserGroupQuery","initialMessageConversationFields","messageConversationFields","engine","getMessageConversations","async","messageType","page","messageFilter","status","priority","assignedToMeFilter","markedForFollowUpFilter","unreadFilter","currentUser","push","query","order","queryString","messageConversations","updateMessageConversationAssignee","messageConversationId","value","mutation","type","userId","mutate","searchRecipients","searchOnlyUsers","searchOnlyFeedbackRecipients","feedbackRecipientsId","userQuery","supportsUserLookupEndPoint","createUserQuery","users","organisationUnits","userGroups","createRecipientSearchQuery","results","addRecipients","data","createAction","payload","setSelectedMessageConversation","messageConversation","dispatch","actions","result","api","error","loadMessageConversations","selectedMessageType","loadMore","getState","promises","state","statusFilter","priorityFilter","messaging","i","promise","then","pager","Promise","all","nrOfUnread","total","reduce","accumulated","r","concat","markMessageConversations","mode","markedConversations","markedReadConversations","markedUnreadConversations","addAttachment","attachment","domain","file","response","fileResource","name","contentLength","clearCheckedIds","clearSelectedMessageConversation","displaySnackMessage","message","onSnackActionClick","onSnackRequestClose","snackType","setFilter","filterType","updateInputFields","subject","input","recipients","clearAttachments","setSelectedMessageType","messageTypeId","removeAttachment","attachmentId","cancelAttachment","attachmentName","contentColorStyle","theme","CustomSnackBar","Component","constructor","props","super","closeMessage","clearSnackMessage","setState","show","componentDidUpdate","_prevProps","prevState","render","open","autoHideDuration","onRequestClose","action","onActionClick","contentStyle","color","style","pointerEvents","whiteSpace","bodyStyle","maxWidth","compose","connect","snackMessage","pure","createHashHistory","Attachment","dataDirection","downloadAttachment","className","backgroundColor","label","parseFloat","parseInt","toFixed","labelPosition","onClick","loading","icon","Attachments","attachments","map","styles","canvas","padding","innerCanvas","margin","paddingBottom","cardText","wordBreak","fromFormat","datePlacement","display","justifyContent","marginRight","dateFormat","overflow","textOverflow","Message","displayTimeDiff","lastMessage","enableAttachments","fromTitle","sender","displayName","today","moment","messageDate","created","add","internal","i18n","t","placement","diff","from","format","year","paddingLeft","text","createHandleChange","event","files","target","AttachmentUploadButton","containerElement","onChange","ReplyCard","replyMessage","internalReply","selectedMessageConversation","wipeInput","inputError","texFieldUpdate","newValue","handleDiscard","discardState","expanded","componentWillUnmount","Card","marginTop","rows","underlineShow","multiLine","fullWidth","floatingLabelText","primary","disabled","isInFeedbackRecipientGroup","messageTypes","SuggestionField","searchResult","lastSearch","errorText","undefined","debouncedSearch","search","bind","onSuggestionClick","chip","find","recipient","updateRecipients","onRemoveChip","updateInput","addType","internalSearchResult","searchWarning","height","inputHeight","marginBottom","openOnFocus","searchText","dataSource","dataSourceConfig","onUpdateInput","onRequestAdd","onRequestDelete","subheaderTitle","paddingRight","subheader","fontWeight","ExtendedChoiceLabel","showTitle","title","displayLabel","charAt","toLowerCase","substr","flex","overflowY","overflowX","paddingTop","flexDirection","header","iconButton","alignSelf","subjectSubheader","fontSize","participantsCanvas","participants","flexWrap","participantAddRow","participantsSuggestionField","participantsAdd","messagesCanvas","messagesInnerCanvas","NOTIFICATIONS","MessageConversation","backToList","history","cursor","messages","notification","indexOf","userMessages","slice","userMessage","recipientsExpanded","user","userMessagesLength","tooltipPosition","tooltip","displayExtendedChoices","assignee","participant","limitSearchArray","messageId","filePath","parts","part","replace","join","joinPath","link","baseUrl","apiPath","document","createElement","href","download","split","pop","body","appendChild","click","removeChild","MessageTypeItem","onMouseEnter","setHoverText","onMouseLeave","setNeutralText","setTextColor","getBackgroundColor","selectedValue","role","alignItems","marginLeft","size","unread","badgeContent","secondary","badgeStyle","borderLeftStyle","borderLeftWidth","borderLeftColor","borderRightStyle","borderRightWidth","borderRightColor","minWidth","SidebarList","match","List","width","refreshTimer","toggled","autoRefresh","onToggle","setAutoRefresh","messagePanelContainer","transition","boxSizing","position","boxShadow","borderBottom","checkBox","extendedLabel","MessageConversationListItem","allChecked","checkedIds","checked","onCheck","setAllChecked","child","messageConversationIds","container","wideview","flag","fontColor","flexBasis","textAlign","read","lastSender","x","containerBackgroundColor","innerText","settingSelectedMessageConversation","setChecked","MessageConversationList","onScroll","messageList","getElementById","isBottom","loaded","debouncedOnScroll","el","scrollHeight","scrollTop","window","outerHeight","Array","isArray","lookup","Set","item","has","dedupeById","ListItemHeader","messageTypeField","CreateMessage","subjectUpdate","inputUpdate","sendMessage","isMessageFeedback","sendFeedbackMessage","componentDidMount","addRecipientByUserId","recipientId","discardDisabled","console","extendedChoices","STATUS","key","primaryText","PRIORITY","DialogWithReduxState","Consumer","ctx","store","children","AssignToDialog","updateMessageConversations","nrSelected","ToolbarExtendedChoicePicker","getIds","updateMessageConversation","identifier","ids","toggleDialog","dialogOpen","checkedItems","assignToOpen","multiSelect","actionButtons","keyboardFocused","deleteMessageConversations","displayNumberOfCheckedIds","modal","iconButtonElement","anchorOrigin","horizontal","vertical","targetOrigin","rightIcon","menuItems","elem","currentUserId","messageConversationStatus","messageConversationPriority","log","checkedOptions","zIndex","checkedOption","filterControl","rightHandCanvas","ie11Spacer","flexGrow","iconMenu","Toolbar","lastMessageFilter","prevProps","displaySearch","labelStyle","top","selectedMenuItemStyle","floatingLabelStyle","iconStyle","hintText","menuStyle","toogleWideview","EXTENDED_CHOICES","refreshTimerTotal","refreshTimerInterval","MessagingCenter","intervalId","clearInterval","setInterval","tick","refresh","selectedId","initialMessageConversation","configuration","feedbackRecipients","authorized","authorities","includes","some","setIsInFeedbackRecipientGroup","setDisplayTimeDiff","drawerOpen","disableLink","serverDate","systemInfo","Routes","exact","path","component","to","setCurrentUser","setDhis2CoreVersion","version","serverVersion","useConfig","useEffect","minor","classes","center","cx","initialState","messageReducer","stateMessageTypes","oldAttachments","replaceMessageType","splice","element","selectedMessageConversations","loadingMessageType","middlewares","ReduxThunk","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","reducer","combineReducers","createStore","applyMiddleware","AppWrapper","useDataEngine","muiTheme"],"mappings":"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","file":"static/js/app.485828b3.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"center\":\"App_center__1snml\",\"error\":\"App_error__1usCm\"};","import getMuiTheme from 'material-ui/styles/getMuiTheme';\nimport { fade } from 'material-ui/utils/colorManipulator';\nimport { blue50, blue100, blue300, blue500, pinkA200, grey50, grey100, grey300, grey500, grey700, grey900, orange500, white, darkBlack, fullBlack } from 'material-ui/styles/colors';\nexport default getMuiTheme({\n  palette: {\n    negative: pinkA200,\n    blue50,\n    primary1Color: '#1D8BF1',\n    primary2Color: blue100,\n    primary3Color: blue300,\n    primary4Color: blue500,\n    accent1Color: grey50,\n    accent2Color: grey100,\n    accent3Color: grey300,\n    accent4Color: grey500,\n    followUp: orange500,\n    darkGray: grey700,\n    superDarkGray: grey900,\n    textColor: darkBlack,\n    alternateTextColor: white,\n    canvasColor: white,\n    borderColor: grey300,\n    clockCircleColor: fade(darkBlack, 0.07),\n    shadowColor: fullBlack\n  }\n});","export const SET_CURRENT_USER = 'SET_CURRENT_USER';\nexport const SET_CURRENT_USER_SUCCESS = 'SET_CURRENT_USER_SUCCESS';\nexport const SET_CURRENT_USER_ERROR = 'SET_CURRENT_USER_ERROR';\nexport const LOAD_MESSAGE_CONVERSATIONS = 'LOAD_MESSAGE_CONVERSATIONS';\nexport const LOAD_MORE_MESSAGE_CONVERSATIONS = 'LOAD_MORE_MESSAGE_CONVERSATIONS';\nexport const MESSAGE_CONVERSATIONS_LOAD_SUCCESS = 'MESSAGE_CONVERSATIONS_LOAD_SUCCESS';\nexport const MESSAGE_CONVERSATIONS_LOAD_ERROR = 'MESSAGE_CONVERSATIONS_LOAD_ERROR';\nexport const DELETE_MESSAGE_CONVERSATIONS = 'DELETE_MESSAGE_CONVERSATIONS';\nexport const MESSAGE_CONVERSATIONS_DELETE_SUCCESS = 'MESSAGE_CONVERSATIONS_DELETE_SUCCESS';\nexport const MESSAGE_CONVERSATIONS_DELETE_ERROR = 'MESSAGE_CONVERSATIONS_DELETE_ERROR';\nexport const UPDATE_MESSAGE_CONVERSATIONS = 'UPDATE_MESSAGE_CONVERSATIONS';\nexport const MESSAGE_CONVERSATION_UPDATE_SUCCESS = 'MESSAGE_CONVERSATION_UPDATE_SUCCESS';\nexport const MESSAGE_CONVERSATION_UPDATE_ERROR = 'MESSAGE_CONVERSATION_UPDATE_ERROR';\nexport const MARK_MESSAGE_CONVERSATIONS = 'MARK_MESSAGE_CONVERSATIONS';\nexport const MARK_MESSAGE_CONVERSATIONS_SUCCESS = 'MARK_MESSAGE_CONVERSATIONS_SUCCESS';\nexport const MARK_MESSAGE_CONVERSATIONS_ERROR = 'MARK_MESSAGE_CONVERSATIONS_ERROR';\nexport const SEND_MESSAGE = 'SEND_MESSAGE';\nexport const SEND_MESSAGE_SUCCESS = 'SEND_MESSAGE_SUCCESS';\nexport const SEND_MESSAGE_ERROR = 'SEND_MESSAGE_ERROR';\nexport const SEND_FEEDBACK_MESSAGE = 'SEND_FEEDBACK_MESSAGE';\nexport const REPLY_MESSAGE = 'REPLY_MESSAGE';\nexport const REPLY_MESSAGE_SUCCESS = 'REPLY_MESSAGE_SUCCESS';\nexport const REPLY_MESSAGE_ERROR = 'REPLY_MESSAGE_ERROR';\nexport const SET_FILTER = 'SET_FILTER';\nexport const DISPLAY_SNACK_MESSAGE = 'DISPLAY_SNACK_MESSAGE;';\nexport const CLEAR_SNACK_MESSAGE = 'CLEAR_SNACK_MESSAGE';\nexport const SET_CHECKED = 'SET_CHECKED';\nexport const SET_ALL_CHECKED = 'SET_ALL_CHECKED';\nexport const CLEAR_CHECKED = 'CLEAR_CHECKED';\nexport const SET_SELECTED_MESSAGE_TYPE = 'SET_SELECTED_MESSAGE_TYPE';\nexport const CLEAR_SELECTED_MESSAGE_CONVERSATION = 'CLEAR_SELECTED_MESSAGE_CONVERSATION';\nexport const SET_SELECTED_MESSAGE_CONVERSATION = 'SET_SELECTED_MESSAGE_CONVERSATION';\nexport const SET_SELECTED_MESSAGE_CONVERSATION_SUCCESS = 'SET_SELECTED_MESSAGE_CONVERSATION_SUCCESS';\nexport const SET_SELECTED_MESSAGE_CONVERSATION_ERROR = 'SET_SELECTED_MESSAGE_CONVERSATION_ERROR';\nexport const UPDATE_INPUT_FIELDS = 'UPDATE_INPUT_FIELDS';\nexport const SET_IN_FEEDBACK_RECIPIENT_GROUP = 'SET_IN_FEEDBACK_RECIPIENT_GROUP';\nexport const SET_DISPLAY_TIME_DIFF = 'SET_DISPLAY_TIME_DIFF';\nexport const SET_DISPLAY_TIME_DIFF_SUCCESS = 'SET_DISPLAY_TIME_DIFF_SUCCESS';\nexport const SET_DISPLAY_TIME_DIFF_ERROR = 'SET_DISPLAY_TIME_DIFF_ERROR';\n/* Recipient actions */\n\nexport const RECIPIENT_SEARCH = 'RECIPIENT_SEARCH';\nexport const RECIPIENT_SEARCH_SUCCESS = 'RECIPIENT_SEARCH_SUCCESS';\nexport const RECIPIENT_SEARCH_ERROR = 'RECIPIENT_SEARCH_ERROR';\nexport const ADD_RECIPIENTS = 'ADD_RECIPIENTS';\nexport const ADD_RECIPIENTS_SUCCESS = 'ADD_RECIPIENTS_SUCCESS';\nexport const ADD_RECIPIENTS_ERROR = 'ADD_RECIPIENTS_ERROR';\nexport const ADD_RECIPIENT_BY_ID_SUCCESS = 'ADD_RECIPIENT_BY_ID_SUCCESS';\n/* Attachments */\n\nexport const ADD_ATTACHMENT = 'ADD_ATTACHMENT';\nexport const ADD_ATTACHMENT_SUCCESS = 'ADD_ATTACHMENT_SUCCESS';\nexport const ADD_ATTACHMENT_ERROR = 'ADD_ATTACHMENT_ERROR';\nexport const DOWNLOAD_ATTACHMENT = 'DOWNLOAD_ATTACHMENT';\nexport const DOWNLOAD_ATTACHMENT_SUCCESS = 'DOWNLOAD_ATTACHMENT_SUCCESS';\nexport const DOWNLOAD_ATTACHMENT_ERROR = 'DOWNLOAD_ATTACHMENT_ERROR';\nexport const REMOVE_ATTACHMENT = 'REMOVE_ATTACHMENT';\nexport const CLEAR_ATTACHMENTS = 'CLEAR_ATTACHMENTS';\nexport const CANCEL_ATTACHMENT = 'CANCEL_ATTACHMENT';\n/* DHIS2 CORE VERSION */\n\nexport const SET_DHIS2_CORE_VERSION = 'SET_DHIS2_CORE_VERSION';","export const pageSize = 35;\nexport const fontFamily = 'Roboto, Helvetica, Arial, sans-serif';\nexport const NEUTRAL = 'NEUTRAL';\nexport const POSITIVE = 'POSITIVE';\nexport const NEGATIVE = 'NEGATIVE';","export function dedupeById(list) {\n  if (!Array.isArray(list)) {\n    return undefined;\n  }\n\n  const lookup = new Set();\n  return list.filter(item => {\n    if (lookup.has(item.id)) {\n      return false;\n    }\n\n    lookup.add(item.id);\n    return true;\n  });\n}\nexport function findIndexOfId(list, id) {\n  const len = list.length;\n\n  for (let index = 0; index < len; index++) {\n    if (list[index].id === id) {\n      return index;\n    }\n  }\n\n  return undefined;\n}\nexport function debounce(fn, delay) {\n  let timer = null;\n  return function () {\n    const context = this;\n    const args = arguments;\n    clearTimeout(timer);\n    timer = setTimeout(function () {\n      fn.apply(context, args);\n    }, delay);\n  };\n}\nexport function supportsAttachments(dhis2CoreVersion) {\n  return dhis2CoreVersion > 30;\n}\nexport function supportsUserLookupEndPoint(dhis2CoreVersion) {\n  return dhis2CoreVersion > 34;\n}","import { supportsUserLookupEndPoint } from './helpers.js';\nconst MAX_RECIPIENT = 10;\n\nfunction createUserQuery({\n  searchValue,\n  searchOnlyFeedbackRecipients,\n  feedbackRecipientsId,\n  dhis2CoreVersion\n}) {\n  if (supportsUserLookupEndPoint(dhis2CoreVersion)) {\n    // version >= v2.35\n    return {\n      resource: searchOnlyFeedbackRecipients ? 'userLookup/feedbackRecipients' : 'userLookup',\n      params: {\n        query: searchValue\n      }\n    };\n  } else {\n    // version < 2.35\n    const filter = [`displayName:token:${searchValue}`];\n\n    if (searchOnlyFeedbackRecipients) {\n      filter.push(`userGroups.id:eq:${feedbackRecipientsId}`);\n    }\n\n    return {\n      resource: 'users',\n      params: {\n        filter,\n        pageSize: MAX_RECIPIENT\n      }\n    };\n  }\n}\n\nfunction createOrganisationUnitQuery(searchValue) {\n  return {\n    resource: 'organisationUnits',\n    params: {\n      fields: ['id', 'displayName'],\n      pageSize: MAX_RECIPIENT,\n      filter: [`displayName:token:${searchValue}`, 'users:gte:1']\n    }\n  };\n}\n\nfunction createUserGroupQuery(searchValue) {\n  return {\n    resource: 'userGroups',\n    params: {\n      fields: 'id, displayName',\n      pageSize: MAX_RECIPIENT,\n      filter: [`displayName:token:${searchValue}`]\n    }\n  };\n}\n\nexport default function createRecipientSearchQuery({\n  searchValue,\n  searchOnlyUsers,\n  searchOnlyFeedbackRecipients,\n  feedbackRecipientsId,\n  dhis2CoreVersion\n}) {\n  const userQuery = createUserQuery({\n    searchValue,\n    searchOnlyFeedbackRecipients,\n    feedbackRecipientsId,\n    dhis2CoreVersion\n  });\n  return searchOnlyUsers ? {\n    users: userQuery\n  } : {\n    users: userQuery,\n    organisationUnits: createOrganisationUnitQuery(searchValue),\n    userGroups: createUserGroupQuery(searchValue)\n  };\n}","import { pageSize } from '../constants/development.js';\nimport createRecipientSearchQuery from '../utils/createRecipientSearchQuery.js';\nconst initialMessageConversationFields = ['id', 'displayName', 'subject', 'messageType', 'lastSender[id, displayName]', 'assignee[id, displayName]', 'status', 'priority', 'lastUpdated', 'read', 'lastMessage', 'followUp'];\nconst messageConversationFields = ['*', 'assignee[id, displayName]', 'messages[*,sender[id,displayName]', 'attachments[id, name, contentLength]]', 'userMessages[user[id, displayName]]'];\nconst order = 'lastMessage:desc'; // The rest of the code in this module will expect that\n// engine has been set and can use it safely\n\nlet engine = null;\nexport const setEngine = engineInstance => {\n  engine = engineInstance;\n};\nexport const getCurrentUser = () => engine.query({\n  currentUser: {\n    resource: 'me',\n    params: {\n      fields: ['id', 'authorities', 'userGroups[id]']\n    }\n  }\n});\nexport const getMessageConversations = async ({\n  messageType,\n  page,\n  messageFilter,\n  status,\n  priority,\n  assignedToMeFilter,\n  markedForFollowUpFilter,\n  unreadFilter,\n  currentUser\n}) => {\n  const filter = [`messageType:eq:${messageType}`];\n\n  if (status) {\n    filter.push(`status:eq:${status}`);\n  }\n\n  if (priority) {\n    filter.push(`priority:eq:${priority}`);\n  }\n\n  if (markedForFollowUpFilter) {\n    filter.push('followUp:eq:true');\n  }\n\n  if (unreadFilter) {\n    filter.push('read:eq:false');\n  }\n\n  if (assignedToMeFilter) {\n    filter.push(`assignee.id:eq:${currentUser.id}`);\n  }\n\n  const query = {\n    resource: 'messageConversations',\n    params: {\n      filter,\n      pageSize,\n      page,\n      fields: initialMessageConversationFields,\n      order,\n      queryString: messageFilter\n    }\n  };\n  const {\n    messageConversations\n  } = await engine.query({\n    messageConversations: query\n  });\n  return messageConversations;\n};\nexport const getMessageConversation = async ({\n  id\n}) => {\n  const {\n    messageConversation\n  } = await engine.query({\n    messageConversation: {\n      resource: 'messageConversations',\n      id,\n      params: {\n        fields: messageConversationFields\n      }\n    }\n  });\n  return messageConversation;\n};\nexport const getServerDate = async () => {\n  const {\n    systemInfo\n  } = await engine.query({\n    systemInfo: {\n      resource: 'system/info'\n    }\n  });\n  return systemInfo.serverDate;\n};\nexport const updateMessageConversationStatus = (messageConversationId, value) => engine.mutate({\n  resource: `messageConversations/${messageConversationId}/status`,\n  type: 'create',\n  params: {\n    messageConversationStatus: value\n  }\n});\nexport const updateMessageConversationPriority = (messageConversationId, value) => engine.mutate({\n  resource: `messageConversations/${messageConversationId}/priority`,\n  type: 'create',\n  params: {\n    messageConversationPriority: value\n  }\n});\nexport const updateMessageConversationAssignee = async (messageConversationId, value) => {\n  const mutation = value ? {\n    resource: `messageConversations/${messageConversationId}/assign`,\n    type: 'create',\n    params: {\n      userId: value\n    }\n  } : {\n    resource: `messageConversations`,\n    id: `${messageConversationId}/assign`,\n    type: 'delete'\n  };\n  return await engine.mutate(mutation);\n};\nexport const updateMessageConversationFollowup = (messageConversationIds, value) => engine.mutate({\n  resource: `messageConversations/${value ? 'followup' : 'unfollowup'}`,\n  type: 'create',\n  data: messageConversationIds\n});\nexport const getNrOfUnread = async messageType => {\n  const {\n    messageConversations\n  } = await engine.query({\n    messageConversations: {\n      resource: 'messageConversations',\n      params: {\n        fields: ['read'],\n        filter: ['read:eq:false', `messageType:eq:${messageType}`],\n        pageSize: 1\n      }\n    }\n  });\n  return messageConversations.pager.total;\n};\nexport const sendMessage = ({\n  subject,\n  users,\n  userGroups,\n  organisationUnits,\n  text,\n  attachments\n}) => engine.mutate({\n  resource: 'messageConversations',\n  type: 'create',\n  data: {\n    subject,\n    users,\n    userGroups,\n    organisationUnits,\n    text,\n    attachments\n  }\n});\nexport const sendFeedbackMessage = (subject, text) => engine.mutate({\n  resource: 'messageConversations/feedback',\n  type: 'create',\n  params: {\n    subject\n  },\n  data: text\n});\nexport const replyMessage = async ({\n  message,\n  internalReply,\n  attachments,\n  id\n}) => {\n  const params = {\n    internal: internalReply\n  };\n\n  if (attachments.length > 0) {\n    params.attachments = attachments;\n  }\n\n  return await engine.mutate({\n    resource: `messageConversations/${id}`,\n    type: 'create',\n    params,\n    data: message\n  });\n};\nexport const deleteMessageConversation = (messageConversationId, currentUserId) => engine.mutate({\n  resource: `messageConversations/${messageConversationId}/${currentUserId}`,\n  type: 'delete'\n});\nexport const markRead = markedReadConversations => engine.mutate({\n  resource: 'messageConversations/read',\n  type: 'create',\n  data: markedReadConversations\n});\nexport const markUnread = markedUnreadConversations => engine.mutate({\n  resource: 'messageConversations/unread',\n  type: 'create',\n  data: markedUnreadConversations\n});\nexport const isInFeedbackRecipientGroup = async currentUser => {\n  const {\n    configuration: {\n      feedbackRecipients\n    }\n  } = await engine.query({\n    configuration: {\n      resource: 'configuration'\n    }\n  });\n  const authorized = currentUser.authorities.includes('ALL') || currentUser.userGroups.some(({\n    id\n  }) => id === feedbackRecipients.id);\n  const feedbackRecipientsId = feedbackRecipients.id;\n  return {\n    authorized,\n    feedbackRecipientsId\n  };\n};\nexport const searchRecipients = async ({\n  searchValue,\n  searchOnlyUsers,\n  searchOnlyFeedbackRecipients,\n  feedbackRecipientsId,\n  dhis2CoreVersion\n}) => {\n  const query = createRecipientSearchQuery({\n    searchValue,\n    searchOnlyUsers,\n    searchOnlyFeedbackRecipients,\n    feedbackRecipientsId,\n    dhis2CoreVersion\n  });\n  const results = await engine.query(query);\n  return {\n    users: results.users?.users,\n    organisationUnits: results?.organisationUnits?.organisationUnits,\n    userGroups: results?.userGroups?.userGroups\n  };\n};\nexport const addRecipients = ({\n  users,\n  userGroups,\n  organisationUnits,\n  messageConversationId\n}) => engine.mutate({\n  resource: `messageConversations/${messageConversationId}/recipients`,\n  type: 'create',\n  data: {\n    users,\n    userGroups,\n    organisationUnits\n  }\n});\nexport const getUserById = async id => {\n  const {\n    user\n  } = await engine.query({\n    user: {\n      resource: 'users',\n      id,\n      params: {\n        fields: 'id,displayName'\n      }\n    }\n  });\n  return { ...user,\n    type: 'user'\n  };\n};\nexport const addAttachment = attachment => engine.mutate({\n  resource: 'fileResources',\n  type: 'create',\n  params: {\n    domain: 'MESSAGE_ATTACHMENT'\n  },\n  data: {\n    file: attachment\n  }\n});\n\nconst joinPath = (...parts) => {\n  const realParts = parts.filter(part => !!part);\n  return realParts.map(part => part.replace(/^\\/+|\\/+$/g, '')).join('/');\n};\n\nexport const downloadAttachment = (messageConversationId, messageId, attachmentId) => {\n  const filePath = joinPath(engine.link.baseUrl, engine.link.apiPath, 'messageConversations', messageConversationId, messageId, 'attachments', attachmentId);\n  const link = document.createElement('a');\n  link.href = filePath;\n  link.download = filePath.split('/').pop();\n  link.target = '_blank';\n  document.body.appendChild(link);\n  link.click();\n  document.body.removeChild(link);\n};","import * as actions from '../constants/actions.js';\nimport log from 'loglevel';\nimport * as api from '../api/api.js';\nimport moment from 'moment'; // Simple hack to solve negative time difference\n\nconst FUTURE_HACK = 5000;\n\nconst createAction = (type, payload) => ({\n  type,\n  payload\n});\n/******************\n * THUNKS SECTION *\n ******************/\n\n\nexport const setCurrentUser = () => async dispatch => {\n  dispatch(createAction(actions.SET_CURRENT_USER));\n\n  try {\n    const {\n      currentUser\n    } = await api.getCurrentUser();\n    dispatch(createAction(actions.SET_CURRENT_USER_SUCCESS, currentUser));\n  } catch {\n    dispatch(createAction(actions.SET_CURRENT_USER_ERROR, 'Could not load current user'));\n  }\n};\nexport const setDisplayTimeDiff = () => async dispatch => {\n  try {\n    const serverDate = await api.getServerDate();\n    const displayTimeDiff = moment().diff(moment(serverDate)) - FUTURE_HACK;\n    dispatch(createAction(actions.SET_DISPLAY_TIME_DIFF_SUCCESS, displayTimeDiff));\n  } catch (error) {\n    dispatch(createAction(actions.SET_DISPLAY_TIME_DIFF_ERROR, {\n      error\n    }));\n  }\n};\nexport const setSelectedMessageConversation = messageConversation => async dispatch => {\n  dispatch(createAction(actions.SET_SELECTED_MESSAGE_CONVERSATION));\n\n  try {\n    const result = await api.getMessageConversation(messageConversation);\n    dispatch(createAction(actions.SET_SELECTED_MESSAGE_CONVERSATION_SUCCESS, {\n      messageConversation: result\n    }));\n  } catch (error) {\n    dispatch(createAction(actions.SET_SELECTED_MESSAGE_CONVERSATION_ERROR, {\n      error\n    }));\n  }\n};\nexport const updateMessageConversations = ({\n  messageConversationIds,\n  identifier,\n  value,\n  messageType,\n  selectedMessageConversation\n}) => async dispatch => {\n  if (identifier === 'FOLLOW_UP') {\n    try {\n      await api.updateMessageConversationFollowup(messageConversationIds, value);\n      dispatch(createAction(actions.MESSAGE_CONVERSATION_UPDATE_SUCCESS, {\n        messageType: messageType,\n        page: 1,\n        identifier: identifier\n      }));\n      dispatch(loadMessageConversations());\n    } catch (error) {\n      dispatch(createAction(actions.MESSAGE_CONVERSATION_UPDATE_ERROR, {\n        error\n      }));\n    }\n  } else {\n    const promises = messageConversationIds.map(messageConversationId => {\n      let promise;\n\n      switch (identifier) {\n        case 'STATUS':\n          promise = api.updateMessageConversationStatus(messageConversationId, value);\n          break;\n\n        case 'PRIORITY':\n          promise = api.updateMessageConversationPriority(messageConversationId, value);\n          break;\n\n        case 'ASSIGNEE':\n          if (value !== undefined && messageType.id === 'VALIDATION_RESULT') {\n            promise = api.addRecipients({\n              users: value.map(value => ({\n                id: value\n              })),\n              userGroups: [],\n              organisationUnits: [],\n              messageConversationId\n            }).then(() => api.updateMessageConversationAssignee(messageConversationId, value));\n          } else {\n            promise = api.updateMessageConversationAssignee(messageConversationId, value);\n          }\n\n          break;\n\n        default:\n          log.error('Unexpected identifier for updateMessageConversations');\n          break;\n      }\n\n      return promise;\n    });\n\n    try {\n      await Promise.all(promises);\n      dispatch(createAction(actions.MESSAGE_CONVERSATION_UPDATE_SUCCESS, {\n        messageType: messageType,\n        page: 1,\n        identifier: identifier\n      }));\n      dispatch(loadMessageConversations());\n    } catch (error) {\n      dispatch(createAction(actions.MESSAGE_CONVERSATION_UPDATE_ERROR, {\n        error\n      }));\n    }\n  }\n\n  if (selectedMessageConversation) {\n    dispatch(setSelectedMessageConversation(selectedMessageConversation));\n  }\n};\nexport const loadMessageConversations = (messageType, selectedMessageType, loadMore = false) => async (dispatch, getState) => {\n  const promises = [];\n  const state = getState();\n  const {\n    messageFilter,\n    statusFilter: status,\n    priorityFilter: priority,\n    assignedToMeFilter,\n    markedForFollowUpFilter,\n    unreadFilter,\n    currentUser\n  } = state.messaging; // Default fallback values so this action can be called without arguments\n\n  messageType = messageType || state.messaging.selectedMessageType;\n  selectedMessageType = selectedMessageType || state.messaging.selectedMessageType.id;\n  dispatch(createAction(actions.LOAD_MESSAGE_CONVERSATIONS, {\n    messageType,\n    loadMore\n  }));\n\n  try {\n    for (let i = 1; i <= messageType.page; i++) {\n      const promise = api.getMessageConversations({\n        messageType: messageType.id,\n        page: i,\n        messageFilter,\n        status,\n        priority,\n        assignedToMeFilter,\n        markedForFollowUpFilter,\n        unreadFilter,\n        currentUser\n      }).then(result => ({\n        messageConversations: result.messageConversations,\n        pager: result.pager\n      }));\n      promises.push(promise);\n    }\n\n    const result = await Promise.all(promises);\n    const nrOfUnread = await api.getNrOfUnread(messageType.id);\n    const messageConversations = result.reduce((accumulated, r) => accumulated.concat(r.messageConversations), []);\n    dispatch(createAction(actions.MESSAGE_CONVERSATIONS_LOAD_SUCCESS, {\n      messageConversations,\n      pager: result[result.length - 1].pager,\n      messageType,\n      selectedMessageType,\n      nrOfUnread\n    }));\n  } catch (error) {\n    dispatch(createAction(actions.MESSAGE_CONVERSATIONS_LOAD_ERROR, {\n      error\n    }));\n  }\n};\nexport const deleteMessageConversations = (messageConversationIds, messageType) => async (dispatch, getState) => {\n  try {\n    const state = getState();\n    const {\n      currentUser\n    } = state.messaging;\n    const promises = messageConversationIds.map(messageConversationId => api.deleteMessageConversation(messageConversationId, currentUser.id));\n    await Promise.all(promises);\n    dispatch(createAction(actions.MESSAGE_CONVERSATIONS_DELETE_SUCCESS, {\n      messageType: messageType,\n      page: 1\n    }));\n    dispatch(loadMessageConversations());\n  } catch (error) {\n    dispatch(createAction(actions.MESSAGE_CONVERSATIONS_DELETE_ERROR, {\n      error\n    }));\n  }\n};\nexport const sendMessage = ({\n  users,\n  userGroups,\n  organisationUnits,\n  messageType\n}) => async (dispatch, getState) => {\n  try {\n    const {\n      messaging: {\n        subject,\n        input,\n        attachments\n      }\n    } = getState();\n    await api.sendMessage({\n      subject,\n      users,\n      userGroups,\n      organisationUnits,\n      text: input,\n      attachments\n    });\n    dispatch(createAction(actions.SEND_MESSAGE_SUCCESS, {\n      messageType,\n      page: 1\n    }));\n    dispatch(loadMessageConversations());\n  } catch (error) {\n    dispatch(createAction(actions.SEND_MESSAGE_ERROR, {\n      error\n    }));\n  }\n};\nexport const sendFeedbackMessage = messageType => async (dispatch, getState) => {\n  const state = getState();\n\n  try {\n    await api.sendFeedbackMessage(state.messaging.subject, state.messaging.input);\n    dispatch(createAction(actions.SEND_MESSAGE_SUCCESS, {\n      messageType: messageType,\n      page: 1\n    }));\n    dispatch(loadMessageConversations());\n  } catch (error) {\n    dispatch(createAction(actions.SEND_MESSAGE_ERROR, {\n      error\n    }));\n  }\n};\nexport const replyMessage = ({\n  message,\n  internalReply,\n  messageConversation,\n  messageType\n}) => async (dispatch, getState) => {\n  try {\n    const {\n      id\n    } = messageConversation;\n    const state = getState();\n    const attachments = state.messaging.attachments.map(attachment => attachment.id);\n    await api.replyMessage({\n      message,\n      internalReply,\n      attachments,\n      id\n    });\n    dispatch(createAction(actions.REPLY_MESSAGE_SUCCESS, {\n      messageConversation: messageConversation,\n      messageType: messageType,\n      page: 1\n    }));\n    dispatch(loadMessageConversations());\n    dispatch(setSelectedMessageConversation(messageConversation));\n  } catch (error) {\n    dispatch(createAction(actions.REPLY_MESSAGE_ERROR, {\n      error\n    }));\n  }\n};\nexport const markMessageConversations = (mode, markedConversations, messageType) => async dispatch => {\n  try {\n    await (mode === 'read' ? api.markRead(markedConversations) : api.markUnread(markedConversations));\n    dispatch(createAction(actions.MARK_MESSAGE_CONVERSATIONS_SUCCESS, {\n      messageType: messageType,\n      page: 1\n    }));\n    dispatch(loadMessageConversations());\n  } catch (error) {\n    dispatch(createAction(actions.MARK_MESSAGE_CONVERSATIONS_ERROR, {\n      error\n    }));\n  }\n};\nexport const addRecipients = ({\n  users,\n  userGroups,\n  organisationUnits,\n  messageConversation,\n  messageType\n}) => async dispatch => {\n  try {\n    const {\n      id: messageConversationId\n    } = messageConversation;\n    await api.addRecipients({\n      users,\n      userGroups,\n      organisationUnits,\n      messageConversationId\n    });\n    dispatch(createAction(actions.ADD_RECIPIENTS_SUCCESS, {\n      messageConversation: messageConversation,\n      messageType: messageType,\n      page: 1\n    }));\n    dispatch(setSelectedMessageConversation(messageConversation));\n  } catch (error) {\n    dispatch(createAction(actions.ADD_RECIPIENTS_ERROR, {\n      error\n    }));\n  }\n};\nexport const addRecipientByUserId = id => async dispatch => {\n  try {\n    const user = await api.getUserById(id);\n    dispatch(createAction(actions.ADD_RECIPIENT_BY_ID_SUCCESS, user));\n  } catch (error) {\n    console.error(error); // No action required, the field will just be empty\n  }\n};\nexport const addAttachment = attachment => async dispatch => {\n  dispatch(createAction(actions.ADD_ATTACHMENT, attachment));\n\n  try {\n    const result = await api.addAttachment(attachment);\n    dispatch(createAction(actions.ADD_ATTACHMENT_SUCCESS, {\n      id: result.response.fileResource.id,\n      name: attachment.name,\n      contentLength: result.response.fileResource.contentLength\n    }));\n  } catch (error) {\n    dispatch(createAction(actions.ADD_ATTACHMENT_ERROR, {\n      error\n    }));\n  }\n};\nexport const downloadAttachment = (messageConversationId, messageId, attachmentId) => dispatch => {\n  api.downloadAttachment(messageConversationId, messageId, attachmentId);\n  dispatch(createAction(actions.DOWNLOAD_ATTACHMENT_SUCCESS));\n};\n/************************\n * PLAIN ACTION SECTION *\n ************************/\n\nexport const clearSnackMessage = () => createAction(actions.CLEAR_SNACK_MESSAGE);\nexport const clearCheckedIds = () => createAction(actions.CLEAR_CHECKED);\nexport const clearSelectedMessageConversation = () => createAction(actions.CLEAR_SELECTED_MESSAGE_CONVERSATION);\nexport const displaySnackMessage = ({\n  message,\n  onSnackActionClick,\n  onSnackRequestClose,\n  snackType\n}) => createAction(actions.DISPLAY_SNACK_MESSAGE, {\n  message,\n  onSnackActionClick,\n  onSnackRequestClose,\n  snackType\n});\nexport const setAllChecked = messageConversationIds => createAction(actions.SET_ALL_CHECKED, {\n  messageConversationIds\n});\nexport const setChecked = (messageConversation, selectedValue) => createAction(actions.SET_CHECKED, {\n  messageConversation,\n  selectedValue\n});\nexport const setFilter = (filter, filterType) => createAction(actions.SET_FILTER, {\n  filter,\n  filterType\n});\nexport const updateInputFields = (subject, input, recipients) => createAction(actions.UPDATE_INPUT_FIELDS, {\n  subject,\n  input,\n  recipients\n});\nexport const clearAttachments = () => createAction(actions.CLEAR_ATTACHMENTS);\nexport const setSelectedMessageType = messageTypeId => createAction(actions.SET_SELECTED_MESSAGE_TYPE, {\n  messageTypeId\n});\nexport const removeAttachment = attachmentId => createAction(actions.REMOVE_ATTACHMENT, {\n  attachmentId\n});\nexport const cancelAttachment = attachmentName => createAction(actions.CANCEL_ATTACHMENT, {\n  attachmentName\n});\nexport const setIsInFeedbackRecipientGroup = isInFeedbackRecipientGroup => createAction(actions.SET_IN_FEEDBACK_RECIPIENT_GROUP, {\n  isInFeedbackRecipientGroup\n});\nexport const setDhis2CoreVersion = version => createAction(actions.SET_DHIS2_CORE_VERSION, version);","import React, { Component } from 'react';\nimport propTypes from '@dhis2/prop-types';\nimport { connect } from 'react-redux';\nimport Snackbar from 'material-ui/Snackbar';\nimport { clearSnackMessage } from '../../actions/index.js';\nimport { compose, pure } from 'recompose';\nimport theme from '../../styles/theme.js';\nconst DEFAULT_MESSAGE_DURATION = 4000;\nconst contentColorStyle = {\n  NEGATIVE: theme.palette.negative,\n  NEUTRAL: theme.palette.primary1Color,\n  POSITIVE: theme.palette.alternateTextColor\n};\n\nclass CustomSnackBar extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      show: false\n    };\n  }\n\n  componentDidUpdate(_prevProps, prevState) {\n    if (!prevState.show && this.props.message) {\n      this.setState({\n        show: true\n      });\n    }\n  }\n\n  closeMessage = () => {\n    this.props.clearSnackMessage();\n    this.setState({\n      show: false\n    });\n    this.props.onSnackRequestClose && this.props.onSnackRequestClose();\n  };\n\n  render() {\n    return <Snackbar open={this.props.message !== '' && this.state.show} message={this.props.message || 'Missing snackbar message'} autoHideDuration={DEFAULT_MESSAGE_DURATION} onRequestClose={this.closeMessage} action={this.props.onSnackActionClick && 'undo'} onActionClick={() => {\n      this.props.onSnackActionClick();\n      this.setState({\n        show: false\n      });\n    }} contentStyle={{\n      color: contentColorStyle[this.props.type]\n    }} style={{\n      pointerEvents: 'none',\n      whiteSpace: 'nowrap'\n    }} bodyStyle={{\n      pointerEvents: 'initial',\n      maxWidth: 'none'\n    }} />;\n  }\n\n}\n\nCustomSnackBar.propTypes = {\n  clearSnackMessage: propTypes.func,\n  message: propTypes.string,\n  type: propTypes.oneOf(['NEGATIVE', 'NEUTRAL', 'POSITIVE']),\n  onSnackActionClick: propTypes.func,\n  onSnackRequestClose: propTypes.func\n};\n\nconst mapStateToProps = state => ({\n  message: state.messaging.snackMessage,\n  type: state.messaging.snackType,\n  onSnackActionClick: state.messaging.onSnackActionClick,\n  onSnackRequestClose: state.messaging.onSnackRequestClose\n});\n\nexport default compose(connect(mapStateToProps, {\n  clearSnackMessage\n}), pure)(CustomSnackBar);","import { createHashHistory } from 'history';\nexport default createHashHistory();","import React from 'react';\nimport propTypes from '@dhis2/prop-types';\nimport FlatButton from 'material-ui/FlatButton';\nimport LinearProgress from 'material-ui/LinearProgress';\nimport Clear from 'material-ui-icons/Clear';\nimport Download from 'material-ui-icons/CloudDownload';\nimport theme from '../../styles/theme.js';\nimport './Attachments.css';\n\nconst Attachments = ({\n  dataDirection,\n  attachments,\n  style,\n  removeAttachment,\n  downloadAttachment,\n  cancelAttachment\n}) => <div className=\"attachment\" style={{ ...style\n}}>\n        {attachments.map((attachment, index) => <Attachment // combining name with index prevents errors when user uploads files with duplicate names\n  key={`${attachment.name}-${index}`} dataDirection={dataDirection} attachment={attachment} removeAttachment={removeAttachment} downloadAttachment={downloadAttachment} cancelAttachment={cancelAttachment} />)}\n    </div>;\n\nAttachments.propTypes = {\n  attachments: propTypes.array,\n  cancelAttachment: propTypes.func,\n  dataDirection: propTypes.string,\n  downloadAttachment: propTypes.func,\n  removeAttachment: propTypes.func,\n  style: propTypes.object\n};\n\nconst Attachment = ({\n  dataDirection,\n  attachment,\n  removeAttachment,\n  downloadAttachment,\n  cancelAttachment\n}) => {\n  return <FlatButton className=\"attachment__button\" backgroundColor={theme.palette.accent2Color} label={`${attachment.name} (${parseFloat(parseInt(attachment.contentLength, 10) / 1000000).toFixed(2)} MB)`} labelPosition=\"after\" onClick={() => {\n    dataDirection === 'download' ? downloadAttachment(attachment) : attachment.loading ? cancelAttachment(attachment.name) : removeAttachment(attachment);\n  }} icon={dataDirection === 'download' ? <Download /> : <Clear />}>\n            {attachment.loading && <LinearProgress className={'attachment__progress'} mode=\"indeterminate\" />}\n        </FlatButton>;\n};\n\nAttachment.propTypes = {\n  attachment: propTypes.object,\n  cancelAttachment: propTypes.func,\n  dataDirection: propTypes.string,\n  downloadAttachment: propTypes.func,\n  removeAttachment: propTypes.func\n};\nexport default Attachments;","import React from 'react';\nimport propTypes from '@dhis2/prop-types';\nimport Divider from 'material-ui/Divider';\nimport CardText from 'material-ui/Card/CardText';\nimport Attachments from '../Attachments/Attachments.js';\nimport i18n from '@dhis2/d2-i18n';\nimport Linkify from 'react-linkify';\nimport theme from '../../styles/theme.js';\nimport { fontFamily } from '../../constants/development.js';\nimport moment from 'moment';\nconst styles = {\n  canvas(backgroundColor) {\n    return {\n      backgroundColor,\n      padding: '16px 16px 16px 16px'\n    };\n  },\n\n  innerCanvas: {\n    margin: '',\n    paddingBottom: '0px'\n  },\n  cardText: {\n    padding: '16px 0px 16px 0px',\n    fontFamily,\n    whiteSpace: 'pre-wrap',\n    wordBreak: 'break-word'\n  },\n  fromFormat: {\n    fontFamily\n  },\n  datePlacement: {\n    display: 'flex',\n    justifyContent: 'flex-end',\n    marginRight: '10px'\n  },\n  dateFormat: {\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n    whiteSpace: 'nowrap',\n    fontFamily\n  }\n};\n\nconst Message = ({\n  displayTimeDiff,\n  message,\n  currentUser,\n  lastMessage,\n  downloadAttachment,\n  cancelAttachment,\n  enableAttachments\n}) => {\n  const fromTitle = message.sender ? currentUser && currentUser.id === message.sender.id ? 'me' : message.sender.displayName : 'system';\n  const today = moment();\n  const messageDate = moment(message.created).add(displayTimeDiff);\n  return <div style={styles.canvas(theme.palette.canvasColor)}>\n            <div style={styles.innerCanvas}>\n                <div style={styles.fromFormat}>\n                    {message.internal ? i18n.t(`Internal message from ${fromTitle}`) : i18n.t(`Message from ${fromTitle}`)}\n                </div>\n\n                <div placement={'bottom'} style={styles.datePlacement}>\n                    <div style={styles.dateFormat}>\n                        {today.diff(messageDate, 'hours') < 72 ? `${messageDate.from(today)}, ${messageDate.format('HH:mm')}` : today.year() === messageDate.year() ? messageDate.format('MMM DD, HH:mm') : messageDate.format('MMM DD, YYYY HH:mm')}\n                    </div>\n                </div>\n\n                {enableAttachments && <Attachments dataDirection={'download'} style={{\n        paddingLeft: 0\n      }} attachments={message.attachments} downloadAttachment={downloadAttachment} cancelAttachment={cancelAttachment} />}\n\n                <CardText style={styles.cardText}>\n                    <Linkify>{message.text}</Linkify>\n                </CardText>\n            </div>\n            {!lastMessage && <Divider />}\n        </div>;\n};\n\nMessage.propTypes = {\n  cancelAttachment: propTypes.func,\n  currentUser: propTypes.object,\n  displayTimeDiff: propTypes.number,\n  downloadAttachment: propTypes.func,\n  enableAttachments: propTypes.bool,\n  lastMessage: propTypes.bool,\n  message: propTypes.object\n};\nexport default Message;","import React from 'react';\nimport propTypes from '@dhis2/prop-types';\nimport FlatButton from 'material-ui/FlatButton';\nimport AttachFile from 'material-ui-icons/AttachFile';\nimport i18n from '@dhis2/d2-i18n';\nimport './AttachmentUploadButton.css';\n\nconst createHandleChange = addAttachment => event => {\n  const files = event.target.files;\n  const hasFile = files.length > 0;\n\n  if (hasFile) {\n    addAttachment(files[0]);\n  }\n};\n\nconst AttachmentUploadButton = ({\n  addAttachment\n}) => <FlatButton className=\"attachment__upload-button\" label={i18n.t('Upload attachment')} labelPosition=\"after\" containerElement=\"label\" icon={<AttachFile />}>\n        <input className=\"attachment__upload-button--input\" type=\"file\" onChange={createHandleChange(addAttachment)} />\n    </FlatButton>;\n\nAttachmentUploadButton.propTypes = {\n  addAttachment: propTypes.func\n};\nexport default AttachmentUploadButton;","import React, { Component } from 'react';\nimport propTypes from '@dhis2/prop-types';\nimport { connect } from 'react-redux';\nimport { compose } from 'recompose';\nimport { Card, CardActions, CardText } from 'material-ui/Card';\nimport RaisedButton from 'material-ui/RaisedButton';\nimport FlatButton from 'material-ui/FlatButton';\nimport TextField from 'material-ui/TextField';\nimport AttachmentUploadButton from '../Attachments/AttachmentUploadButton.js';\nimport Attachments from '../Attachments/Attachments.js';\nimport { supportsAttachments } from '../../utils/helpers.js';\nimport i18n from '@dhis2/d2-i18n';\nimport { replyMessage, setSelectedMessageType, updateInputFields, displaySnackMessage, addAttachment, removeAttachment, cancelAttachment } from '../../actions/index.js';\nimport { NEGATIVE } from '../../constants/development.js';\n\nclass ReplyCard extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      discardState: false\n    };\n  }\n\n  componentWillUnmount() {\n    this.wipeInput();\n  }\n\n  replyMessage = internalReply => {\n    const {\n      input: message,\n      selectedMessageConversation: messageConversation,\n      selectedMessageType: messageType\n    } = this.props;\n    this.props.replyMessage({\n      message,\n      internalReply,\n      messageConversation,\n      messageType\n    });\n    this.wipeInput();\n  };\n  wipeInput = () => {\n    this.props.updateInputFields('', '', []);\n    this.props.attachments.length > 0 && this.props.clearAttachments();\n    this.setState({\n      inputError: false\n    });\n  };\n  texFieldUpdate = (event, newValue) => {\n    this.props.updateInputFields('', newValue, []);\n  };\n  handleDiscard = () => {\n    const message = i18n.t('Reply discarded');\n    const snackType = NEGATIVE;\n\n    const onSnackActionClick = () => this.setState({\n      discardState: false\n    });\n\n    const onSnackRequestClose = () => {\n      this.setState({\n        discardState: false\n      });\n      this.wipeInput();\n    };\n\n    this.setState({\n      discardState: true\n    });\n    this.props.displaySnackMessage({\n      message,\n      onSnackActionClick,\n      onSnackRequestClose,\n      snackType\n    });\n    this.setState({\n      expanded: false\n    });\n  };\n\n  render() {\n    return <Card style={{\n      marginTop: '5px'\n    }} expanded>\n                <CardText style={{\n        padding: '0px 0px 0px 16px'\n      }}>\n                    <TextField key={this.props.messageConversation.id} id={this.props.messageConversation.id} rows={5} underlineShow={false} value={this.state.discardState ? '' : this.props.input} multiLine fullWidth floatingLabelText={i18n.t('Message')} onChange={this.texFieldUpdate} />\n                    {this.props.enableAttachments && !this.state.discardState && <Attachments dataDirection={'upload'} attachments={this.props.attachments} removeAttachment={attachment => this.props.removeAttachment(attachment.id)} cancelAttachment={this.props.cancelAttachment} />}\n\n                    <CardActions style={{\n          paddingLeft: '0px'\n        }}>\n                        <RaisedButton primary label={i18n.t('Reply')} disabled={this.props.input === '' || this.state.discardState} onClick={() => this.replyMessage(false)} />\n                        {this.props.isInFeedbackRecipientGroup && this.props.selectedMessageType.id === 'TICKET' && <FlatButton primary label={i18n.t('Internal reply')} disabled={this.props.input === '' || this.state.discardState} onClick={() => this.replyMessage(true)} />}\n                        <FlatButton label={i18n.t('Discard')} disabled={this.props.input === '' || this.state.discardState} onClick={this.handleDiscard} />\n                        {this.props.enableAttachments && <AttachmentUploadButton addAttachment={attachment => {\n            this.props.addAttachment(attachment);\n          }} />}\n                        )\n                    </CardActions>\n                </CardText>\n            </Card>;\n  }\n\n}\n\nReplyCard.propTypes = {\n  addAttachment: propTypes.func,\n  attachments: propTypes.array,\n  cancelAttachment: propTypes.func,\n  clearAttachments: propTypes.func,\n  displaySnackMessage: propTypes.func,\n  enableAttachments: propTypes.bool,\n  input: propTypes.string,\n  isInFeedbackRecipientGroup: propTypes.bool,\n  messageConversation: propTypes.object,\n  removeAttachment: propTypes.func,\n  replyMessage: propTypes.func,\n  selectedMessageConversation: propTypes.object,\n  selectedMessageType: propTypes.object,\n  updateInputFields: propTypes.func\n};\n\nconst mapStateToProps = state => ({\n  selectedMessageConversation: state.messaging.selectedMessageConversation,\n  selectedMessageType: state.messaging.selectedMessageType,\n  messageTypes: state.messaging.messageTypes,\n  input: state.messaging.input,\n  isInFeedbackRecipientGroup: state.messaging.isInFeedbackRecipientGroup,\n  attachments: state.messaging.attachments,\n  enableAttachments: supportsAttachments(state.messaging.dhis2CoreVersion)\n});\n\nexport default compose(connect(mapStateToProps, {\n  replyMessage,\n  setSelectedMessageType,\n  updateInputFields,\n  displaySnackMessage,\n  addAttachment,\n  removeAttachment,\n  cancelAttachment\n}, null, {\n  pure: false\n}))(ReplyCard);","import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport propTypes from '@dhis2/prop-types';\nimport ChipInput from 'material-ui-chip-input';\nimport { debounce } from '../../utils/helpers.js';\nimport i18n from '@dhis2/d2-i18n';\nimport * as api from '../../api/api.js';\nconst searchDelay = 300;\nconst minCharLength = 2;\n/*\n * An AutoComplete text field with suggestions from a given list of\n * identifiable objects. Selected objects are shown as chips in the text field.\n */\n\nclass SuggestionField extends Component {\n  state = {\n    input: '',\n    searchResult: [],\n    searchOnlyUsers: this.props.searchOnlyUsers,\n    searchOnlyFeedbackRecipients: this.props.searchOnlyFeedbackRecipients,\n    lastSearch: '',\n    errorText: undefined\n  };\n  debouncedSearch = debounce(this.search.bind(this), searchDelay);\n\n  search(input) {\n    const doSearch = !this.state.searchResult.find(result => result.displayName === input) && input !== '' && input.length >= minCharLength;\n\n    if (doSearch) {\n      const {\n        feedbackRecipientsId,\n        searchOnlyUsers,\n        searchOnlyFeedbackRecipients,\n        dhis2CoreVersion\n      } = this.props;\n      api.searchRecipients({\n        searchValue: input,\n        searchOnlyUsers,\n        searchOnlyFeedbackRecipients,\n        feedbackRecipientsId,\n        dhis2CoreVersion\n      }).then(({\n        users,\n        userGroups,\n        organisationUnits\n      }) => {\n        const addType = type => result => ({ ...result,\n          type\n        });\n\n        let internalSearchResult = users.map(addType('user'));\n\n        if (!this.state.searchOnlyUsers) {\n          internalSearchResult = internalSearchResult.concat(userGroups.map(addType('userGroup'))).concat(organisationUnits.map(addType('organisationUnit')));\n        }\n\n        this.setState({\n          searchResult: internalSearchResult,\n          errorText: internalSearchResult.length === 0 ? i18n.t('No results found') : undefined\n        });\n      });\n    } else {\n      this.setState({\n        lastSearch: input,\n        searchResult: this.state.lastSearch !== '' && input === '' || input.length < minCharLength ? [] : this.state.searchResult,\n        errorText: input !== '' && input.length < minCharLength ? i18n.t(`Please enter at least ${minCharLength} characters`) : this.state.searchWarning\n      });\n    }\n  }\n\n  onSuggestionClick = chip => {\n    if (this.props.onSuggestionClick !== undefined) {\n      this.props.onSuggestionClick(chip);\n    } else {\n      this.wipeInput();\n      this.debouncedSearch('');\n      const doInsert = !this.props.recipients.find(recipient => recipient.id === chip.id);\n      doInsert && this.props.updateRecipients([...this.props.recipients, this.state.searchResult.find(result => result.id === chip.id)]);\n    }\n  };\n  onRemoveChip = id => {\n    this.props.updateRecipients(this.props.recipients.filter(recipient => recipient.id !== id));\n  };\n  wipeInput = () => {\n    this.setState({\n      input: '',\n      searchResult: []\n    });\n  };\n  updateInput = input => {\n    this.debouncedSearch(input);\n    this.setState({\n      input\n    });\n  };\n\n  render() {\n    return <div style={{ ...this.props.style,\n      height: this.props.inputHeight\n    }}>\n                <ChipInput style={{\n        marginBottom: 16\n      }} disabled={this.props.disabled === undefined ? false : this.props.disabled} errorText={this.props.errorText || this.state.errorText} value={this.props.recipients} fullWidth openOnFocus searchText={this.state.input} floatingLabelText={this.props.label} dataSource={this.state.searchResult} dataSourceConfig={{\n        text: 'displayName',\n        value: 'id'\n      }} onUpdateInput={this.updateInput} onRequestAdd={chip => this.onSuggestionClick(chip)} onRequestDelete={id => this.onRemoveChip(id)} />\n            </div>;\n  }\n\n}\n\nSuggestionField.propTypes = {\n  dhis2CoreVersion: propTypes.number,\n  disabled: propTypes.bool,\n  errorText: propTypes.string,\n  feedbackRecipientsId: propTypes.string,\n  inputHeight: propTypes.string,\n  label: propTypes.string,\n  recipients: propTypes.array,\n  searchOnlyFeedbackRecipients: propTypes.bool,\n  searchOnlyUsers: propTypes.bool,\n  style: propTypes.object,\n  updateRecipients: propTypes.func,\n  onSuggestionClick: propTypes.func\n};\nexport default connect(state => ({\n  dhis2CoreVersion: state.messaging.dhis2CoreVersion\n}))(SuggestionField);","import React from 'react';\nimport propTypes from '@dhis2/prop-types';\nimport Subheader from 'material-ui/Subheader/Subheader';\nconst styles = {\n  subheaderTitle: {\n    height: '32px',\n    color: 'black',\n    paddingLeft: 0,\n    paddingRight: 16\n  },\n\n  subheader(color, fontWeight) {\n    return {\n      height: '32px',\n      overflow: 'hidden',\n      textOverflow: 'ellipsis',\n      whiteSpace: 'nowrap',\n      padding: 0,\n      color,\n      fontWeight\n    };\n  }\n\n};\n\nconst ExtendedChoiceLabel = ({\n  showTitle,\n  title,\n  label,\n  color,\n  fontWeight\n}) => {\n  const displayLabel = label && label !== 'NONE' ? title === 'Assignee' ? label : `${label.charAt(0)}${label.toLowerCase().substr(1, label.length)}` : '-';\n  return <div style={{\n    flex: 2,\n    paddingLeft: 10,\n    maxWidth: 200\n  }}>\n            {showTitle && <Subheader style={styles.subheaderTitle}> {title} </Subheader>}\n            <Subheader style={styles.subheader(color, fontWeight)}>\n                {displayLabel}\n            </Subheader>\n        </div>;\n};\n\nExtendedChoiceLabel.propTypes = {\n  color: propTypes.string,\n  fontWeight: propTypes.string,\n  label: propTypes.string,\n  showTitle: propTypes.bool,\n  title: propTypes.string\n};\nexport default ExtendedChoiceLabel;","import theme from '../styles/theme.js';\nimport { fontFamily } from '../constants/development.js';\nexport const styles = {\n  canvas: {\n    flex: '3 0',\n    overflowY: 'scroll',\n    overflowX: 'hidden',\n    height: 'calc(100vh - 110px)',\n    paddingTop: '10px'\n  },\n  innerCanvas: {\n    display: 'flex',\n    flexDirection: 'column',\n    margin: '0px 10px 0px 10px'\n  },\n  header: {\n    display: 'flex'\n  },\n  iconButton: {\n    display: 'flex',\n    alignSelf: 'center'\n  },\n  subjectSubheader: {\n    display: 'flex',\n    alignSelf: 'center',\n    fontSize: '20px',\n    fontFamily\n  },\n  participantsCanvas: {\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  participants: {\n    paddingLeft: '12px',\n    paddingTop: '10px',\n    display: 'flex',\n    flexWrap: 'wrap'\n  },\n  chip: {\n    height: '32px',\n    marginRight: '3px',\n    marginBottom: '3px'\n  },\n  participantAddRow: {\n    display: 'flex'\n  },\n  participantsSuggestionField: {\n    paddingLeft: '12px',\n    marginBottom: '0px',\n    flex: 1\n  },\n  participantsAdd: {\n    alignSelf: 'flex-end',\n    marginBottom: '28px',\n    paddingLeft: '12px'\n  },\n  messagesCanvas: {\n    marginBottom: '50px',\n    display: 'flex',\n    flexDirection: 'column',\n    backgroundColor: theme.palette.accent2Color,\n    margin: '0px 10px 10px 10px'\n  },\n  messagesInnerCanvas: {\n    padding: '0px'\n  }\n};\nexport default styles;","import React, { Component } from 'react';\nimport propTypes from '@dhis2/prop-types';\nimport { connect } from 'react-redux';\nimport history from '../../utils/history.js';\nimport { addRecipients, downloadAttachment, cancelAttachment, clearSelectedMessageConversation } from '../../actions/index.js';\nimport { supportsAttachments } from '../../utils/helpers.js';\nimport Subheader from 'material-ui/Subheader/Subheader';\nimport AddIcon from 'material-ui-icons/Add';\nimport NavigationBack from 'material-ui-icons/ArrowBack';\nimport FlatButton from 'material-ui/FlatButton';\nimport IconButton from 'material-ui/IconButton';\nimport Chip from 'material-ui/Chip';\nimport Paper from 'material-ui/Paper';\nimport i18n from '@dhis2/d2-i18n';\nimport Message from './Message.js';\nimport ReplyCard from './ReplyCard.js';\nimport SuggestionField from '../Common/SuggestionField.js';\nimport ExtendedChoiceLabel from '../Common/ExtendedChoiceLabel.js';\nimport { styles } from '../../styles/messageConversationStyles.js';\nimport theme from '../../styles/theme.js';\nconst NOTIFICATIONS = ['TICKET', 'VALIDATION_RESULT'];\nconst maxParticipantsDisplay = 30;\n\nclass MessageConversation extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      recipients: [],\n      cursor: 'auto'\n    };\n  }\n\n  backToList = () => {\n    const {\n      clearSelectedMessageConversation,\n      messageConversation\n    } = this.props;\n    history.push(`/${messageConversation.messageType}`);\n    clearSelectedMessageConversation();\n  };\n  addRecipients = () => {\n    const users = this.state.recipients.filter(r => r.type === 'user');\n    const userGroups = this.state.recipients.filter(r => r.type === 'userGroup');\n    const organisationUnits = this.state.recipients.filter(r => r.type === 'organisationUnit');\n    const {\n      messageConversation,\n      selectedMessageType: messageType\n    } = this.props;\n    this.props.addRecipients({\n      users,\n      userGroups,\n      organisationUnits,\n      messageConversation,\n      messageType\n    });\n    this.setState({\n      recipients: []\n    });\n  };\n  updateRecipients = recipients => {\n    this.setState({\n      recipients\n    });\n  };\n\n  render() {\n    const {\n      messageConversation,\n      currentUser\n    } = this.props;\n    const messages = messageConversation.messages;\n    const notification = !!(NOTIFICATIONS.indexOf(messageConversation.messageType) + 1);\n    const participants = messageConversation.userMessages.slice(0, maxParticipantsDisplay).map(userMessage => !currentUser.id || this.state.recipientsExpanded || currentUser.id !== userMessage.user.id ? userMessage.user.displayName : i18n.t('me'));\n    const userMessagesLength = messageConversation.userMessages.length;\n\n    if (userMessagesLength > maxParticipantsDisplay) {\n      participants.push(' + '.concat(userMessagesLength - maxParticipantsDisplay));\n    }\n\n    return <div id=\"messageconversation\" style={styles.canvas}>\n                <div style={styles.innerCanvas}>\n                    <div style={styles.header}>\n                        <IconButton style={styles.iconButton} tooltipPosition=\"bottom-right\" onClick={this.backToList} tooltip={i18n.t('Show all messages')}>\n                            <NavigationBack />\n                        </IconButton>\n                        <Subheader style={styles.subjectSubheader}>\n                            {messageConversation.subject}\n                        </Subheader>\n                        {this.props.displayExtendedChoices && <ExtendedChoiceLabel color={theme.palette.darkGray} showTitle title={i18n.t('Status')} label={messageConversation.status} />}\n                        {this.props.displayExtendedChoices && <ExtendedChoiceLabel color={theme.palette.darkGray} showTitle title={i18n.t('Priority')} label={messageConversation.priority} />}\n                        {notification && <ExtendedChoiceLabel color={theme.palette.darkGray} showTitle title={i18n.t('Assignee')} label={messageConversation.assignee ? messageConversation.assignee.displayName : undefined} />}\n                    </div>\n                    <div style={styles.participantsCanvas}>\n                        <Subheader style={{\n            paddingLeft: '12px',\n            paddingTop: '10px'\n          }}>\n                            {i18n.t('Participants')}\n                        </Subheader>\n                        <div style={styles.participants}>\n                            {participants.map(participant => <Chip key={participant} style={styles.chip}>\n                                    {participant}\n                                </Chip>)}\n                        </div>\n                    </div>\n                    <div style={styles.participantAddRow}>\n                        <SuggestionField style={styles.participantsSuggestionField} label={i18n.t('Add participants to conversation')} messageConversation={messageConversation} recipients={this.state.recipients} updateRecipients={this.updateRecipients} limitSearchArray={messageConversation.userMessages} />\n                        <div style={styles.participantsAdd}>\n                            <FlatButton icon={<AddIcon />} onClick={() => this.addRecipients()} label={i18n.t('Add')} />\n                        </div>\n                    </div>\n                </div>\n                <div style={styles.messagesCanvas}>\n                    <Paper style={styles.messagesInnerCanvas}>\n                        {messages.map((message, i) => <Message key={message.id} displayTimeDiff={this.props.displayTimeDiff} message={message} messageConversation={messageConversation} notification={notification} currentUser={this.state.currentUser} lastMessage={i + 1 === messages.length} downloadAttachment={attachment => this.props.downloadAttachment(messageConversation.id, message.id, attachment.id)} cancelAttachment={this.props.cancelAttachment} enableAttachments={this.props.enableAttachments} />)}\n                    </Paper>\n                    <ReplyCard {...this.props} messageConversation={messageConversation} />\n                </div>\n            </div>;\n  }\n\n}\n\nMessageConversation.propTypes = {\n  addRecipients: propTypes.func,\n  cancelAttachment: propTypes.func,\n  clearSelectedMessageConversation: propTypes.func,\n  currentUser: propTypes.object,\n  displayExtendedChoices: propTypes.bool,\n  displayTimeDiff: propTypes.number,\n  downloadAttachment: propTypes.func,\n  enableAttachments: propTypes.bool,\n  messageConversation: propTypes.object,\n  selectedMessageType: propTypes.object\n};\n\nconst mapStateToProps = state => ({\n  currentUser: state.messaging.currentUser,\n  selectedMessageType: state.messaging.selectedMessageType,\n  displayTimeDiff: state.messaging.displayTimeDiff,\n  enableAttachments: supportsAttachments(state.messaging.dhis2CoreVersion)\n});\n\nexport default connect(mapStateToProps, {\n  addRecipients,\n  downloadAttachment,\n  cancelAttachment,\n  clearSelectedMessageConversation\n})(MessageConversation);","import React, { Component } from 'react';\nimport propTypes from '@dhis2/prop-types';\nimport CircularProgress from 'material-ui/CircularProgress';\nimport Badge from 'material-ui/Badge';\nimport Subheader from 'material-ui/Subheader/Subheader';\nimport i18n from '@dhis2/d2-i18n';\nimport theme from '../../styles/theme.js';\n\nclass MessageTypeItem extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      backgroundColor: theme.palette.accent2Color,\n      textColor: theme.palette.darkGray\n    };\n  }\n\n  onClick = () => {\n    this.props.onClick();\n  };\n  onMouseEnter = () => {\n    this.setHoverText();\n    this.setState({\n      cursor: 'pointer'\n    });\n  };\n  onMouseLeave = () => {\n    this.setNeutralText();\n    this.setState({\n      cursor: 'auto'\n    });\n  };\n  setNeutralText = () => this.setTextColor(theme.palette.accent2Color);\n  setHoverText = () => this.setTextColor(theme.palette.accent3Color);\n  setTextColor = color => {\n    this.setState({\n      backgroundColor: color\n    });\n  };\n  getBackgroundColor = (selectedValue, id) => selectedValue && id === selectedValue.id ? theme.palette.accent3Color : this.state.backgroundColor;\n\n  render() {\n    return <div role=\"presentation\" style={{ ...this.state,\n      backgroundColor: this.getBackgroundColor(this.props.selectedMessageType, this.props.messageType.id),\n      cursor: this.state.cursor,\n      alignItems: 'center',\n      height: '49px',\n      display: 'flex',\n      flexDirection: 'row',\n      justifyContent: 'space-between'\n    }} onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave} onClick={() => this.onClick()}>\n                <Subheader style={{\n        marginLeft: '5px',\n        fontSize: this.props.selectedMessageType && this.props.messageType.id === this.props.selectedMessageType.id ? '18px' : '16px',\n        overflow: 'hidden',\n        textOverflow: 'ellipsis',\n        whiteSpace: 'nowrap',\n        color: this.props.selectedMessageType && this.props.messageType.id === this.props.selectedMessageType.id ? theme.palette.primary1Color : this.state.textColor\n      }}>\n                    {i18n.t(this.props.messageType.displayName)}\n                </Subheader>\n                {this.props.loading ? <CircularProgress style={{\n        marginRight: '10px'\n      }} color={theme.palette.primary1Color} size={24} /> : this.props.messageType.unread > 0 && <Badge style={{\n        marginTop: '12px',\n        marginRight: '5px'\n      }} badgeContent={this.props.messageType.unread > 100 ? '99+' : this.props.messageType.unread} secondary badgeStyle={{\n        backgroundColor: '#439E8E'\n      }} />}\n            </div>;\n  }\n\n}\n\nMessageTypeItem.propTypes = {\n  loading: propTypes.bool,\n  messageType: propTypes.object,\n  selectedMessageType: propTypes.object,\n  onClick: propTypes.func\n};\nexport default MessageTypeItem;","import React, { Component } from 'react';\nimport propTypes from '@dhis2/prop-types';\nimport { connect } from 'react-redux';\nimport { compose } from 'recompose';\nimport { List } from 'material-ui/List';\nimport Divider from 'material-ui/Divider';\nimport Toggle from 'material-ui/Toggle';\nimport i18n from '@dhis2/d2-i18n';\nimport history from '../../utils/history.js';\nimport { setSelectedMessageType, clearCheckedIds } from '../../actions/index.js';\nimport MessageTypeItem from './MessageTypeItem.js';\nimport theme from '../../styles/theme.js';\nimport moment from 'moment';\nconst styles = {\n  canvas: {\n    display: 'flex',\n    flexDirection: 'column',\n    justifyContent: 'space-between',\n    height: 'calc(100vh - 95px)',\n    borderLeftStyle: 'solid',\n    borderLeftWidth: '0.5px',\n    borderLeftColor: theme.palette.accent4Color,\n    borderRightStyle: 'solid',\n    borderRightWidth: '1px',\n    borderRightColor: theme.palette.accent4Color,\n    overflowY: 'auto',\n    overflowX: 'hidden',\n    minWidth: '200px'\n  }\n};\n\nclass SidebarList extends Component {\n  constructor(props) {\n    super(props);\n    this.props.setSelectedMessageType(this.props.match.params.messageType);\n  }\n\n  render() {\n    const messageTypes = this.props.messageTypes;\n    return <div style={styles.canvas}>\n                <List style={{\n        padding: '0px'\n      }}>\n                    {messageTypes && messageTypes.map(messageType => <div key={messageType.id}>\n                                <MessageTypeItem messageType={messageType} onClick={() => {\n            this.props.setSelectedMessageType(messageType.id);\n            this.props.updateInputFields('', '', []);\n            this.props.attachments.length > 0 && this.props.clearAttachments();\n            history.push(`/${messageType.id}`);\n          }} selectedMessageType={this.props.selectedMessageType} loading={messageType.loading} />\n                                <Divider />\n                            </div>)}\n                </List>\n                <Toggle style={{\n        width: '',\n        margin: '20px'\n      }} label={`${i18n.t('Auto refresh')} (${moment(this.props.refreshTimer).format('mm:ss')})`} toggled={this.props.autoRefresh} onToggle={() => this.props.setAutoRefresh(!this.props.autoRefresh)} />\n            </div>;\n  }\n\n}\n\nSidebarList.propTypes = {\n  attachments: propTypes.array,\n  autoRefresh: propTypes.bool,\n  clearAttachments: propTypes.func,\n  match: propTypes.object,\n  messageTypes: propTypes.array,\n  refreshTimer: propTypes.number,\n  selectedMessageType: propTypes.object,\n  setAutoRefresh: propTypes.func,\n  setSelectedMessageType: propTypes.func,\n  updateInputFields: propTypes.func\n};\n\nconst mapStateToProps = state => ({\n  selectedMessageType: state.messaging.selectedMessageType,\n  messageTypes: state.messaging.messageTypes\n});\n\nexport default compose(connect(mapStateToProps, {\n  setSelectedMessageType,\n  clearCheckedIds\n}, null, {\n  pure: false\n}))(SidebarList);","import theme from '../styles/theme.js';\nexport const messagePanelContainer = {\n  overflowY: 'scroll',\n  overflowX: 'hidden',\n  borderRightWidth: '1px',\n  borderRightColor: theme.palette.accent4Color,\n  height: 'calc(100vh - 95px)'\n};\nexport const subheader = {\n  paddingLeft: '0px',\n  fontSize: '20px'\n};","import React, { Component } from 'react';\nimport propTypes from '@dhis2/prop-types';\nimport { connect } from 'react-redux';\nimport { compose } from 'recompose';\nimport Subheader from 'material-ui/Subheader/Subheader';\nimport Checkbox from 'material-ui/Checkbox';\nimport Paper from 'material-ui/Paper';\nimport i18n from '@dhis2/d2-i18n';\nimport { setAllChecked, clearCheckedIds } from '../../actions/index.js';\nimport theme from '../../styles/theme.js';\nimport { fontFamily } from '../../constants/development.js';\nconst fontSize = '16px';\nconst styles = {\n  canvas(backgroundColor) {\n    return {\n      backgroundColor,\n      display: 'flex',\n      transition: 'all 0.2s ease-in-out',\n      boxSizing: 'border-box',\n      position: 'relative',\n      whiteSpace: 'nowrap',\n      alignSelf: 'center',\n      boxShadow: 'none',\n      borderBottom: '1px solid #dfdfdf'\n    };\n  },\n\n  checkBox: {\n    flex: '0 0 32px',\n    display: 'flex',\n    alignSelf: 'center',\n    paddingLeft: '12px'\n  },\n  sender: {\n    fontFamily,\n    fontSize,\n    flex: 3,\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n    whiteSpace: 'nowrap',\n    color: 'black',\n    paddingLeft: 10,\n    alignSelf: 'center'\n  },\n  subject: {\n    flex: 8,\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n    whiteSpace: 'nowrap',\n    fontFamily,\n    fontSize,\n    color: 'black',\n    paddingLeft: 10\n  },\n  extendedLabel: {\n    flex: 2,\n    color: 'black',\n    fontSize,\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n    whiteSpace: 'nowrap',\n    padding: '0 0 0 10px'\n  }\n};\n\nclass MessageConversationListItem extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      cursor: 'auto',\n      allChecked: false\n    };\n  }\n\n  componentDidUpdate() {\n    if (this.state.allChecked && this.props.checkedIds.length < this.props.messages.length) {\n      this.setState({\n        allChecked: false\n      });\n    }\n  }\n\n  render() {\n    const displayExtendedChoices = this.props.displayExtendedChoices;\n    return <Paper style={styles.canvas(theme.palette.canvasColor)}>\n                <Checkbox checked={this.state.allChecked} style={styles.checkBox} onCheck={() => {\n        this.state.allChecked ? this.props.clearCheckedIds() : this.props.setAllChecked(this.props.messages.map(child => ({\n          id: child.id\n        })));\n        this.setState({\n          allChecked: !this.state.allChecked\n        });\n      }} />\n                <div style={styles.sender}>{i18n.t('Sender')}</div>\n                <Subheader style={styles.subject}>\n                    {i18n.t('Subject')}\n                </Subheader>\n                {displayExtendedChoices && <Subheader style={styles.extendedLabel}>\n                        {i18n.t('Status')}\n                    </Subheader>}\n                {displayExtendedChoices && <Subheader style={styles.extendedLabel}>\n                        {i18n.t('Priority')}\n                    </Subheader>}\n                {this.props.notification && <Subheader style={styles.extendedLabel}>\n                        {i18n.t('Assignee')}\n                    </Subheader>}\n                <Subheader style={styles.extendedLabel}>\n                    {i18n.t('Date')}\n                </Subheader>\n            </Paper>;\n  }\n\n}\n\nMessageConversationListItem.propTypes = {\n  checkedIds: propTypes.array,\n  clearCheckedIds: propTypes.func,\n  displayExtendedChoices: propTypes.bool,\n  messages: propTypes.array,\n  notification: propTypes.bool,\n  setAllChecked: propTypes.func\n};\n\nconst mapStateToProps = state => ({\n  checkedIds: state.messaging.checkedIds,\n  isInFeedbackRecipientGroup: state.messaging.isInFeedbackRecipientGroup\n});\n\nexport default compose(connect(mapStateToProps, {\n  setAllChecked,\n  clearCheckedIds\n}))(MessageConversationListItem);","import React, { Component } from 'react';\nimport propTypes from '@dhis2/prop-types';\nimport { connect } from 'react-redux';\nimport { compose } from 'recompose';\nimport Subheader from 'material-ui/Subheader/Subheader';\nimport Checkbox from 'material-ui/Checkbox';\nimport Paper from 'material-ui/Paper';\nimport Flag from 'material-ui-icons/Flag';\nimport i18n from '@dhis2/d2-i18n';\nimport history from '../../utils/history.js';\nimport { setChecked, setSelectedMessageConversation, markMessageConversations, clearCheckedIds, setFilter, updateInputFields, clearAttachments } from '../../actions/index.js';\nimport ExtendedChoiceLabel from '../Common/ExtendedChoiceLabel.js';\nimport theme from '../../styles/theme.js';\nimport { fontFamily } from '../../constants/development.js';\nimport moment from 'moment';\nconst styles = {\n  container(backgroundColor, wideview, cursor) {\n    return {\n      backgroundColor,\n      display: 'flex',\n      transition: 'all 0.2s ease-in-out',\n      cursor: cursor,\n      boxSizing: 'border-box',\n      position: 'relative',\n      whiteSpace: 'nowrap',\n      boxShadow: 'none',\n      borderBottom: '1px solid #dfdfdf',\n      flexWrap: wideview ? 'nowrap' : 'wrap'\n    };\n  },\n\n  checkBox(wideview) {\n    return {\n      flex: '0 0 32px',\n      display: 'flex',\n      alignSelf: 'center',\n      paddingLeft: wideview ? 12 : 6\n    };\n  },\n\n  flag: {\n    color: theme.palette.followUp,\n    marginRight: 4\n  },\n\n  sender(wideview, fontWeight) {\n    return {\n      fontFamily,\n      fontSize: '14px',\n      flex: 3,\n      overflow: 'hidden',\n      textOverflow: 'ellipsis',\n      whiteSpace: 'nowrap',\n      display: 'flex',\n      alignItems: 'center',\n      color: 'black',\n      paddingLeft: wideview ? 10 : 0,\n      fontWeight\n    };\n  },\n\n  subject(wideview, fontColor, fontWeight) {\n    return {\n      flex: 8,\n      overflow: 'hidden',\n      textOverflow: 'ellipsis',\n      whiteSpace: 'nowrap',\n      paddingLeft: 10,\n      fontFamily,\n      color: fontColor,\n      fontWeight,\n      order: wideview ? 'inherit' : 10,\n      marginTop: wideview ? 0 : -10,\n      flexBasis: wideview ? '0%' : '100%'\n    };\n  },\n\n  dateFormat(wideview, fontColor, fontWeight) {\n    return {\n      flex: 2,\n      fontFamily,\n      paddingLeft: wideview ? 10 : 0,\n      paddingRight: wideview ? 0 : 10,\n      overflow: 'hidden',\n      textOverflow: 'ellipsis',\n      whiteSpace: 'nowrap',\n      textAlign: wideview ? '' : 'end',\n      color: fontColor,\n      fontWeight\n    };\n  }\n\n};\n\nclass MessageConversationListItem extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      backgroundColor: theme.palette.canvasColor,\n      cursor: 'auto'\n    };\n  }\n\n  onClick = messageConversation => {\n    this.props.setSelectedMessageConversation(messageConversation);\n\n    if (messageConversation && !messageConversation.read) {\n      this.props.markMessageConversations('read', [messageConversation.id], this.props.selectedMessageType);\n    }\n\n    this.props.updateInputFields('', '', []);\n    this.props.attachments.length > 0 && this.props.clearAttachments();\n    history.push(`/${messageConversation.messageType}/${messageConversation.id}`);\n  };\n  onMouseEnter = () => this.setState({\n    cursor: 'pointer',\n    backgroundColor: theme.palette.accent2Color\n  });\n  onMouseLeave = () => this.setState({\n    cursor: 'auto',\n    backgroundColor: theme.palette.canvasColor\n  });\n  getBackgroundColor = (messageConversation, checked) => {\n    const selectedMessageConversation = this.props.selectedMessageConversation && messageConversation.id === this.props.selectedMessageConversation.id;\n\n    if (checked && !selectedMessageConversation) {\n      return theme.palette.blue50;\n    } else if (selectedMessageConversation) {\n      return theme.palette.accent3Color;\n    }\n\n    return this.state.backgroundColor;\n  };\n\n  render() {\n    const messageConversation = this.props.messageConversation;\n    const title = messageConversation.lastSender ? messageConversation.lastSender.displayName : this.props.selectedMessageType.displayName;\n    const checked = !!this.props.checkedIds.find(x => x.id === messageConversation.id);\n    const displayExtendedChoices = this.props.displayExtendedChoices;\n    const displayTimeDiff = this.props.displayTimeDiff;\n    const today = moment();\n    const messageDate = moment(messageConversation.lastMessage).add(displayTimeDiff);\n    const fontWeight = !messageConversation.read ? 'bold' : '';\n    const fontColor = this.props.messageConversation.read ? 'black' : theme.palette.darkGray;\n    const containerBackgroundColor = this.getBackgroundColor(messageConversation, checked);\n    return <Paper style={styles.container(containerBackgroundColor, this.props.wideview, this.state.cursor)} onClick={event => {\n      const onClick = event.target.innerText !== undefined && event.target.innerText !== '';\n\n      if (onClick && !this.props.settingSelectedMessageConversation) {\n        this.onClick(messageConversation);\n        this.props.checkedIds.length > 0 && this.props.clearCheckedIds();\n\n        if (this.props.wideview && (this.props.messageFilter !== undefined || this.props.priorityFilter !== undefined || this.props.statusFilter !== undefined)) {\n          this.props.setFilter(undefined, 'MESSAGE');\n        }\n      }\n    }} onMouseEnter={this.onMouseEnter} onMouseLeave={this.onMouseLeave}>\n                <Checkbox checked={checked} style={styles.checkBox(this.props.wideview)} onCheck={() => {\n        this.props.setChecked(messageConversation, !checked);\n      }} />\n                <div style={styles.sender(this.props.wideview, fontWeight)}>\n                    {messageConversation.followUp && <Flag style={styles.flag} />}\n                    <span>{title}</span>\n                </div>\n                <Subheader style={styles.subject(this.props.wideview, fontColor, fontWeight)}>\n                    {messageConversation.subject}\n                </Subheader>\n                {displayExtendedChoices && <ExtendedChoiceLabel showTitle={false} title={i18n.t('Status')} color={fontColor} fontWeight={fontWeight} label={messageConversation.status} />}\n                {displayExtendedChoices && <ExtendedChoiceLabel showTitle={false} title={i18n.t('Priority')} color={fontColor} fontWeight={fontWeight} label={messageConversation.priority} />}\n                {this.props.notification && this.props.wideview && <ExtendedChoiceLabel showTitle={false} title={i18n.t('Assignee')} color={fontColor} fontWeight={fontWeight} label={messageConversation.assignee ? messageConversation.assignee.displayName : undefined} />}\n                <Subheader style={styles.dateFormat(this.props.wideview, fontColor, fontWeight)}>\n                    {today.diff(messageDate, 'hours') < 72 ? messageDate.from(today) : today.year() === messageDate.year() ? messageDate.format('MMM DD') : messageDate.format('ll')}\n                </Subheader>\n            </Paper>;\n  }\n\n}\n\nMessageConversationListItem.propTypes = {\n  attachments: propTypes.array,\n  checkedIds: propTypes.array,\n  clearAttachments: propTypes.func,\n  clearCheckedIds: propTypes.func,\n  displayExtendedChoices: propTypes.bool,\n  displayTimeDiff: propTypes.number,\n  markMessageConversations: propTypes.func,\n  messageConversation: propTypes.object,\n  messageFilter: propTypes.string,\n  notification: propTypes.bool,\n  priorityFilter: propTypes.string,\n  selectedMessageConversation: propTypes.object,\n  selectedMessageType: propTypes.object,\n  setChecked: propTypes.func,\n  setFilter: propTypes.func,\n  setSelectedMessageConversation: propTypes.func,\n  settingSelectedMessageConversation: propTypes.bool,\n  statusFilter: propTypes.string,\n  updateInputFields: propTypes.func,\n  wideview: propTypes.bool\n};\n\nconst mapStateToProps = state => ({\n  selectedMessageConversation: state.messaging.selectedMessageConversation,\n  settingSelectedMessageConversation: state.messaging.settingSelectedMessageConversation,\n  selectedMessageType: state.messaging.selectedMessageType,\n  checkedIds: state.messaging.checkedIds,\n  displayTimeDiff: state.messaging.displayTimeDiff,\n  messageFilter: state.messaging.messageFilter,\n  statusFilter: state.messaging.statusFilter,\n  priorityFilter: state.messaging.priorityFilter,\n  attachments: state.messaging.attachments\n});\n\nexport default compose(connect(mapStateToProps, {\n  setChecked,\n  setSelectedMessageConversation,\n  markMessageConversations,\n  clearCheckedIds,\n  setFilter,\n  updateInputFields,\n  clearAttachments\n}, null, {\n  pure: false\n}))(MessageConversationListItem);","import React, { Component } from 'react';\nimport propTypes from '@dhis2/prop-types';\nimport { connect } from 'react-redux';\nimport { compose } from 'recompose';\nimport Subheader from 'material-ui/Subheader/Subheader';\nimport CircularProgress from 'material-ui/CircularProgress';\nimport i18n from '@dhis2/d2-i18n';\nimport { loadMessageConversations } from '../../actions/index.js';\nimport { messagePanelContainer } from '../../styles/style.js';\nimport theme from '../../styles/theme.js';\nimport ListItemHeader from './ListItemHeader.js';\nimport MessageConversationListItem from './MessageConversationListItem.js';\nimport { dedupeById, debounce } from '../../utils/helpers.js';\nconst NOTIFICATIONS = ['VALIDATION_RESULT', 'TICKET'];\nconst bottomEmptyHeight = 50;\nconst styles = {\n  canvas(wideview) {\n    return {\n      flex: '1 0',\n      maxWidth: wideview ? 'none' : '350px',\n      minWidth: wideview ? 'none' : '250px',\n      borderRightStyle: wideview ? '' : 'solid',\n      ...messagePanelContainer\n    };\n  },\n\n  loading: {\n    backgroundColor: theme.palette.accent2Color,\n    height: `${bottomEmptyHeight}px`,\n    transition: 'all 0.2s ease-in-out',\n    display: 'flex',\n    justifyContent: 'center'\n  }\n};\n\nclass MessageConversationList extends Component {\n  onScroll = messageType => {\n    const messageList = document.getElementById('messagelist');\n\n    if (!this.props.selectedMessageType.loading && this.isBottom(messageList) && messageType.loaded < messageType.total) {\n      this.props.loadMessageConversations(messageType, messageType.id, true);\n    }\n  };\n  debouncedOnScroll = debounce(this.onScroll, 150);\n  isBottom = el => el.scrollHeight - el.scrollTop < window.outerHeight;\n\n  render() {\n    const messages = dedupeById(this.props.messageConversations[this.props.selectedMessageType.id]);\n    const messageType = this.props.selectedMessageType ? this.props.selectedMessageType : '';\n    const selectedValue = this.props.selectedMessageConversation ? this.props.selectedMessageConversation.id : '';\n    const notification = !!(NOTIFICATIONS.indexOf(messageType.id) + 1);\n    return <div id={'messagelist'} onScroll={() => this.debouncedOnScroll(this.props.selectedMessageType)} style={styles.canvas(this.props.wideview)}>\n                {this.props.wideview && <ListItemHeader notification={notification} displayExtendedChoices={this.props.displayExtendedChoices} messages={messages} />}\n                {messages && messages.length !== 0 ? messages.map(child => <MessageConversationListItem key={child.id} messageConversation={child} wideview={this.props.wideview} selectedValue={selectedValue} notification={notification} displayExtendedChoices={this.props.displayExtendedChoices} />) : !this.props.selectedMessageType.loading && <Subheader>\n                              {i18n.t(`No ${messageType.displayName.toLowerCase()} messages`)}\n                          </Subheader>}\n                {this.props.selectedMessageType.loading && <div style={styles.loading}>\n                        <CircularProgress style={{\n          marginTop: '10px'\n        }} color={theme.palette.primary1Color} />\n                    </div>}\n            </div>;\n  }\n\n}\n\nMessageConversationList.propTypes = {\n  displayExtendedChoices: propTypes.bool,\n  loadMessageConversations: propTypes.func,\n  messageConversations: propTypes.object,\n  selectedMessageConversation: propTypes.object,\n  selectedMessageType: propTypes.shape({\n    id: propTypes.string,\n    loading: propTypes.bool\n  }),\n  wideview: propTypes.bool\n};\n\nconst mapStateToProps = state => ({\n  messageTypes: state.messaging.messageTypes,\n  messageFilter: state.messaging.messageFilter,\n  statusFilter: state.messaging.statusFilter,\n  priorityFilter: state.messaging.priorityFilter,\n  messageConversations: state.messaging.messageConversations,\n  selectedMessageConversation: state.messaging.selectedMessageConversation,\n  selectedMessageType: state.messaging.selectedMessageType\n});\n\nexport default compose(connect(mapStateToProps, {\n  loadMessageConversations\n}, null, {\n  pure: false\n}))(MessageConversationList);","import React, { Component } from 'react';\nimport propTypes from '@dhis2/prop-types';\nimport { connect } from 'react-redux';\nimport { compose } from 'recompose';\nimport i18n from '@dhis2/d2-i18n';\nimport { Card, CardActions, CardText } from 'material-ui/Card';\nimport RaisedButton from 'material-ui/RaisedButton';\nimport FlatButton from 'material-ui/FlatButton';\nimport TextField from 'material-ui/TextField';\nimport Subheader from 'material-ui/Subheader/Subheader';\nimport RadioButton from 'material-ui/RadioButton';\nimport { sendMessage, sendFeedbackMessage, displaySnackMessage, updateInputFields, addAttachment, removeAttachment, cancelAttachment, addRecipientByUserId } from '../../actions/index.js';\nimport history from '../../utils/history.js';\nimport { supportsAttachments } from '../../utils/helpers.js';\nimport SuggestionField from '../Common/SuggestionField.js';\nimport AttachmentUploadButton from '../Attachments/AttachmentUploadButton.js';\nimport { NEGATIVE } from '../../constants/development.js';\nimport Attachments from '../Attachments/Attachments.js';\nimport { subheader } from '../../styles/style.js';\nconst styles = {\n  canvas: {\n    flex: '3 0',\n    margin: '10px',\n    overflowY: 'scroll',\n    overflowX: 'hidden',\n    height: 'calc(100vh - 110px)'\n  },\n  messageTypeField: {\n    display: 'flex',\n    flexDirection: 'row'\n  },\n  messageType: {\n    width: '300px',\n    marginTop: '10px'\n  }\n};\n\nclass CreateMessage extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isMessageFeedback: false\n    };\n  }\n\n  componentDidMount() {\n    const {\n      addRecipientByUserId\n    } = this.props;\n    const {\n      messageId,\n      recipientId\n    } = this.props.match.params; // This happens when the \"Send message\" button in the user-app is clicked\n\n    if (messageId === 'create' && recipientId) {\n      addRecipientByUserId(recipientId);\n    }\n  }\n\n  subjectUpdate = (event, newValue) => {\n    this.props.updateInputFields(newValue, this.props.input, this.props.recipients);\n  };\n  inputUpdate = (event, newValue) => {\n    this.props.updateInputFields(this.props.subject, newValue, this.props.recipients);\n  };\n  updateRecipients = recipients => {\n    this.props.updateInputFields(this.props.subject, this.props.input, recipients);\n  };\n  sendMessage = () => {\n    const messageTypeId = this.state.isMessageFeedback ? 'TICKET' : 'PRIVATE';\n    const messageType = this.props.messageTypes.find(messageType => messageType.id === messageTypeId);\n\n    if (this.state.isMessageFeedback) {\n      this.props.sendFeedbackMessage(messageType);\n      history.push('/TICKET');\n    } else {\n      const users = this.props.recipients.filter(r => r.type === 'user');\n      const userGroups = this.props.recipients.filter(r => r.type === 'userGroup');\n      const organisationUnits = this.props.recipients.filter(r => r.type === 'organisationUnit');\n      this.props.sendMessage({\n        users,\n        userGroups,\n        organisationUnits,\n        messageType\n      });\n      history.push('/PRIVATE');\n    }\n  };\n  wipeInput = () => {\n    this.props.updateInputFields('', '', []);\n    this.props.attachments.length > 0 && this.props.clearAttachments();\n  };\n  handleDiscard = () => {\n    const message = i18n.t('Message discarded');\n    const snackType = NEGATIVE;\n\n    const onSnackActionClick = () => history.push('/PRIVATE/create');\n\n    const onSnackRequestClose = () => this.wipeInput();\n\n    this.props.displaySnackMessage({\n      message,\n      onSnackActionClick,\n      onSnackRequestClose,\n      snackType\n    });\n    history.push('/PRIVATE');\n  };\n\n  render() {\n    const disabled = this.props.subject === '' || this.props.input === '' || !this.state.isMessageFeedback && this.props.recipients.length === 0;\n    const discardDisabled = this.props.subject === '' && this.props.input === '' && !this.state.isMessageFeedback && this.props.recipients.length === 0;\n    return <div style={styles.canvas}>\n                <Subheader style={subheader}> {i18n.t('Create')}</Subheader>\n                <Card>\n                    <CardText>\n                        <SuggestionField style={{\n            margin: '0px'\n          }} label={i18n.t('To')} disabled={this.state.isMessageFeedback} recipients={this.state.isMessageFeedback ? [{\n            id: 'id',\n            displayName: i18n.t('Feedback recipient group')\n          }] : this.props.recipients} updateRecipients={this.updateRecipients} inputHeight={'100px'} />\n                        <div style={styles.messageTypeField}>\n                            <div style={styles.messageType}>\n                                <RadioButton label={i18n.t('Private message')} checked={!this.state.isMessageFeedback} onCheck={() => {\n                this.setState({\n                  isMessageFeedback: !this.state.isMessageFeedback\n                });\n              }} />\n                            </div>\n                            <div style={styles.messageType}>\n                                <RadioButton label={i18n.t('Feedback message')} checked={this.state.isMessageFeedback} onCheck={() => {\n                this.setState({\n                  isMessageFeedback: !this.state.isMessageFeedback\n                });\n              }} />\n                            </div>\n                        </div>\n                        <TextField floatingLabelText={i18n.t('Subject')} fullWidth value={this.props.subject} onChange={this.subjectUpdate} />\n                        <TextField key={'createMessage'} id={'createMessage'} rows={5} underlineShow={false} value={this.props.input} multiLine fullWidth floatingLabelText={i18n.t('Message')} onChange={this.inputUpdate} />\n                        {this.props.enableAttachments && <Attachments dataDirection={'upload'} attachments={this.props.attachments} removeAttachment={attachment => this.props.removeAttachment(attachment.id)} cancelAttachment={this.props.cancelAttachment} />}\n                        <CardActions style={{\n            paddingLeft: '0px'\n          }}>\n                            <RaisedButton primary disabled={disabled} label={i18n.t('Send')} onClick={() => this.sendMessage()} />\n                            <FlatButton label={i18n.t('Discard')} disabled={discardDisabled} onClick={this.handleDiscard} />\n                            {this.props.enableAttachments && <AttachmentUploadButton addAttachment={attachment => {\n              this.props.addAttachment(attachment);\n            }} />}\n                        </CardActions>\n                    </CardText>\n                </Card>\n            </div>;\n  }\n\n}\n\nCreateMessage.propTypes = {\n  addAttachment: propTypes.func,\n  addRecipientByUserId: propTypes.func,\n  attachments: propTypes.array,\n  cancelAttachment: propTypes.func,\n  clearAttachments: propTypes.func,\n  displaySnackMessage: propTypes.func,\n  enableAttachments: propTypes.bool,\n  input: propTypes.string,\n  match: propTypes.object,\n  messageTypes: propTypes.array,\n  recipients: propTypes.array,\n  removeAttachment: propTypes.func,\n  sendFeedbackMessage: propTypes.func,\n  sendMessage: propTypes.func,\n  subject: propTypes.string,\n  updateInputFields: propTypes.func\n};\n\nconst mapStateToProps = state => ({\n  messageTypes: state.messaging.messageTypes,\n  subject: state.messaging.subject,\n  input: state.messaging.input,\n  recipients: state.messaging.recipients,\n  attachments: state.messaging.attachments,\n  enableAttachments: supportsAttachments(state.messaging.dhis2CoreVersion)\n});\n\nexport default compose(connect(mapStateToProps, {\n  sendMessage,\n  sendFeedbackMessage,\n  displaySnackMessage,\n  updateInputFields,\n  addAttachment,\n  removeAttachment,\n  cancelAttachment,\n  addRecipientByUserId\n}, null, {\n  pure: false\n}))(CreateMessage);","import i18n from '@dhis2/d2-i18n';\nconst extendedChoices = {\n  STATUS: [{\n    key: 'NONE',\n    value: 'NONE',\n    primaryText: i18n.t('No status')\n  }, {\n    key: 'OPEN',\n    value: 'OPEN',\n    primaryText: i18n.t('Open')\n  }, {\n    key: 'PENDING',\n    value: 'PENDING',\n    primaryText: i18n.t('Pending')\n  }, {\n    key: 'INVALID',\n    value: 'INVALID',\n    primaryText: i18n.t('Invalid')\n  }, {\n    key: 'SOLVED',\n    value: 'SOLVED',\n    primaryText: i18n.t('Solved')\n  }],\n  PRIORITY: [{\n    key: 'NONE',\n    value: 'NONE',\n    primaryText: i18n.t('No priority')\n  }, {\n    key: 'HIGH',\n    value: 'HIGH',\n    primaryText: i18n.t('High')\n  }, {\n    key: 'MEDIUM',\n    value: 'MEDIUM',\n    primaryText: i18n.t('Medium')\n  }, {\n    key: 'LOW',\n    value: 'LOW',\n    primaryText: i18n.t('Low')\n  }]\n};\nexport default extendedChoices;","import React from 'react';\nimport propTypes from '@dhis2/prop-types';\nimport { Provider, ReactReduxContext } from 'react-redux';\nimport Dialog from 'material-ui/Dialog';\n/*\n * This component is needed because in this version of MUI\n * the redux context is not propagated onto a Portal\n */\n\nexport default function DialogWithReduxState(props) {\n  return <ReactReduxContext.Consumer>\n            {ctx => <Dialog {...props}>\n                    <Provider store={ctx.store}>{props.children}</Provider>\n                </Dialog>}\n        </ReactReduxContext.Consumer>;\n}\nDialogWithReduxState.propTypes = {\n  children: propTypes.node\n};","import React from 'react';\nimport propTypes from '@dhis2/prop-types';\nimport i18n from '@dhis2/d2-i18n';\nimport SuggestionField from './SuggestionField.js';\nimport DialogWithReduxState from './DialogWithReduxState.js';\n\nconst AssignToDialog = ({\n  open,\n  onRequestClose,\n  updateMessageConversations,\n  messageType,\n  feedbackRecipientsId\n}) => <DialogWithReduxState open={open} onRequestClose={() => {\n  onRequestClose();\n}}>\n        <SuggestionField onSuggestionClick={chip => {\n    updateMessageConversations([chip.id]);\n    onRequestClose();\n  }} searchOnlyUsers searchOnlyFeedbackRecipients={messageType.id === 'TICKET'} feedbackRecipientsId={feedbackRecipientsId} recipients={[]} key={'suggestionField'} label={i18n.t('Assignee')} />\n    </DialogWithReduxState>;\n\nAssignToDialog.propTypes = {\n  feedbackRecipientsId: propTypes.string,\n  messageType: propTypes.shape({\n    id: propTypes.string\n  }),\n  open: propTypes.bool,\n  updateMessageConversations: propTypes.func,\n  onRequestClose: propTypes.func\n};\nexport default AssignToDialog;","import React, { Component } from 'react';\nimport propTypes from '@dhis2/prop-types';\nimport { connect } from 'react-redux';\nimport { compose } from 'recompose';\nimport FlatButton from 'material-ui/FlatButton';\nimport MoreVertIcon from 'material-ui/svg-icons/navigation/more-vert';\nimport ArrowDropRight from 'material-ui/svg-icons/navigation-arrow-drop-right';\nimport Assignment from 'material-ui-icons/Assignment';\nimport IconMenu from 'material-ui/IconMenu';\nimport MenuItem from 'material-ui/MenuItem';\nimport IconButton from 'material-ui/IconButton';\nimport Subheader from 'material-ui/Subheader';\nimport Divider from 'material-ui/Divider';\nimport Delete from 'material-ui-icons/Delete';\nimport MarkUnread from 'material-ui-icons/Markunread';\nimport Done from 'material-ui-icons/Done';\nimport i18n from '@dhis2/d2-i18n';\nimport { clearCheckedIds, clearSelectedMessageConversation, deleteMessageConversations, updateMessageConversations, markMessageConversations } from '../../actions/index.js';\nimport extendedChoices from '../../constants/extendedChoices.js';\nimport history from '../../utils/history.js';\nimport AssignToDialog from './AssignToDialog.js';\nimport DialogWithReduxState from './DialogWithReduxState.js';\nconst multiSelectDisplayLimit = 99;\nconst styles = {\n  canvas: {\n    width: '400px',\n    display: 'flex'\n  },\n  extendedChoices: {\n    display: 'flex',\n    justifyContent: 'flex-start'\n  },\n  nrSelected: {\n    padding: '0px 0px',\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n    whiteSpace: 'nowrap'\n  }\n};\n\nclass ToolbarExtendedChoicePicker extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      checkedItems: false,\n      dialogOpen: false,\n      assignToOpen: false\n    };\n  }\n\n  getIds = () => this.props.selectedMessageConversation && this.props.checkedIds.length === 0 ? [this.props.selectedMessageConversation.id] : this.props.checkedIds.map(id => id.id);\n  updateMessageConversation = (identifier, value) => {\n    const {\n      selectedMessageType: messageType,\n      selectedMessageConversation\n    } = this.props;\n    const messageConversationIds = this.getIds();\n    this.props.updateMessageConversations({\n      messageConversationIds,\n      identifier,\n      value,\n      messageType,\n      selectedMessageConversation\n    });\n    this.props.checkedIds.length > 0 && this.props.clearCheckedIds();\n  };\n  markMessageConversations = mode => {\n    const ids = this.getIds();\n    this.props.markMessageConversations(mode, ids, this.props.selectedMessageType);\n    this.props.checkedIds.length > 0 && this.props.clearCheckedIds();\n  };\n  toggleDialog = () => {\n    this.setState({\n      dialogOpen: !this.state.dialogOpen\n    });\n  };\n\n  render() {\n    const messageConversation = this.props.selectedMessageConversation;\n    const multiSelect = this.props.checkedIds.length > 0;\n    const display = multiSelect || messageConversation !== undefined;\n    const actionButtons = <>\n                <FlatButton label={i18n.t('Cancel')} primary onClick={() => this.toggleDialog()} />\n                <FlatButton label={i18n.t('Submit')} primary keyboardFocused onClick={() => {\n        this.props.deleteMessageConversations(this.getIds(), this.props.selectedMessageType);\n        this.props.clearCheckedIds();\n        this.toggleDialog();\n\n        if (this.props.selectedMessageConversation) {\n          this.props.clearSelectedMessageConversation();\n          history.push(`/${this.props.selectedMessageType.id}`);\n        }\n      }} />\n            </>;\n    const displayNumberOfCheckedIds = this.props.checkedIds.length > multiSelectDisplayLimit ? `${multiSelectDisplayLimit}+` : this.props.checkedIds.length;\n    return display ? <div style={styles.canvas}>\n                <DialogWithReduxState title={i18n.t('Are you sure you want to delete selected message conversation(s)?')} actions={actionButtons} modal={false} open={this.state.dialogOpen} onRequestClose={this.toggleDialog} />\n                <AssignToDialog open={this.state.assignToOpen} onRequestClose={() => this.setState({\n        assignToOpen: !this.state.assignToOpen\n      })} updateMessageConversations={id => this.updateMessageConversation('ASSIGNEE', id)} messageType={this.props.selectedMessageType} feedbackRecipientsId={this.props.feedbackRecipientsId} />\n\n                <div style={styles.extendedChoices}>\n                    <IconButton tooltip={i18n.t('Delete selected')} onClick={() => {\n          this.toggleDialog();\n        }}>\n                        <Delete />\n                    </IconButton>\n\n                    <IconButton tooltip={i18n.t('Mark selected as unread')} onClick={() => {\n          this.markMessageConversations('unread');\n        }}>\n                        <MarkUnread />\n                    </IconButton>\n\n                    <IconButton tooltip={i18n.t('Mark selected as read')} onClick={() => {\n          this.markMessageConversations('read');\n        }}>\n                        <Done />\n                    </IconButton>\n                    {this.props.displayExtendedChoices && <IconButton onClick={() => this.setState({\n          assignToOpen: !this.state.assignToOpen\n        })} tooltip={i18n.t('Assign selected')}>\n                            <Assignment />\n                        </IconButton>}\n                    {<IconMenu iconButtonElement={<IconButton>\n                                    <MoreVertIcon />\n                                </IconButton>} anchorOrigin={{\n          horizontal: 'left',\n          vertical: 'top'\n        }} targetOrigin={{\n          horizontal: 'left',\n          vertical: 'top'\n        }}>\n                            <MenuItem key={'markFollowUp'} value={'markFollowUp'} primaryText={i18n.t('Mark for followup')} onClick={() => this.updateMessageConversation('FOLLOW_UP', true)} />\n                            <MenuItem key={'clearFollowUp'} value={'clearFollowUp'} primaryText={i18n.t('Clear followup')} onClick={() => this.updateMessageConversation('FOLLOW_UP', false)} />\n                            {this.props.displayExtendedChoices && <Divider />}\n                            {this.props.displayExtendedChoices && <MenuItem key={'clearAssigned'} value={'clearAssigned'} primaryText={i18n.t('Clear assignee')} onClick={() => this.updateMessageConversation('ASSIGNEE', undefined)} />}\n                            {this.props.displayExtendedChoices && <MenuItem primaryText={i18n.t('Set status')} key={'setStatus'} rightIcon={<ArrowDropRight />} menuItems={extendedChoices.STATUS.map(elem => <MenuItem key={`${elem.key}_status`} value={elem.value} primaryText={elem.primaryText} onClick={() => this.updateMessageConversation('STATUS', elem.key)} />)} />}\n                            {this.props.displayExtendedChoices && <MenuItem primaryText={i18n.t('Set priority')} key={'setPriority'} rightIcon={<ArrowDropRight />} menuItems={extendedChoices.PRIORITY.map(elem => <MenuItem key={`${elem.key}_priority`} value={elem.value} primaryText={elem.primaryText} onClick={() => this.updateMessageConversation('PRIORITY', elem.key)} />)} />}\n                        </IconMenu>}\n                </div>\n                {multiSelect && <Subheader style={styles.nrSelected}>\n                        {`${displayNumberOfCheckedIds} ${i18n.t('selected')}`}\n                    </Subheader>}\n            </div> : <div />;\n  }\n\n}\n\nToolbarExtendedChoicePicker.propTypes = {\n  checkedIds: propTypes.array,\n  clearCheckedIds: propTypes.func,\n  clearSelectedMessageConversation: propTypes.func,\n  deleteMessageConversations: propTypes.func,\n  displayExtendedChoices: propTypes.bool,\n  feedbackRecipientsId: propTypes.string,\n  markMessageConversations: propTypes.func,\n  selectedMessageConversation: propTypes.object,\n  selectedMessageType: propTypes.object,\n  updateMessageConversations: propTypes.func\n};\n\nconst mapStateToProps = state => ({\n  selectedMessageType: state.messaging.selectedMessageType,\n  selectedMessageConversation: state.messaging.selectedMessageConversation,\n  checkedIds: state.messaging.checkedIds,\n  feedbackRecipientsId: state.messaging.feedbackRecipientsId\n});\n\nexport default compose(connect(mapStateToProps, {\n  clearCheckedIds,\n  clearSelectedMessageConversation,\n  deleteMessageConversations,\n  updateMessageConversations,\n  markMessageConversations\n}, null, {\n  pure: false\n}))(ToolbarExtendedChoicePicker);","import React, { Component } from 'react';\nimport propTypes from '@dhis2/prop-types';\nimport ViewFancy from 'material-ui-icons/ViewList';\nimport ViewList from 'material-ui-icons/ViewHeadline';\nimport FlatButton from 'material-ui/FlatButton';\nimport Paper from 'material-ui/Paper';\nimport CreateMessageIcon from 'material-ui-icons/Add';\nimport NavigationBack from 'material-ui-icons/ArrowBack';\nimport TextField from 'material-ui/TextField';\nimport SelectField from 'material-ui/SelectField';\nimport MenuItem from 'material-ui/MenuItem';\nimport Subheader from 'material-ui/Subheader';\nimport IconMenu from 'material-ui/IconMenu';\nimport IconButton from 'material-ui/IconButton';\nimport Checkbox from 'material-ui/Checkbox/Checkbox';\nimport MoreVertIcon from 'material-ui/svg-icons/navigation/more-vert';\nimport i18n from '@dhis2/d2-i18n';\nimport history from '../../utils/history.js';\nimport theme from '../../styles/theme.js';\nimport extendedChoices from '../../constants/extendedChoices.js';\nimport ToolbarExtendedChoicePicker from './ToolbarExtendedChoicePicker.js';\nimport { debounce } from '../../utils/helpers.js';\nconst headerHeight = '48px';\nconst searchDelay = 300;\nconst styles = {\n  canvas(checkedOptions) {\n    return {\n      display: 'flex',\n      justifyContent: 'flex-start',\n      alignItems: 'center',\n      backgroundColor: checkedOptions ? theme.palette.blue50 : theme.palette.accent2Color,\n      zIndex: 10\n    };\n  },\n\n  checkedOption: {\n    display: 'flex',\n    justifyContent: 'flex-start',\n    minWidth: '200px',\n    margin: '6px 0'\n  },\n  filterControl: {\n    flex: 2,\n    height: headerHeight,\n    marginRight: 16,\n    maxWidth: 256\n  },\n  rightHandCanvas: {\n    flex: '2 0',\n    display: 'flex',\n    paddingLeft: 16\n  },\n  // IE11 has buggy support for `justifyContent: flex-end;`\n  // to achieve the same result we use a spacer div\n  ie11Spacer: {\n    flexGrow: 1\n  },\n  iconMenu: {\n    width: '30px',\n    display: 'flex'\n  }\n};\n\nclass Toolbar extends Component {\n  state = {\n    lastMessageFilter: ''\n  };\n  debouncedSearch = debounce(this.search, searchDelay);\n\n  search(messageFilter) {\n    if (this.props.selectedMessageType && this.state.lastMessageFilter !== messageFilter) {\n      this.props.loadMessageConversations(this.props.selectedMessageType, this.props.selectedMessageType.id);\n      this.setState({\n        lastMessageFilter: messageFilter\n      });\n    }\n  }\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.selectedMessageType && this.props.selectedMessageType.id !== prevProps.selectedMessageType.id) {\n      this.debouncedSearch('');\n      this.props.messageFilter !== undefined && this.props.setFilter(undefined, 'MESSAGE');\n      this.props.statusFilter !== undefined && this.props.setFilter(undefined, 'STATUS');\n      this.props.priorityFilter !== undefined && this.props.setFilter(undefined, 'PRIORITY');\n      this.props.assignedToMeFilter && this.props.setFilter(false, 'ASSIGNED_TO_ME');\n      this.props.markedForFollowUpFilter && this.props.setFilter(false, 'MARKED_FOR_FOLLOWUP');\n      this.props.unreadFilter && this.props.setFilter(false, 'UNREAD');\n    }\n\n    if (this.props.selectedMessageType !== undefined && !this.props.selectedMessageType.loading && (prevProps.statusFilter !== this.props.statusFilter || prevProps.priorityFilter !== this.props.priorityFilter || prevProps.assignedToMeFilter !== this.props.assignedToMeFilter || prevProps.markedForFollowUpFilter !== this.props.markedForFollowUpFilter || prevProps.unreadFilter !== this.props.unreadFilter || prevProps.selectedMessageType === undefined || prevProps.selectedMessageType.id !== this.props.selectedMessageType.id)) {\n      this.props.loadMessageConversations(this.props.selectedMessageType, this.props.selectedMessageType.id);\n    }\n  }\n\n  render() {\n    const id = this.props.id;\n    const displayExtendedChoices = this.props.displayExtendedChoices;\n    const checkedOptions = this.props.checkedOptions;\n    const displaySearch = !this.props.wideview || this.props.selectedMessageConversation === undefined && id !== 'create';\n    return <Paper style={styles.canvas(checkedOptions)}>\n                <div>\n                    {!checkedOptions && <FlatButton style={styles.checkedOption} icon={<CreateMessageIcon />} onClick={() => history.push('/PRIVATE/create')} label={i18n.t('Compose')} />}\n\n                    {checkedOptions && <FlatButton style={styles.checkedOption} icon={<NavigationBack />} onClick={() => this.props.clearCheckedIds()} label={i18n.t('Deselect all')} />}\n                </div>\n\n                <ToolbarExtendedChoicePicker displayExtendedChoices={displayExtendedChoices} />\n\n                <div style={styles.rightHandCanvas}>\n                    <div style={styles.ie11Spacer} />\n                    {displayExtendedChoices && displaySearch && !checkedOptions && <SelectField style={styles.filterControl} labelStyle={{\n          color: this.props.statusFilter === undefined ? 'lightGray' : 'black',\n          top: this.props.statusFilter === undefined ? '-15px' : '-2px'\n        }} selectedMenuItemStyle={{\n          color: theme.palette.primary1Color\n        }} floatingLabelText={this.props.statusFilter === undefined ? i18n.t('Status') : ''} floatingLabelStyle={{\n          top: '15px'\n        }} iconStyle={{\n          top: this.props.statusFilter === undefined ? '-15px' : '0px'\n        }} value={this.props.statusFilter} onChange={(event, key, payload) => {\n          this.props.setFilter(payload === null ? undefined : payload, 'STATUS');\n        }}>\n                                <MenuItem key={null} value={null} primaryText={''} />\n                                {extendedChoices.STATUS.map(elem => <MenuItem key={elem.key} value={elem.value} primaryText={elem.primaryText} />)}\n                            </SelectField>}\n\n                    {displayExtendedChoices && displaySearch && !checkedOptions && <SelectField style={styles.filterControl} labelStyle={{\n          color: this.props.priorityFilter === undefined ? 'lightGray' : 'black',\n          top: this.props.priorityFilter === undefined ? '-15px' : '-2px'\n        }} selectedMenuItemStyle={{\n          color: theme.palette.primary1Color\n        }} floatingLabelText={this.props.priorityFilter === undefined ? i18n.t('Priority') : ''} floatingLabelStyle={{\n          top: '15px'\n        }} iconStyle={{\n          top: this.props.priorityFilter === undefined ? '-15px' : '0px'\n        }} value={this.props.priorityFilter} onChange={(event, key, payload) => {\n          this.props.setFilter(payload === null ? undefined : payload, 'PRIORITY');\n        }}>\n                                <MenuItem key={null} value={null} primaryText={''} />\n                                {extendedChoices.PRIORITY.map(elem => <MenuItem key={elem.key} value={elem.value} primaryText={elem.primaryText} />)}\n                            </SelectField>}\n\n                    {!checkedOptions && displaySearch && <TextField style={styles.filterControl} fullWidth hintText={i18n.t('Search')} value={this.props.messageFilter || ''} onChange={(event, messageFilter) => {\n          this.debouncedSearch(messageFilter);\n          this.props.setFilter(messageFilter, 'MESSAGE');\n        }} type=\"search\" />}\n\n                    {!checkedOptions && displaySearch && <IconMenu iconButtonElement={<IconButton>\n                                    <MoreVertIcon />\n                                </IconButton>} anchorOrigin={{\n          horizontal: 'right',\n          vertical: 'top'\n        }} targetOrigin={{\n          horizontal: 'right',\n          vertical: 'top'\n        }} style={styles.iconMenu} menuStyle={{\n          overflowX: 'hidden'\n        }}>\n                            <Subheader style={{\n            padding: '0px 16px'\n          }}>\n                                {i18n.t('Set filter')}\n                            </Subheader>\n                            {this.props.displayExtendedChoices && <Checkbox style={{\n            padding: '0px 16px'\n          }} key={'assignedToMeFilter'} label={i18n.t('Assigned to me')} checked={this.props.assignedToMeFilter} onClick={() => {\n            this.props.setFilter(!this.props.assignedToMeFilter, 'ASSIGNED_TO_ME');\n          }} />}\n                            <Checkbox style={{\n            padding: '0px 16px'\n          }} key={'markedForFollowUpFilter'} label={i18n.t('Marked for followup')} checked={this.props.markedForFollowUpFilter} onClick={() => {\n            this.props.setFilter(!this.props.markedForFollowUpFilter, 'MARKED_FOR_FOLLOWUP');\n          }} />\n                            <Checkbox style={{\n            padding: '0px 16px'\n          }} key={'unreadFilter'} label={i18n.t('Unread messages')} checked={this.props.unreadFilter} onClick={() => {\n            this.props.setFilter(!this.props.unreadFilter, 'UNREAD');\n          }} />\n                        </IconMenu>}\n                    <FlatButton style={{\n          width: '50px',\n          alignSelf: 'center'\n        }} icon={!this.props.wideview ? <ViewList /> : <ViewFancy />} onClick={() => this.props.toogleWideview()} />\n                </div>\n            </Paper>;\n  }\n\n}\n\nToolbar.propTypes = {\n  assignedToMeFilter: propTypes.bool,\n  checkedOptions: propTypes.bool,\n  clearCheckedIds: propTypes.func,\n  displayExtendedChoices: propTypes.bool,\n  id: propTypes.string,\n  loadMessageConversations: propTypes.func,\n  markedForFollowUpFilter: propTypes.bool,\n  messageFilter: propTypes.string,\n  priorityFilter: propTypes.string,\n  selectedMessageConversation: propTypes.object,\n  selectedMessageType: propTypes.object,\n  setFilter: propTypes.func,\n  statusFilter: propTypes.string,\n  toogleWideview: propTypes.func,\n  unreadFilter: propTypes.bool,\n  wideview: propTypes.bool\n};\nexport default Toolbar;","import React, { Component } from 'react';\nimport propTypes from '@dhis2/prop-types';\nimport { connect } from 'react-redux';\nimport { compose } from 'recompose';\nimport Subheader from 'material-ui/Subheader/Subheader';\nimport MailIcon from 'material-ui-icons/MailOutline';\nimport i18n from '@dhis2/d2-i18n';\nimport * as api from '../../api/api.js';\nimport { loadMessageConversations, setIsInFeedbackRecipientGroup, clearCheckedIds, setSelectedMessageConversation, setSelectedMessageType, clearSelectedMessageConversation, updateInputFields, setFilter, setDisplayTimeDiff, clearAttachments } from '../../actions/index.js';\nimport theme from '../../styles/theme.js';\nimport MessageConversation from '../MessageConversation/MessageConversation.js';\nimport SidebarList from '../List/SidebarList.js';\nimport MessageConversationList from '../List/MessageConversationList.js';\nimport CreateMessage from '../MessageConversation/CreateMessage.js';\nimport Toolbar from '../Common/Toolbar.js';\nimport { subheader } from '../../styles/style.js';\nimport './MessagingCenter.css';\nconst EXTENDED_CHOICES = ['TICKET', 'VALIDATION_RESULT'];\nconst refreshTimerTotal = 300000; // 5 minutes\n\nconst refreshTimerInterval = 10000; // 10 seconds\n\nclass MessagingCenter extends Component {\n  constructor(props) {\n    super(props);\n    this.intervalId = null;\n    this.state = {\n      autoRefresh: false,\n      checkedItems: false,\n      refreshTimer: refreshTimerTotal,\n      wideview: true\n    };\n  }\n\n  componentDidMount() {\n    const selectedMessageType = this.props.match.params.messageType;\n    const selectedId = this.props.match.params.messageId;\n\n    if (selectedId && selectedId !== selectedMessageType && selectedId !== 'create') {\n      const initialMessageConversation = {\n        id: selectedId\n      };\n      this.props.setSelectedMessageConversation(initialMessageConversation);\n    }\n\n    api.isInFeedbackRecipientGroup(this.props.currentUser).then(result => this.props.setIsInFeedbackRecipientGroup(result));\n    this.props.messageTypes.map(messageType => this.props.loadMessageConversations(messageType, selectedMessageType));\n    this.props.setDisplayTimeDiff();\n  }\n\n  componentDidUpdate() {\n    const selectedMessageType = this.props.match.params.messageType;\n    const selectedId = this.props.match.params.messageId;\n\n    if (!this.props.settingSelectedMessageConversation && selectedId && selectedMessageType !== selectedId && selectedId !== 'create' && (this.props.selectedMessageConversation === undefined || selectedId !== this.props.selectedMessageConversation.id)) {\n      const initialMessageConversation = {\n        id: selectedId\n      };\n      this.props.setSelectedMessageConversation(initialMessageConversation);\n    }\n\n    if (selectedMessageType === selectedId && selectedMessageType !== this.props.selectedMessageType.id) {\n      this.props.setSelectedMessageType(selectedMessageType);\n    }\n\n    if ((selectedMessageType === selectedId || selectedId === 'create') && this.props.selectedMessageConversation !== undefined) {\n      this.props.clearSelectedMessageConversation();\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.intervalId) {\n      clearInterval(this.intervalId);\n    }\n  }\n\n  setAutoRefresh = autoRefresh => {\n    // Cancel existing interval if it shouldn't autorefresh\n    if (!autoRefresh && this.intervalId) {\n      clearInterval(this.intervalId);\n      this.intervalId = null;\n    }\n\n    if (autoRefresh) {\n      this.intervalId = setInterval(this.tick, refreshTimerInterval);\n    }\n\n    this.setState({\n      autoRefresh,\n      refreshTimer: refreshTimerTotal\n    });\n  };\n  tick = () => {\n    const timerHasElapsed = this.state.refreshTimer - refreshTimerInterval <= 0;\n\n    if (timerHasElapsed) {\n      this.refresh();\n      this.setState({\n        refreshTimer: refreshTimerTotal\n      });\n    } else {\n      this.setState(prevState => ({\n        refreshTimer: prevState.refreshTimer - refreshTimerInterval\n      }));\n    }\n  };\n  refresh = () => {\n    this.props.messageTypes.map(messageType => this.props.loadMessageConversations(messageType, this.props.selectedMessageType));\n\n    if (this.props.selectedMessageConversation) {\n      this.props.setSelectedMessageConversation(this.props.selectedMessageConversation);\n    }\n  };\n  toogleWideview = () => {\n    this.setState({\n      wideview: !this.state.wideview\n    });\n  };\n\n  render() {\n    const id = this.props.match.params.messageId;\n    const displayExtendedChoices = (this.props.selectedMessageType ? !!(EXTENDED_CHOICES.indexOf(this.props.selectedMessageType.id) + 1) : false) && this.props.isInFeedbackRecipientGroup;\n    return <div className=\"messaging-center\">\n                <Toolbar {...this.props} id={id} wideview={this.state.wideview} displayExtendedChoices={displayExtendedChoices} toogleWideview={this.toogleWideview} />\n                <div className=\"messaging-center__main-content\">\n                    <SidebarList {...this.props} drawerOpen={this.state.drawerOpen} messageTypes={this.props.messageTypes} autoRefresh={this.state.autoRefresh} refreshTimer={this.state.refreshTimer} setAutoRefresh={this.setAutoRefresh} />\n\n                    {this.props.selectedMessageConversation === undefined && !(this.state.wideview && id === 'create') && <MessageConversationList wideview={this.state.wideview} displayExtendedChoices={displayExtendedChoices && this.state.wideview} />}\n\n                    {id === 'create' && <CreateMessage {...this.props} wideview={this.state.wideview} />}\n\n                    {this.props.selectedMessageConversation !== undefined && !this.state.wideview && <MessageConversationList wideview={this.state.wideview} displayExtendedChoices={displayExtendedChoices && this.state.wideview} />}\n\n                    {this.props.selectedMessageConversation && id !== 'create' ? this.props.selectedMessageConversation !== undefined && <MessageConversation {...this.props} messageConversation={this.props.selectedMessageConversation} wideview={this.state.wideview} disableLink displayExtendedChoices={displayExtendedChoices} /> : !this.state.wideview && id !== 'create' && <div className=\"messaging-center__no-message-selected\">\n                                  <Subheader style={subheader}>\n                                      {i18n.t('Select a message')}\n                                  </Subheader>\n                                  <MailIcon style={{\n            color: theme.palette.primary1Color,\n            width: 120,\n            height: 120\n          }} />\n                              </div>}\n                </div>\n            </div>;\n  }\n\n}\n\nMessagingCenter.propTypes = {\n  clearSelectedMessageConversation: propTypes.func,\n  currentUser: propTypes.object,\n  isInFeedbackRecipientGroup: propTypes.bool,\n  loadMessageConversations: propTypes.func,\n  match: propTypes.object,\n  messageTypes: propTypes.array,\n  selectedMessageConversation: propTypes.object,\n  selectedMessageType: propTypes.object,\n  setDisplayTimeDiff: propTypes.func,\n  setIsInFeedbackRecipientGroup: propTypes.func,\n  setSelectedMessageConversation: propTypes.func,\n  setSelectedMessageType: propTypes.func,\n  settingSelectedMessageConversation: propTypes.bool\n};\n\nconst mapStateToProps = state => ({\n  currentUser: state.messaging.currentUser,\n  snackMessage: state.messaging.snackMessage,\n  messageTypes: state.messaging.messageTypes,\n  messageConversations: state.messaging.messageConversations,\n  messageFilter: state.messaging.messageFilter,\n  statusFilter: state.messaging.statusFilter,\n  priorityFilter: state.messaging.priorityFilter,\n  assignedToMeFilter: state.messaging.assignedToMeFilter,\n  markedForFollowUpFilter: state.messaging.markedForFollowUpFilter,\n  unreadFilter: state.messaging.unreadFilter,\n  selectedMessageType: state.messaging.selectedMessageType,\n  selectedMessageConversation: state.messaging.selectedMessageConversation,\n  settingSelectedMessageConversation: state.messaging.settingSelectedMessageConversation,\n  checkedIds: state.messaging.checkedIds,\n  checkedOptions: state.messaging.checkedIds.length > 0,\n  loaded: state.messaging.loaded,\n  isInFeedbackRecipientGroup: state.messaging.isInFeedbackRecipientGroup,\n  attachments: state.messaging.attachments\n});\n\nexport default compose(connect(mapStateToProps, {\n  loadMessageConversations,\n  setIsInFeedbackRecipientGroup,\n  clearCheckedIds,\n  setSelectedMessageConversation,\n  setSelectedMessageType,\n  clearSelectedMessageConversation,\n  updateInputFields,\n  setFilter,\n  setDisplayTimeDiff,\n  clearAttachments\n}, null, {\n  pure: false\n}))(MessagingCenter);","import { Router, Route } from 'react-router-dom';\nimport { Redirect } from 'react-router';\nimport React from 'react';\nimport MessagingCenter from '../MessagingCenter/MessagingCenter.js';\nimport history from '../../utils/history.js';\n\nconst Routes = () => <Router history={history}>\n        <div>\n            <Route exact path=\"/\" component={() => <Redirect to=\"/PRIVATE\" />} />\n            <Route path=\"/:messageType/:messageId?/:recipientId?\" component={MessagingCenter} />\n        </div>\n    </Router>;\n\nexport default Routes;","import React, { useEffect } from 'react';\nimport propTypes from '@dhis2/prop-types';\nimport { useConfig } from '@dhis2/app-runtime';\nimport cx from 'classnames';\nimport { connect } from 'react-redux';\nimport { CircularProgress } from 'material-ui';\nimport CustomSnackBar from '../Common/CustomSnackBar.js';\nimport Routes from './Routes.js';\nimport { setCurrentUser, setDhis2CoreVersion } from '../../actions/index.js';\nimport classes from './App.module.css';\n\nconst App = ({\n  currentUser,\n  setCurrentUser,\n  setDhis2CoreVersion\n}) => {\n  const {\n    loading,\n    error\n  } = currentUser;\n  const {\n    serverVersion\n  } = useConfig();\n  useEffect(() => {\n    setDhis2CoreVersion(serverVersion.minor);\n    setCurrentUser();\n  }, []);\n\n  if (loading) {\n    return <div className={classes.center}>\n                <CircularProgress size={48} />\n            </div>;\n  }\n\n  if (error) {\n    return <div className={cx(classes.center, classes.error)}>{error}</div>;\n  }\n\n  return <div>\n            <CustomSnackBar />\n            <Routes />\n        </div>;\n};\n\nApp.propTypes = {\n  currentUser: propTypes.object.isRequired,\n  setCurrentUser: propTypes.func.isRequired,\n  setDhis2CoreVersion: propTypes.func.isRequired\n};\nexport default connect(state => ({\n  currentUser: state.messaging.currentUser\n}), {\n  setCurrentUser,\n  setDhis2CoreVersion\n})(App);","const messageTypes = [{\n  id: 'PRIVATE',\n  displayName: 'Inbox',\n  unread: 0,\n  loaded: 0,\n  loading: false,\n  total: 0,\n  page: 1\n}, {\n  id: 'VALIDATION_RESULT',\n  displayName: 'Validation',\n  unread: 0,\n  loaded: 0,\n  loading: false,\n  total: 0,\n  page: 1\n}, {\n  id: 'TICKET',\n  displayName: 'Ticket',\n  unread: 0,\n  loaded: 0,\n  loading: false,\n  total: 0,\n  page: 1\n}, {\n  id: 'SYSTEM',\n  displayName: 'System',\n  unread: 0,\n  loaded: 0,\n  loading: false,\n  total: 0,\n  page: 1\n}];\nexport default messageTypes;","import i18n from '@dhis2/d2-i18n';\nimport log from 'loglevel';\nimport * as actions from '../constants/actions.js';\nimport messageTypes from '../constants/messageTypes.js';\nimport { POSITIVE, NEGATIVE, NEUTRAL } from '../constants/development.js';\nimport { findIndexOfId } from '../utils/helpers.js';\nexport const initialState = {\n  currentUser: {\n    loading: true,\n    error: null,\n    id: null,\n    authorities: null,\n    userGroups: null\n  },\n  // Message conversation\n  messageConversations: {},\n  messageTypes,\n  selectedMessageType: undefined,\n  selectedMessageConversation: undefined,\n  settingSelectedMessageConversation: false,\n  checkedIds: [],\n  messageFilter: undefined,\n  statusFilter: undefined,\n  priorityFilter: undefined,\n  assignedToMeFilter: false,\n  markedForFollowUpFilter: false,\n  unreadFilter: false,\n  isInFeedbackRecipientGroup: false,\n  feedbackRecipientsId: undefined,\n  displayTimeDiff: 0,\n  // Input for create and reply\n  subject: '',\n  input: '',\n  recipients: [],\n  // Attachments\n  attachments: [],\n  // Snackbar\n  snackMessage: '',\n  onSnackActionClick: undefined,\n  onSnackRequestClose: undefined,\n  snackType: NEUTRAL\n};\n\nfunction messageReducer(state = initialState, action) {\n  const stateMessageTypes = state.messageTypes;\n  const oldAttachments = state.attachments;\n\n  switch (action.type) {\n    case actions.SET_CURRENT_USER:\n      return { ...state,\n        currentUser: {\n          loading: true,\n          error: null,\n          id: null,\n          authorities: null,\n          userGroups: null\n        }\n      };\n\n    case actions.SET_CURRENT_USER_SUCCESS:\n      return { ...state,\n        currentUser: {\n          loading: false,\n          error: null,\n          id: action.payload.id,\n          authorities: action.payload.authorities,\n          userGroups: action.payload.userGroups\n        }\n      };\n\n    case actions.SET_CURRENT_USER_ERROR:\n      return { ...state,\n        currentUser: {\n          loading: false,\n          error: action.payload,\n          id: null,\n          authorities: null,\n          userGroups: null\n        }\n      };\n\n    case actions.SET_DISPLAY_TIME_DIFF_SUCCESS:\n      return { ...state,\n        displayTimeDiff: action.payload\n      };\n\n    case actions.MESSAGE_CONVERSATIONS_LOAD_SUCCESS:\n      {\n        const replaceMessageType = stateMessageTypes.find(type => type.id === action.payload.messageType.id);\n        replaceMessageType.loaded = action.payload.messageConversations.length;\n        replaceMessageType.total = action.payload.pager.total;\n        replaceMessageType.unread = action.payload.nrOfUnread;\n        replaceMessageType.page = action.payload.pager.page;\n        replaceMessageType.loading = false;\n        messageTypes.splice([findIndexOfId(stateMessageTypes, replaceMessageType.id)], 1, replaceMessageType);\n        const setSelectedMessageType = action.payload.selectedMessageType === replaceMessageType.id && (action.payload.selectedMessageType === state.selectedMessageType || state.selectedMessageType === undefined);\n        return { ...state,\n          messageTypes,\n          messageConversations: { ...state.messageConversations,\n            [replaceMessageType.id]: action.payload.messageConversations\n          },\n          selectedMessageType: setSelectedMessageType ? replaceMessageType : state.selectedMessageType\n        };\n      }\n\n    case actions.MESSAGE_CONVERSATION_UPDATE_ERROR:\n      return { ...state,\n        snackMessage: action.payload.error.message,\n        snackType: NEGATIVE\n      };\n\n    case actions.MESSAGE_CONVERSATION_UPDATE_SUCCESS:\n      {\n        let snackMessage = '';\n\n        switch (action.payload.identifier) {\n          case 'STATUS':\n            snackMessage = i18n.t('Successfully updated status');\n            break;\n\n          case 'PRIORITY':\n            snackMessage = i18n.t('Successfully updated priority');\n            break;\n\n          case 'ASSIGNEE':\n            snackMessage = i18n.t('Successfully updated assignee');\n            break;\n\n          case 'FOLLOW_UP':\n            snackMessage = i18n.t('Successfully changed followup');\n            break;\n\n          default:\n            log.error('Unexpected identifier for updateMessageConversations success');\n            break;\n        }\n\n        return { ...state,\n          snackMessage,\n          snackType: POSITIVE\n        };\n      }\n\n    case actions.SEND_MESSAGE_ERROR:\n      return { ...state,\n        snackMessage: action.payload.error.message,\n        snackType: NEGATIVE\n      };\n\n    case actions.MESSAGE_CONVERSATIONS_DELETE_ERROR:\n      return { ...state,\n        snackMessage: action.payload.error.message,\n        snackType: NEGATIVE\n      };\n\n    case actions.MESSAGE_CONVERSATIONS_DELETE_SUCCESS:\n      return { ...state,\n        snackMessage: i18n.t('Successfully deleted message conversation(s)'),\n        snackType: POSITIVE\n      };\n\n    case actions.DISPLAY_SNACK_MESSAGE:\n      return { ...state,\n        snackMessage: action.payload.message,\n        snackType: action.payload.snackType,\n        onSnackActionClick: action.payload.onSnackActionClick,\n        onSnackRequestClose: action.payload.onSnackRequestClose\n      };\n\n    case actions.CLEAR_SNACK_MESSAGE:\n      return { ...state,\n        snackMessage: '',\n        snackType: NEUTRAL\n      };\n\n    case actions.SET_CHECKED:\n      {\n        const messageConversation = action.payload.messageConversation;\n        let checkedIds = state.checkedIds;\n\n        if (action.payload.selectedValue) {\n          checkedIds.push(messageConversation);\n        } else {\n          checkedIds = checkedIds.filter(element => element.id !== messageConversation.id);\n        }\n\n        return { ...state,\n          checkedIds\n        };\n      }\n\n    case actions.SET_ALL_CHECKED:\n      return { ...state,\n        checkedIds: action.payload.messageConversationIds\n      };\n\n    case actions.CLEAR_CHECKED:\n      return { ...state,\n        checkedIds: []\n      };\n\n    case actions.SET_SELECTED_MESSAGE_CONVERSATION_SUCCESS:\n      return { ...state,\n        selectedMessageConversation: action.payload.messageConversation,\n        settingSelectedMessageConversation: false\n      };\n\n    case actions.SET_SELECTED_MESSAGE_CONVERSATION:\n      return { ...state,\n        settingSelectedMessageConversation: true\n      };\n\n    case actions.CLEAR_SELECTED_MESSAGE_CONVERSATION:\n      return { ...state,\n        selectedMessageConversation: undefined\n      };\n\n    case actions.SET_SELECTED_MESSAGE_TYPE:\n      return { ...state,\n        checkedIds: [],\n        selectedMessageType: stateMessageTypes.find(type => type.id === action.payload.messageTypeId),\n        selectedMessageConversations: state.messageConversations[action.payload.messageTypeId],\n        selectedMessageConversation: undefined\n      };\n\n    case actions.UPDATE_INPUT_FIELDS:\n      return { ...state,\n        subject: action.payload.subject,\n        input: action.payload.input,\n        recipients: action.payload.recipients\n      };\n\n    case actions.ADD_RECIPIENT_BY_ID_SUCCESS:\n      return { ...state,\n        recipients: [...state.recipients, action.payload]\n      };\n\n    case actions.SET_FILTER:\n      return { ...state,\n        messageFilter: action.payload.filterType === 'MESSAGE' ? action.payload.filter : state.messageFilter,\n        statusFilter: action.payload.filterType === 'STATUS' ? action.payload.filter : state.statusFilter,\n        priorityFilter: action.payload.filterType === 'PRIORITY' ? action.payload.filter : state.priorityFilter,\n        assignedToMeFilter: action.payload.filterType === 'ASSIGNED_TO_ME' ? action.payload.filter : state.assignedToMeFilter,\n        markedForFollowUpFilter: action.payload.filterType === 'MARKED_FOR_FOLLOWUP' ? action.payload.filter : state.markedForFollowUpFilter,\n        unreadFilter: action.payload.filterType === 'UNREAD' ? action.payload.filter : state.unreadFilter\n      };\n\n    case actions.LOAD_MESSAGE_CONVERSATIONS:\n      {\n        const loadingMessageType = action.payload.messageType;\n        loadingMessageType.loading = true;\n\n        if (action.payload.loadMore) {\n          loadingMessageType.page++;\n        }\n\n        messageTypes[findIndexOfId(messageTypes, loadingMessageType.id)] = loadingMessageType; // TODO: This can probably be removed because action.payload.messageType === state.selectedMessageType\n\n        const selectedMessageType = state.selectedMessageType;\n\n        if (selectedMessageType) {\n          selectedMessageType.loading = true;\n\n          if (action.payload.loadMore) {\n            selectedMessageType.page++;\n          }\n        }\n\n        return { ...state,\n          messageTypes,\n          selectedMessageType\n        };\n      }\n\n    case actions.SET_IN_FEEDBACK_RECIPIENT_GROUP:\n      return { ...state,\n        isInFeedbackRecipientGroup: action.payload.isInFeedbackRecipientGroup.authorized,\n        feedbackRecipientsId: action.payload.isInFeedbackRecipientGroup.feedbackRecipientsId\n      };\n\n    case actions.ADD_ATTACHMENT_SUCCESS:\n      return { ...state,\n        attachments: state.attachments.map(attachment => attachment.name === action.payload.name ? {\n          id: action.payload.id,\n          name: attachment.name,\n          contentLength: attachment.contentLength,\n          loading: false\n        } : attachment)\n      };\n\n    case actions.ADD_ATTACHMENT_ERROR:\n      return { ...state,\n        attachments: oldAttachments.filter(attachment => attachment.id !== action.payload.attachmentId),\n        snackMessage: action.payload.error.message,\n        snackType: NEGATIVE\n      };\n\n    case actions.ADD_ATTACHMENT:\n      return { ...state,\n        attachments: state.attachments.concat({\n          name: action.payload.name,\n          contentLength: action.payload.size,\n          loading: true\n        })\n      };\n\n    case actions.REMOVE_ATTACHMENT:\n      return { ...state,\n        attachments: oldAttachments.filter(attachment => attachment.id !== action.payload.attachmentId)\n      };\n\n    case actions.CANCEL_ATTACHMENT:\n      return { ...state,\n        attachments: oldAttachments.filter(attachment => attachment.name !== action.payload.attachmentName)\n      };\n\n    case actions.CLEAR_ATTACHMENTS:\n      return { ...state,\n        attachments: []\n      };\n\n    case actions.SET_DHIS2_CORE_VERSION:\n      return { ...state,\n        dhis2CoreVersion: action.payload\n      };\n\n    default:\n      return state;\n  }\n}\n\nexport default messageReducer;","import { createStore, applyMiddleware, combineReducers, compose } from 'redux';\nimport ReduxThunk from 'redux-thunk';\nimport messageReducer from './reducers/messageReducer.js';\nconst middlewares = [ReduxThunk];\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\nconst reducer = combineReducers({\n  messaging: messageReducer\n});\nexport default createStore(reducer, composeEnhancers(applyMiddleware(...middlewares)));","import React from 'react';\nimport { Provider } from 'react-redux';\nimport MuiThemeProvider from 'material-ui/styles/MuiThemeProvider';\nimport { useDataEngine } from '@dhis2/app-runtime';\nimport theme from '../../styles/theme.js';\nimport App from './App.js';\nimport store from '../../store.js';\nimport { setEngine } from '../../api/api.js';\nimport '../../index.css';\nimport 'typeface-roboto';\n\nconst AppWrapper = () => {\n  const engine = useDataEngine();\n  setEngine(engine);\n  return <Provider store={store}>\n            <MuiThemeProvider muiTheme={theme}>\n                <App />\n            </MuiThemeProvider>\n        </Provider>;\n};\n\nexport default AppWrapper;"],"sourceRoot":""}