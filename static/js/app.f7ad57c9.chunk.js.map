{"version":3,"sources":["D2App/components/App/App.module.css","D2App/constants/development.js","D2App/utils/helpers.js","D2App/utils/createRecipientSearchQuery.js","D2App/api/api.js","D2App/actions/index.js","D2App/constants/actions.js","D2App/styles/theme.js","D2App/components/Common/CustomSnackBar.jsx","D2App/utils/history.js","D2App/components/Attachments/Attachments.jsx","D2App/components/MessageConversation/Message.jsx","D2App/components/Attachments/AttachmentUploadButton.jsx","D2App/components/MessageConversation/ReplyCard.jsx","D2App/components/Common/SuggestionField.jsx","D2App/components/Common/ExtendedChoiceLabel.jsx","D2App/styles/messageConversationStyles.js","D2App/components/MessageConversation/MessageConversation.jsx","D2App/components/List/MessageTypeItem.jsx","D2App/components/List/SidebarList.jsx","D2App/styles/style.js","D2App/components/List/ListItemHeader.jsx","D2App/components/List/MessageConversationListItem.jsx","D2App/components/List/MessageConversationList.jsx","D2App/components/MessageConversation/CreateMessage.jsx","D2App/constants/extendedChoices.js","D2App/components/Common/DialogWithReduxState.js","D2App/components/Common/AssignToDialog.jsx","D2App/components/Common/ToolbarExtendedChoicePicker.jsx","D2App/components/Common/Toolbar.jsx","D2App/components/MessagingCenter/MessagingCenter.jsx","D2App/components/App/Routes.jsx","D2App/components/App/App.jsx","D2App/constants/messageTypes.js","D2App/reducers/messageReducer.js","D2App/store.js","D2App/components/App/AddD2Context.jsx","D2App/components/App/AppWrapper.jsx"],"names":["module","exports","fontFamily","findIndexOfId","list","id","len","length","index","debounce","fn","delay","timer","context","this","args","arguments","clearTimeout","setTimeout","apply","supportsAttachments","dhis2CoreVersion","createOrganisationUnitQuery","searchValue","resource","params","fields","pageSize","filter","createUserGroupQuery","initialMessageConversationFields","messageConversationFields","engine","getMessageConversations","async","messageType","page","messageFilter","status","priority","assignedToMeFilter","markedForFollowUpFilter","unreadFilter","currentUser","push","query","order","queryString","messageConversations","updateMessageConversationAssignee","messageConversationId","value","mutation","type","userId","mutate","searchRecipients","searchOnlyUsers","searchOnlyFeedbackRecipients","feedbackRecipientsId","userQuery","supportsUserLookupEndPoint","resouce","createUserQuery","users","organisationUnits","userGroups","createRecipientSearchQuery","results","addRecipients","data","createAction","payload","setSelectedMessageConversation","messageConversation","dispatch","result","api","error","loadMessageConversations","selectedMessageType","loadMore","getState","promises","state","statusFilter","priorityFilter","messaging","i","promise","then","pager","Promise","all","nrOfUnread","total","reduce","accumulated","r","concat","markMessageConversations","mode","markedConversations","markedReadConversations","markedUnreadConversations","addAttachment","attachment","domain","file","response","fileResource","name","contentLength","clearCheckedIds","clearSelectedMessageConversation","displaySnackMessage","message","onSnackActionClick","onSnackRequestClose","snackType","setFilter","filterType","updateInputFields","subject","input","recipients","clearAttachments","setSelectedMessageType","messageTypeId","removeAttachment","attachmentId","cancelAttachment","attachmentName","getMuiTheme","palette","negative","pinkA200","blue50","primary1Color","primary2Color","blue100","primary3Color","blue300","primary4Color","blue500","accent1Color","grey50","accent2Color","grey100","accent3Color","grey300","accent4Color","grey500","followUp","orange500","darkGray","grey700","superDarkGray","grey900","textColor","darkBlack","alternateTextColor","white","canvasColor","borderColor","clockCircleColor","fade","shadowColor","fullBlack","contentColorStyle","NEGATIVE","theme","NEUTRAL","POSITIVE","CustomSnackBar","Component","constructor","props","super","closeMessage","clearSnackMessage","setState","show","componentDidUpdate","_prevProps","prevState","render","open","autoHideDuration","onRequestClose","action","onActionClick","contentStyle","color","style","pointerEvents","whiteSpace","bodyStyle","maxWidth","compose","connect","snackMessage","pure","createHashHistory","Attachment","dataDirection","downloadAttachment","className","backgroundColor","label","parseFloat","parseInt","toFixed","labelPosition","onClick","loading","icon","Attachments","attachments","map","key","styles","canvas","padding","innerCanvas","margin","paddingBottom","cardText","wordBreak","fromFormat","datePlacement","display","justifyContent","marginRight","dateFormat","overflow","textOverflow","Message","displayTimeDiff","lastMessage","enableAttachments","fromTitle","sender","displayName","today","moment","messageDate","created","add","internal","i18n","t","placement","diff","from","format","year","paddingLeft","text","createHandleChange","event","files","target","AttachmentUploadButton","containerElement","onChange","ReplyCard","replyMessage","internalReply","selectedMessageConversation","wipeInput","inputError","texFieldUpdate","newValue","handleDiscard","discardState","expanded","componentWillUnmount","Card","marginTop","rows","underlineShow","multiLine","fullWidth","floatingLabelText","primary","disabled","isInFeedbackRecipientGroup","messageTypes","SuggestionField","searchResult","lastSearch","errorText","undefined","debouncedSearch","search","bind","onSuggestionClick","chip","find","recipient","updateRecipients","onRemoveChip","updateInput","addType","internalSearchResult","searchWarning","height","inputHeight","marginBottom","openOnFocus","searchText","dataSource","dataSourceConfig","onUpdateInput","onRequestAdd","onRequestDelete","subheaderTitle","paddingRight","subheader","fontWeight","ExtendedChoiceLabel","showTitle","title","displayLabel","charAt","toLowerCase","substr","flex","overflowY","overflowX","paddingTop","flexDirection","header","iconButton","alignSelf","subjectSubheader","fontSize","participantsCanvas","participants","flexWrap","participantAddRow","participantsSuggestionField","participantsAdd","messagesCanvas","messagesInnerCanvas","NOTIFICATIONS","MessageConversation","backToList","history","cursor","messages","notification","indexOf","userMessages","slice","userMessage","recipientsExpanded","user","userMessagesLength","tooltipPosition","tooltip","displayExtendedChoices","assignee","participant","limitSearchArray","messageId","filePath","link","baseUrl","apiPath","join","document","createElement","href","download","split","pop","body","appendChild","click","removeChild","MessageTypeItem","onMouseEnter","setHoverText","onMouseLeave","setNeutralText","setTextColor","getBackgroundColor","selectedValue","role","alignItems","marginLeft","size","unread","badgeContent","secondary","badgeStyle","borderLeftStyle","borderLeftWidth","borderLeftColor","borderRightStyle","borderRightWidth","borderRightColor","minWidth","SidebarList","match","List","width","refreshTimer","toggled","autoRefresh","onToggle","setAutoRefresh","messagePanelContainer","transition","boxSizing","position","boxShadow","borderBottom","checkBox","extendedLabel","MessageConversationListItem","allChecked","checkedIds","checked","onCheck","setAllChecked","child","messageConversationIds","container","wideview","flag","fontColor","flexBasis","textAlign","read","lastSender","x","containerBackgroundColor","innerText","settingSelectedMessageConversation","setChecked","MessageConversationList","onScroll","messageList","getElementById","isBottom","loaded","debouncedOnScroll","el","scrollHeight","scrollTop","window","outerHeight","Array","isArray","lookup","Set","item","has","dedupeById","ListItemHeader","messageTypeField","CreateMessage","subjectUpdate","inputUpdate","sendMessage","isMessageFeedback","sendFeedbackMessage","componentDidMount","addRecipientByUserId","recipientId","discardDisabled","console","extendedChoices","STATUS","primaryText","PRIORITY","DialogWithReduxState","Consumer","ctx","store","children","AssignToDialog","updateMessageConversations","nrSelected","ToolbarExtendedChoicePicker","getIds","updateMessageConversation","identifier","ids","toggleDialog","dialogOpen","checkedItems","assignToOpen","multiSelect","actionButtons","keyboardFocused","deleteMessageConversations","displayNumberOfCheckedIds","actions","modal","iconButtonElement","anchorOrigin","horizontal","vertical","targetOrigin","rightIcon","menuItems","elem","currentUserId","messageConversationStatus","messageConversationPriority","log","checkedOptions","zIndex","checkedOption","filterControl","rightHandCanvas","ie11Spacer","flexGrow","iconMenu","Toolbar","lastMessageFilter","prevProps","displaySearch","labelStyle","top","selectedMenuItemStyle","floatingLabelStyle","iconStyle","hintText","menuStyle","toogleWideview","EXTENDED_CHOICES","MessagingCenter","intervalId","clearInterval","setInterval","tick","refresh","selectedId","setDhis2CoreVersion","d2","system","version","minor","initialMessageConversation","configuration","feedbackRecipients","authorized","authorities","includes","some","setIsInFeedbackRecipientGroup","setDisplayTimeDiff","drawerOpen","disableLink","contextTypes","propTypes","object","serverDate","systemInfo","Routes","exact","path","component","to","setCurrentUser","useEffect","classes","center","cx","initialState","messageReducer","stateMessageTypes","oldAttachments","replaceMessageType","splice","element","selectedMessageConversations","loadingMessageType","middlewares","ReduxThunk","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","reducer","combineReducers","createStore","applyMiddleware","AddD2Context","React","getChildContext","muiTheme","childContextTypes","AppWrapper","useConfig","useDataEngine","useD2","d2Config","schemas"],"mappings":"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","file":"static/js/app.f7ad57c9.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"center\":\"App_center__1snml\",\"error\":\"App_error__1usCm\"};","export const pageSize = 35;\nexport const fontFamily = 'Roboto, Helvetica, Arial, sans-serif';\nexport const NEUTRAL = 'NEUTRAL';\nexport const POSITIVE = 'POSITIVE';\nexport const NEGATIVE = 'NEGATIVE';","export function dedupeById(list) {\n  if (!Array.isArray(list)) {\n    return undefined;\n  }\n\n  const lookup = new Set();\n  return list.filter(item => {\n    if (lookup.has(item.id)) {\n      return false;\n    }\n\n    lookup.add(item.id);\n    return true;\n  });\n}\nexport function findIndexOfId(list, id) {\n  const len = list.length;\n\n  for (let index = 0; index < len; index++) {\n    if (list[index].id === id) {\n      return index;\n    }\n  }\n\n  return undefined;\n}\nexport function debounce(fn, delay) {\n  let timer = null;\n  return function () {\n    const context = this;\n    const args = arguments;\n    clearTimeout(timer);\n    timer = setTimeout(function () {\n      fn.apply(context, args);\n    }, delay);\n  };\n}\nexport function supportsAttachments(dhis2CoreVersion) {\n  return dhis2CoreVersion > 30;\n}\nexport function supportsUserLookupEndPoint(dhis2CoreVersion) {\n  return dhis2CoreVersion > 34;\n}","import { supportsUserLookupEndPoint } from './helpers.js';\nconst MAX_RECIPIENT = 10;\n\nfunction createUserQuery({\n  searchValue,\n  searchOnlyFeedbackRecipients,\n  feedbackRecipientsId,\n  dhis2CoreVersion\n}) {\n  if (supportsUserLookupEndPoint(dhis2CoreVersion)) {\n    // version >= v2.35\n    return {\n      resource: searchOnlyFeedbackRecipients ? 'userLookup/feedbackRecipients' : 'userLookup',\n      params: {\n        query: searchValue\n      }\n    };\n  } else {\n    // version < 2.35\n    const filter = [`displayName:token:${searchValue}`];\n\n    if (searchOnlyFeedbackRecipients) {\n      filter.push(`userGroups.id:eq:${feedbackRecipientsId}`);\n    }\n\n    return {\n      resouce: 'users',\n      params: {\n        filter,\n        pageSize: MAX_RECIPIENT\n      }\n    };\n  }\n}\n\nfunction createOrganisationUnitQuery(searchValue) {\n  return {\n    resource: 'organisationUnits',\n    params: {\n      fields: ['id', 'displayName'],\n      pageSize: MAX_RECIPIENT,\n      filter: [`displayName:token:${searchValue}`, 'users:gte:1']\n    }\n  };\n}\n\nfunction createUserGroupQuery(searchValue) {\n  return {\n    resource: 'userGroups',\n    params: {\n      fields: 'id, displayName',\n      pageSize: MAX_RECIPIENT,\n      filter: [`displayName:token:${searchValue}`]\n    }\n  };\n}\n\nexport default function createRecipientSearchQuery({\n  searchValue,\n  searchOnlyUsers,\n  searchOnlyFeedbackRecipients,\n  feedbackRecipientsId,\n  dhis2CoreVersion\n}) {\n  const userQuery = createUserQuery({\n    searchValue,\n    searchOnlyFeedbackRecipients,\n    feedbackRecipientsId,\n    dhis2CoreVersion\n  });\n  return searchOnlyUsers ? {\n    users: userQuery\n  } : {\n    users: userQuery,\n    organisationUnits: createOrganisationUnitQuery(searchValue),\n    userGroups: createUserGroupQuery(searchValue)\n  };\n}","import { getInstance as getD2Instance } from 'd2';\nimport { pageSize } from '../constants/development';\nimport createRecipientSearchQuery from '../utils/createRecipientSearchQuery';\nconst initialMessageConversationFields = ['id', 'displayName', 'subject', 'messageType', 'lastSender[id, displayName]', 'assignee[id, displayName]', 'status', 'priority', 'lastUpdated', 'read', 'lastMessage', 'followUp'];\nconst messageConversationFields = ['*', 'assignee[id, displayName]', 'messages[*,sender[id,displayName]', 'attachments[id, name, contentLength]]', 'userMessages[user[id, displayName]]'];\nconst order = 'lastMessage:desc'; // The rest of the code in this module will expect that\n// engine has been set and can use it safely\n\nlet engine = null;\nexport const setEngine = engineInstance => {\n  engine = engineInstance;\n};\nexport const getCurrentUser = () => {\n  return engine.query({\n    currentUser: {\n      resource: 'me',\n      params: {\n        fields: ['id', 'authorities', 'userGroups[id]']\n      }\n    }\n  });\n};\nexport const getMessageConversations = async ({\n  messageType,\n  page,\n  messageFilter,\n  status,\n  priority,\n  assignedToMeFilter,\n  markedForFollowUpFilter,\n  unreadFilter,\n  currentUser\n}) => {\n  const filter = [`messageType:eq:${messageType}`];\n\n  if (status) {\n    filter.push(`status:eq:${status}`);\n  }\n\n  if (priority) {\n    filter.push(`priority:eq:${priority}`);\n  }\n\n  if (markedForFollowUpFilter) {\n    filter.push('followUp:eq:true');\n  }\n\n  if (unreadFilter) {\n    filter.push('read:eq:false');\n  }\n\n  if (assignedToMeFilter) {\n    filter.push(`assignee.id:eq:${currentUser.id}`);\n  }\n\n  const query = {\n    resource: 'messageConversations',\n    params: {\n      filter,\n      pageSize,\n      page,\n      fields: initialMessageConversationFields,\n      order\n    }\n  };\n\n  if (messageFilter) {\n    query.params.queryString = messageFilter;\n  }\n\n  const {\n    messageConversations\n  } = await engine.query({\n    messageConversations: query\n  });\n  return messageConversations;\n};\nexport const getMessageConversation = async ({\n  id\n}) => {\n  const {\n    messageConversation\n  } = await engine.query({\n    messageConversation: {\n      resource: 'messageConversations',\n      id,\n      params: {\n        fields: messageConversationFields\n      }\n    }\n  });\n  return messageConversation;\n};\nexport const getServerDate = async () => {\n  const {\n    systemInfo\n  } = await engine.query({\n    systemInfo: {\n      resource: 'system/info'\n    }\n  });\n  return systemInfo.serverDate;\n};\nexport const updateMessageConversationStatus = async (messageConversationId, value) => {\n  return await engine.mutate({\n    resource: `messageConversations/${messageConversationId}/status`,\n    type: 'create',\n    params: {\n      messageConversationStatus: value\n    }\n  });\n};\nexport const updateMessageConversationPriority = async (messageConversationId, value) => await engine.mutate({\n  resource: `messageConversations/${messageConversationId}/priority`,\n  type: 'create',\n  params: {\n    messageConversationPriority: value\n  }\n});\nexport const updateMessageConversationAssignee = async (messageConversationId, value) => {\n  const mutation = value ? {\n    resource: `messageConversations/${messageConversationId}/assign`,\n    type: 'create',\n    params: {\n      userId: value\n    }\n  } : {\n    resource: `messageConversations`,\n    id: `${messageConversationId}/assign`,\n    type: 'delete'\n  };\n  return await engine.mutate(mutation);\n};\nexport const updateMessageConversationFollowup = async (messageConversationIds, value) => {\n  return await engine.mutate({\n    resource: `messageConversations/${value ? 'followup' : 'unfollowup'}`,\n    type: 'create',\n    data: messageConversationIds\n  });\n};\nexport const getNrOfUnread = async messageType => {\n  const {\n    messageConversations\n  } = await engine.query({\n    messageConversations: {\n      resource: 'messageConversations',\n      params: {\n        fields: ['read'],\n        filter: ['read:eq:false', `messageType:eq:${messageType}`],\n        pageSize: 1\n      }\n    }\n  });\n  return messageConversations.pager.total;\n};\nexport const sendMessage = async ({\n  subject,\n  users,\n  userGroups,\n  organisationUnits,\n  text,\n  attachments\n}) => await engine.mutate({\n  resource: 'messageConversations',\n  type: 'create',\n  data: {\n    subject,\n    users,\n    userGroups,\n    organisationUnits,\n    text,\n    attachments\n  }\n});\nexport const sendFeedbackMessage = async (subject, text) => await engine.mutate({\n  resource: 'messageConversations/feedback',\n  type: 'create',\n  params: {\n    subject\n  },\n  data: text\n});\nexport const replyMessage = async ({\n  message,\n  internalReply,\n  attachments,\n  id\n}) => {\n  const params = {\n    internal: internalReply\n  };\n\n  if (attachments.length > 0) {\n    params.attachments = attachments;\n  }\n\n  return await engine.mutate({\n    resource: `messageConversations/${id}`,\n    type: 'create',\n    params,\n    data: message\n  });\n};\nexport const deleteMessageConversation = async (messageConversationId, currentUserId) => await engine.mutate({\n  resource: `messageConversations/${messageConversationId}/${currentUserId}`,\n  type: 'delete'\n});\nexport const markRead = async (markedReadConversations) => await engine.mutate({\n  resource: 'messageConversations/read',\n  type: 'create',\n  data: markedReadConversations\n});\nexport const markUnread = async (markedUnreadConversations) => await engine.mutate({\n  resource: 'messageConversations/unread',\n  type: 'create',\n  data: markedUnreadConversations\n});\nexport const isInFeedbackRecipientGroup = async currentUser => {\n  const {\n    configuration: {\n      feedbackRecipients\n    }\n  } = await engine.query({\n    configuration: {\n      resource: 'configuration'\n    }\n  });\n  const authorized = currentUser.authorities.includes('ALL') || currentUser.userGroups.some(({\n    id\n  }) => id === feedbackRecipients.id);\n  const feedbackRecipientsId = feedbackRecipients.id;\n  return {\n    authorized,\n    feedbackRecipientsId\n  };\n};\nexport const searchRecipients = async ({\n  searchValue,\n  searchOnlyUsers,\n  searchOnlyFeedbackRecipients,\n  feedbackRecipientsId,\n  dhis2CoreVersion\n}) => {\n  const query = createRecipientSearchQuery({\n    searchValue,\n    searchOnlyUsers,\n    searchOnlyFeedbackRecipients,\n    feedbackRecipientsId,\n    dhis2CoreVersion\n  });\n  const results = await engine.query(query);\n  return {\n    users: results.users.users,\n    organisationUnits: results.organisationUnits && results.organisationUnits.organisationUnits,\n    userGroups: results.userGroups && results.userGroups.userGroups\n  };\n};\nexport const fetchParticipants = messageConversationId => getD2Instance().then(instance => instance.Api.getApi().get(`messageConversations/${messageConversationId}`, {\n  fields: 'userMessages[user[id, displayName]]'\n})).then(result => result).catch(error => {\n  throw error;\n});\nexport const addRecipients = async ({\n  users,\n  userGroups,\n  organisationUnits,\n  messageConversationId\n}) => await engine.mutate({\n  resource: `messageConversations/${messageConversationId}/recipients`,\n  type: 'create',\n  data: {\n    users,\n    userGroups,\n    organisationUnits\n  }\n});\nexport const getUserById = async id => {\n  const {\n    user\n  } = await engine.query({\n    user: {\n      resource: 'users',\n      id,\n      params: {\n        fields: 'id,displayName'\n      }\n    }\n  });\n  return { ...user,\n    type: 'user'\n  };\n};\nexport const addAttachment = async (attachment) => await engine.mutate({\n  resource: 'fileResources',\n  type: 'create',\n  params: {\n    domain: 'MESSAGE_ATTACHMENT'\n  },\n  data: {\n    file: attachment\n  }\n});\nexport const downloadAttachment = (messageConversationId, messageId, attachmentId) => {\n  const filePath = [engine.link.baseUrl, engine.link.apiPath, 'messageConversations', messageConversationId, messageId, 'attachments', attachmentId].join('/');\n  const link = document.createElement('a');\n  link.href = filePath;\n  link.download = filePath.split('/').pop();\n  link.target = '_blank';\n  document.body.appendChild(link);\n  link.click();\n  document.body.removeChild(link);\n};","import * as actions from '../constants/actions';\nimport log from 'loglevel';\nimport * as api from '../api/api';\nimport moment from 'moment'; // Simple hack to solve negative time difference\n\nconst FUTURE_HACK = 5000;\n\nconst createAction = (type, payload) => ({\n  type,\n  payload\n});\n/******************\n * THUNKS SECTION *\n ******************/\n\n\nexport const setCurrentUser = () => async dispatch => {\n  dispatch(createAction(actions.SET_CURRENT_USER));\n\n  try {\n    const {\n      currentUser\n    } = await api.getCurrentUser();\n    dispatch(createAction(actions.SET_CURRENT_USER_SUCCESS, currentUser));\n  } catch {\n    dispatch(createAction(actions.SET_CURRENT_USER_ERROR, 'Could not load current user'));\n  }\n};\nexport const setDisplayTimeDiff = () => async dispatch => {\n  try {\n    const serverDate = await api.getServerDate();\n    const displayTimeDiff = moment().diff(moment(serverDate)) - FUTURE_HACK;\n    dispatch(createAction(actions.SET_DISPLAY_TIME_DIFF_SUCCESS, displayTimeDiff));\n  } catch (error) {\n    dispatch(createAction(actions.SET_DISPLAY_TIME_DIFF_ERROR, {\n      error\n    }));\n  }\n};\nexport const setSelectedMessageConversation = messageConversation => async dispatch => {\n  dispatch(createAction(actions.SET_SELECTED_MESSAGE_CONVERSATION));\n\n  try {\n    const result = await api.getMessageConversation(messageConversation);\n    dispatch(createAction(actions.SET_SELECTED_MESSAGE_CONVERSATION_SUCCESS, {\n      messageConversation: result\n    }));\n  } catch (error) {\n    dispatch(createAction(actions.SET_SELECTED_MESSAGE_CONVERSATION_ERROR, {\n      error\n    }));\n  }\n};\nexport const updateMessageConversations = ({\n  messageConversationIds,\n  identifier,\n  value,\n  messageType,\n  selectedMessageConversation\n}) => async dispatch => {\n  if (identifier === 'FOLLOW_UP') {\n    try {\n      await api.updateMessageConversationFollowup(messageConversationIds, value);\n      dispatch(createAction(actions.MESSAGE_CONVERSATION_UPDATE_SUCCESS, {\n        messageType: messageType,\n        page: 1,\n        identifier: identifier\n      }));\n      dispatch(loadMessageConversations());\n    } catch (error) {\n      dispatch(createAction(actions.MESSAGE_CONVERSATION_UPDATE_ERROR, {\n        error\n      }));\n    }\n  } else {\n    const promises = messageConversationIds.map(messageConversationId => {\n      let promise;\n\n      switch (identifier) {\n        case 'STATUS':\n          promise = api.updateMessageConversationStatus(messageConversationId, value);\n          break;\n\n        case 'PRIORITY':\n          promise = api.updateMessageConversationPriority(messageConversationId, value);\n          break;\n\n        case 'ASSIGNEE':\n          if (value !== undefined && messageType.id === 'VALIDATION_RESULT') {\n            promise = api.addRecipients({\n              users: value.map(value => ({\n                id: value\n              })),\n              userGroups: [],\n              organisationUnits: [],\n              messageConversationId\n            }).then(() => api.updateMessageConversationAssignee(messageConversationId, value));\n          } else {\n            promise = api.updateMessageConversationAssignee(messageConversationId, value);\n          }\n\n          break;\n\n        default:\n          log.error('Unexpected identifier for updateMessageConversations');\n          break;\n      }\n\n      return promise;\n    });\n\n    try {\n      await Promise.all(promises);\n      dispatch(createAction(actions.MESSAGE_CONVERSATION_UPDATE_SUCCESS, {\n        messageType: messageType,\n        page: 1,\n        identifier: identifier\n      }));\n      dispatch(loadMessageConversations());\n    } catch (error) {\n      dispatch(createAction(actions.MESSAGE_CONVERSATION_UPDATE_ERROR, {\n        error\n      }));\n    }\n  }\n\n  if (selectedMessageConversation) {\n    dispatch(setSelectedMessageConversation(selectedMessageConversation));\n  }\n};\nexport const loadMessageConversations = (messageType, selectedMessageType, loadMore = false) => async (dispatch, getState) => {\n  const promises = [];\n  const state = getState();\n  const {\n    messageFilter,\n    statusFilter: status,\n    priorityFilter: priority,\n    assignedToMeFilter,\n    markedForFollowUpFilter,\n    unreadFilter,\n    currentUser\n  } = state.messaging; // Default fallback values so this action can be called without arguments\n\n  messageType = messageType || state.messaging.selectedMessageType;\n  selectedMessageType = selectedMessageType || state.messaging.selectedMessageType.id;\n  dispatch(createAction(actions.LOAD_MESSAGE_CONVERSATIONS, {\n    messageType,\n    loadMore\n  }));\n\n  try {\n    for (let i = 1; i <= messageType.page; i++) {\n      const promise = api.getMessageConversations({\n        messageType: messageType.id,\n        page: i,\n        messageFilter,\n        status,\n        priority,\n        assignedToMeFilter,\n        markedForFollowUpFilter,\n        unreadFilter,\n        currentUser\n      }).then(result => ({\n        messageConversations: result.messageConversations,\n        pager: result.pager\n      }));\n      promises.push(promise);\n    }\n\n    const result = await Promise.all(promises);\n    const nrOfUnread = await api.getNrOfUnread(messageType.id);\n    const messageConversations = result.reduce((accumulated, r) => accumulated.concat(r.messageConversations), []);\n    dispatch(createAction(actions.MESSAGE_CONVERSATIONS_LOAD_SUCCESS, {\n      messageConversations,\n      pager: result[result.length - 1].pager,\n      messageType,\n      selectedMessageType,\n      nrOfUnread\n    }));\n  } catch (error) {\n    dispatch(createAction(actions.MESSAGE_CONVERSATIONS_LOAD_ERROR, {\n      error\n    }));\n  }\n};\nexport const deleteMessageConversations = (messageConversationIds, messageType) => async (dispatch, getState) => {\n  try {\n    const state = getState();\n    const {\n      currentUser\n    } = state.messaging;\n    const promises = messageConversationIds.map(messageConversationId => api.deleteMessageConversation(messageConversationId, currentUser.id));\n    await Promise.all(promises);\n    dispatch(createAction(actions.MESSAGE_CONVERSATIONS_DELETE_SUCCESS, {\n      messageType: messageType,\n      page: 1\n    }));\n    dispatch(loadMessageConversations());\n  } catch (error) {\n    dispatch(createAction(actions.MESSAGE_CONVERSATIONS_DELETE_ERROR, {\n      error\n    }));\n  }\n};\nexport const sendMessage = ({\n  users,\n  userGroups,\n  organisationUnits,\n  messageType\n}) => async (dispatch, getState) => {\n  try {\n    const {\n      messaging: {\n        subject,\n        input,\n        attachments\n      }\n    } = getState();\n    await api.sendMessage({\n      subject,\n      users,\n      userGroups,\n      organisationUnits,\n      text: input,\n      attachments\n    });\n    dispatch(createAction(actions.SEND_MESSAGE_SUCCESS, {\n      messageType,\n      page: 1\n    }));\n    dispatch(loadMessageConversations());\n  } catch (error) {\n    dispatch(createAction(actions.SEND_MESSAGE_ERROR, {\n      error\n    }));\n  }\n};\nexport const sendFeedbackMessage = messageType => async (dispatch, getState) => {\n  const state = getState();\n\n  try {\n    await api.sendFeedbackMessage(state.messaging.subject, state.messaging.input);\n    dispatch(createAction(actions.SEND_MESSAGE_SUCCESS, {\n      messageType: messageType,\n      page: 1\n    }));\n    dispatch(loadMessageConversations());\n  } catch (error) {\n    dispatch(createAction(actions.SEND_MESSAGE_ERROR, {\n      error\n    }));\n  }\n};\nexport const replyMessage = ({\n  message,\n  internalReply,\n  messageConversation,\n  messageType\n}) => async (dispatch, getState) => {\n  try {\n    const {\n      id\n    } = messageConversation;\n    const state = getState();\n    const attachments = state.messaging.attachments.map(attachment => attachment.id);\n    await api.replyMessage({\n      message,\n      internalReply,\n      attachments,\n      id\n    });\n    dispatch(createAction(actions.REPLY_MESSAGE_SUCCESS, {\n      messageConversation: messageConversation,\n      messageType: messageType,\n      page: 1\n    }));\n    dispatch(loadMessageConversations());\n    dispatch(setSelectedMessageConversation(messageConversation));\n  } catch (error) {\n    dispatch(createAction(actions.REPLY_MESSAGE_ERROR, {\n      error\n    }));\n  }\n};\nexport const markMessageConversations = (mode, markedConversations, messageType) => async dispatch => {\n  try {\n    await (mode === 'read' ? api.markRead(markedConversations) : api.markUnread(markedConversations));\n    dispatch(createAction(actions.MARK_MESSAGE_CONVERSATIONS_SUCCESS, {\n      messageType: messageType,\n      page: 1\n    }));\n    dispatch(loadMessageConversations());\n  } catch (error) {\n    dispatch(createAction(actions.MARK_MESSAGE_CONVERSATIONS_ERROR, {\n      error\n    }));\n  }\n};\nexport const addRecipients = ({\n  users,\n  userGroups,\n  organisationUnits,\n  messageConversation,\n  messageType\n}) => async dispatch => {\n  try {\n    const {\n      id: messageConversationId\n    } = messageConversation;\n    await api.addRecipients({\n      users,\n      userGroups,\n      organisationUnits,\n      messageConversationId\n    });\n    dispatch(createAction(actions.ADD_RECIPIENTS_SUCCESS, {\n      messageConversation: messageConversation,\n      messageType: messageType,\n      page: 1\n    }));\n    dispatch(setSelectedMessageConversation(messageConversation));\n  } catch (error) {\n    dispatch(createAction(actions.ADD_RECIPIENTS_ERROR, {\n      error\n    }));\n  }\n};\nexport const addRecipientByUserId = id => async dispatch => {\n  try {\n    const user = await api.getUserById(id);\n    dispatch(createAction(actions.ADD_RECIPIENT_BY_ID_SUCCESS, user));\n  } catch (error) {\n    console.error(error); // No action required, the field will just be empty\n  }\n};\nexport const addAttachment = attachment => async dispatch => {\n  dispatch(createAction(actions.ADD_ATTACHMENT, attachment));\n\n  try {\n    const result = await api.addAttachment(attachment);\n    dispatch(createAction(actions.ADD_ATTACHMENT_SUCCESS, {\n      id: result.response.fileResource.id,\n      name: attachment.name,\n      contentLength: result.response.fileResource.contentLength\n    }));\n  } catch (error) {\n    dispatch(createAction(actions.ADD_ATTACHMENT_ERROR, {\n      error\n    }));\n  }\n}; // This is calling a synchronous function in the api module \\_()_/\n\nexport const downloadAttachment = (messageConversationId, messageId, attachmentId) => dispatch => {\n  api.downloadAttachment(messageConversationId, messageId, attachmentId);\n  dispatch(createAction(actions.DOWNLOAD_ATTACHMENT_SUCCESS));\n};\n/************************\n * PLAIN ACTION SECTION *\n ************************/\n\nexport const clearSnackMessage = () => createAction(actions.CLEAR_SNACK_MESSAGE);\nexport const clearCheckedIds = () => createAction(actions.CLEAR_CHECKED);\nexport const clearSelectedMessageConversation = () => createAction(actions.CLEAR_SELECTED_MESSAGE_CONVERSATION);\nexport const displaySnackMessage = ({\n  message,\n  onSnackActionClick,\n  onSnackRequestClose,\n  snackType\n}) => createAction(actions.DISPLAY_SNACK_MESSAGE, {\n  message,\n  onSnackActionClick,\n  onSnackRequestClose,\n  snackType\n});\nexport const setAllChecked = messageConversationIds => createAction(actions.SET_ALL_CHECKED, {\n  messageConversationIds\n});\nexport const setChecked = (messageConversation, selectedValue) => createAction(actions.SET_CHECKED, {\n  messageConversation,\n  selectedValue\n});\nexport const setFilter = (filter, filterType) => createAction(actions.SET_FILTER, {\n  filter,\n  filterType\n});\nexport const updateInputFields = (subject, input, recipients) => createAction(actions.UPDATE_INPUT_FIELDS, {\n  subject,\n  input,\n  recipients\n});\nexport const clearAttachments = () => createAction(actions.CLEAR_ATTACHMENTS);\nexport const setSelectedMessageType = messageTypeId => createAction(actions.SET_SELECTED_MESSAGE_TYPE, {\n  messageTypeId\n});\nexport const removeAttachment = attachmentId => createAction(actions.REMOVE_ATTACHMENT, {\n  attachmentId\n});\nexport const cancelAttachment = attachmentName => createAction(actions.CANCEL_ATTACHMENT, {\n  attachmentName\n});\nexport const setIsInFeedbackRecipientGroup = isInFeedbackRecipientGroup => createAction(actions.SET_IN_FEEDBACK_RECIPIENT_GROUP, {\n  isInFeedbackRecipientGroup\n});\nexport const setDhis2CoreVersion = version => createAction(actions.SET_DHIS2_CORE_VERSION, version);","export const SET_CURRENT_USER = 'SET_CURRENT_USER';\nexport const SET_CURRENT_USER_SUCCESS = 'SET_CURRENT_USER_SUCCESS';\nexport const SET_CURRENT_USER_ERROR = 'SET_CURRENT_USER_ERROR';\nexport const LOAD_MESSAGE_CONVERSATIONS = 'LOAD_MESSAGE_CONVERSATIONS';\nexport const LOAD_MORE_MESSAGE_CONVERSATIONS = 'LOAD_MORE_MESSAGE_CONVERSATIONS';\nexport const MESSAGE_CONVERSATIONS_LOAD_SUCCESS = 'MESSAGE_CONVERSATIONS_LOAD_SUCCESS';\nexport const MESSAGE_CONVERSATIONS_LOAD_ERROR = 'MESSAGE_CONVERSATIONS_LOAD_ERROR';\nexport const DELETE_MESSAGE_CONVERSATIONS = 'DELETE_MESSAGE_CONVERSATIONS';\nexport const MESSAGE_CONVERSATIONS_DELETE_SUCCESS = 'MESSAGE_CONVERSATIONS_DELETE_SUCCESS';\nexport const MESSAGE_CONVERSATIONS_DELETE_ERROR = 'MESSAGE_CONVERSATIONS_DELETE_ERROR';\nexport const UPDATE_MESSAGE_CONVERSATIONS = 'UPDATE_MESSAGE_CONVERSATIONS';\nexport const MESSAGE_CONVERSATION_UPDATE_SUCCESS = 'MESSAGE_CONVERSATION_UPDATE_SUCCESS';\nexport const MESSAGE_CONVERSATION_UPDATE_ERROR = 'MESSAGE_CONVERSATION_UPDATE_ERROR';\nexport const MARK_MESSAGE_CONVERSATIONS = 'MARK_MESSAGE_CONVERSATIONS';\nexport const MARK_MESSAGE_CONVERSATIONS_SUCCESS = 'MARK_MESSAGE_CONVERSATIONS_SUCCESS';\nexport const MARK_MESSAGE_CONVERSATIONS_ERROR = 'MARK_MESSAGE_CONVERSATIONS_ERROR';\nexport const SEND_MESSAGE = 'SEND_MESSAGE';\nexport const SEND_MESSAGE_SUCCESS = 'SEND_MESSAGE_SUCCESS';\nexport const SEND_MESSAGE_ERROR = 'SEND_MESSAGE_ERROR';\nexport const SEND_FEEDBACK_MESSAGE = 'SEND_FEEDBACK_MESSAGE';\nexport const REPLY_MESSAGE = 'REPLY_MESSAGE';\nexport const REPLY_MESSAGE_SUCCESS = 'REPLY_MESSAGE_SUCCESS';\nexport const REPLY_MESSAGE_ERROR = 'REPLY_MESSAGE_ERROR';\nexport const SET_FILTER = 'SET_FILTER';\nexport const DISPLAY_SNACK_MESSAGE = 'DISPLAY_SNACK_MESSAGE;';\nexport const CLEAR_SNACK_MESSAGE = 'CLEAR_SNACK_MESSAGE';\nexport const SET_CHECKED = 'SET_CHECKED';\nexport const SET_ALL_CHECKED = 'SET_ALL_CHECKED';\nexport const CLEAR_CHECKED = 'CLEAR_CHECKED';\nexport const SET_SELECTED_MESSAGE_TYPE = 'SET_SELECTED_MESSAGE_TYPE';\nexport const CLEAR_SELECTED_MESSAGE_CONVERSATION = 'CLEAR_SELECTED_MESSAGE_CONVERSATION';\nexport const SET_SELECTED_MESSAGE_CONVERSATION = 'SET_SELECTED_MESSAGE_CONVERSATION';\nexport const SET_SELECTED_MESSAGE_CONVERSATION_SUCCESS = 'SET_SELECTED_MESSAGE_CONVERSATION_SUCCESS';\nexport const SET_SELECTED_MESSAGE_CONVERSATION_ERROR = 'SET_SELECTED_MESSAGE_CONVERSATION_ERROR';\nexport const UPDATE_INPUT_FIELDS = 'UPDATE_INPUT_FIELDS';\nexport const SET_IN_FEEDBACK_RECIPIENT_GROUP = 'SET_IN_FEEDBACK_RECIPIENT_GROUP';\nexport const SET_DISPLAY_TIME_DIFF = 'SET_DISPLAY_TIME_DIFF';\nexport const SET_DISPLAY_TIME_DIFF_SUCCESS = 'SET_DISPLAY_TIME_DIFF_SUCCESS';\nexport const SET_DISPLAY_TIME_DIFF_ERROR = 'SET_DISPLAY_TIME_DIFF_ERROR';\n/* Recipient actions */\n\nexport const RECIPIENT_SEARCH = 'RECIPIENT_SEARCH';\nexport const RECIPIENT_SEARCH_SUCCESS = 'RECIPIENT_SEARCH_SUCCESS';\nexport const RECIPIENT_SEARCH_ERROR = 'RECIPIENT_SEARCH_ERROR';\nexport const ADD_RECIPIENTS = 'ADD_RECIPIENTS';\nexport const ADD_RECIPIENTS_SUCCESS = 'ADD_RECIPIENTS_SUCCESS';\nexport const ADD_RECIPIENTS_ERROR = 'ADD_RECIPIENTS_ERROR';\nexport const ADD_RECIPIENT_BY_ID_SUCCESS = 'ADD_RECIPIENT_BY_ID_SUCCESS';\n/* Attachments */\n\nexport const ADD_ATTACHMENT = 'ADD_ATTACHMENT';\nexport const ADD_ATTACHMENT_SUCCESS = 'ADD_ATTACHMENT_SUCCESS';\nexport const ADD_ATTACHMENT_ERROR = 'ADD_ATTACHMENT_ERROR';\nexport const DOWNLOAD_ATTACHMENT = 'DOWNLOAD_ATTACHMENT';\nexport const DOWNLOAD_ATTACHMENT_SUCCESS = 'DOWNLOAD_ATTACHMENT_SUCCESS';\nexport const DOWNLOAD_ATTACHMENT_ERROR = 'DOWNLOAD_ATTACHMENT_ERROR';\nexport const REMOVE_ATTACHMENT = 'REMOVE_ATTACHMENT';\nexport const CLEAR_ATTACHMENTS = 'CLEAR_ATTACHMENTS';\nexport const CANCEL_ATTACHMENT = 'CANCEL_ATTACHMENT';\n/* DHIS2 CORE VERSION */\n\nexport const SET_DHIS2_CORE_VERSION = 'SET_DHIS2_CORE_VERSION';","import getMuiTheme from 'material-ui/styles/getMuiTheme';\nimport { fade } from 'material-ui/utils/colorManipulator';\nimport { blue50, blue100, blue300, blue500, pinkA200, grey50, grey100, grey300, grey500, grey700, grey900, orange500, white, darkBlack, fullBlack } from 'material-ui/styles/colors';\nexport default getMuiTheme({\n  palette: {\n    negative: pinkA200,\n    blue50,\n    primary1Color: '#1D8BF1',\n    primary2Color: blue100,\n    primary3Color: blue300,\n    primary4Color: blue500,\n    accent1Color: grey50,\n    accent2Color: grey100,\n    accent3Color: grey300,\n    accent4Color: grey500,\n    followUp: orange500,\n    darkGray: grey700,\n    superDarkGray: grey900,\n    textColor: darkBlack,\n    alternateTextColor: white,\n    canvasColor: white,\n    borderColor: grey300,\n    clockCircleColor: fade(darkBlack, 0.07),\n    shadowColor: fullBlack\n  }\n});","import React, { Component } from 'react'\nimport propTypes from '@dhis2/prop-types'\nimport { connect } from 'react-redux'\nimport Snackbar from 'material-ui/Snackbar'\nimport { clearSnackMessage } from '../../actions'\nimport { compose, pure } from 'recompose'\nimport theme from '../../styles/theme'\n\nconst DEFAULT_MESSAGE_DURATION = 4000\nconst contentColorStyle = {\n    NEGATIVE: theme.palette.negative,\n    NEUTRAL: theme.palette.primary1Color,\n    POSITIVE: theme.palette.alternateTextColor,\n}\n\nclass CustomSnackBar extends Component {\n    constructor(props) {\n        super(props)\n\n        this.state = {\n            show: false,\n        }\n    }\n\n    componentDidUpdate(_prevProps, prevState) {\n        if (!prevState.show && this.props.message) {\n            this.setState({\n                show: true,\n            })\n        }\n    }\n\n    closeMessage = () => {\n        this.props.clearSnackMessage()\n        this.setState({\n            show: false,\n        })\n        this.props.onSnackRequestClose && this.props.onSnackRequestClose()\n    }\n\n    render() {\n        return (\n            <Snackbar\n                open={this.props.message !== '' && this.state.show}\n                message={this.props.message || 'Missing snackbar message'}\n                autoHideDuration={DEFAULT_MESSAGE_DURATION}\n                onRequestClose={this.closeMessage}\n                action={this.props.onSnackActionClick && 'undo'}\n                onActionClick={() => {\n                    this.props.onSnackActionClick()\n                    this.setState({\n                        show: false,\n                    })\n                }}\n                contentStyle={{ color: contentColorStyle[this.props.type] }}\n                style={{ pointerEvents: 'none', whiteSpace: 'nowrap' }}\n                bodyStyle={{ pointerEvents: 'initial', maxWidth: 'none' }}\n            />\n        )\n    }\n}\n\nCustomSnackBar.propTypes = {\n    clearSnackMessage: propTypes.func,\n    message: propTypes.string,\n    type: propTypes.oneOf(['NEGATIVE', 'NEUTRAL', 'POSITIVE']),\n    onSnackActionClick: propTypes.func,\n    onSnackRequestClose: propTypes.func,\n}\n\nconst mapStateToProps = state => ({\n    message: state.messaging.snackMessage,\n    type: state.messaging.snackType,\n    onSnackActionClick: state.messaging.onSnackActionClick,\n    onSnackRequestClose: state.messaging.onSnackRequestClose,\n})\n\nexport default compose(\n    connect(mapStateToProps, {\n        clearSnackMessage,\n    }),\n    pure\n)(CustomSnackBar)\n","import { createHashHistory } from 'history';\nexport default createHashHistory();","import React from 'react'\nimport propTypes from '@dhis2/prop-types'\nimport FlatButton from 'material-ui/FlatButton'\nimport LinearProgress from 'material-ui/LinearProgress'\nimport Clear from 'material-ui-icons/Clear'\nimport Download from 'material-ui-icons/CloudDownload'\nimport theme from '../../styles/theme'\nimport './Attachments.css'\n\nconst Attachments = ({\n    dataDirection,\n    attachments,\n    style,\n    removeAttachment,\n    downloadAttachment,\n    cancelAttachment,\n}) => (\n    <div className=\"attachment\" style={{ ...style }}>\n        {attachments.map((attachment, index) => (\n            <Attachment\n                // combining name with index prevents errors when user uploads files with duplicate names\n                key={`${attachment.name}-${index}`}\n                dataDirection={dataDirection}\n                attachment={attachment}\n                removeAttachment={removeAttachment}\n                downloadAttachment={downloadAttachment}\n                cancelAttachment={cancelAttachment}\n            />\n        ))}\n    </div>\n)\n\nAttachments.propTypes = {\n    attachments: propTypes.array,\n    cancelAttachment: propTypes.func,\n    dataDirection: propTypes.string,\n    downloadAttachment: propTypes.func,\n    removeAttachment: propTypes.func,\n    style: propTypes.object,\n}\n\nconst Attachment = ({\n    dataDirection,\n    attachment,\n    removeAttachment,\n    downloadAttachment,\n    cancelAttachment,\n}) => {\n    return (\n        <FlatButton\n            className=\"attachment__button\"\n            backgroundColor={theme.palette.accent2Color}\n            label={`${attachment.name} (${parseFloat(\n                parseInt(attachment.contentLength, 10) / 1000000\n            ).toFixed(2)} MB)`}\n            labelPosition=\"after\"\n            onClick={() => {\n                dataDirection === 'download'\n                    ? downloadAttachment(attachment)\n                    : attachment.loading\n                    ? cancelAttachment(attachment.name)\n                    : removeAttachment(attachment)\n            }}\n            icon={dataDirection === 'download' ? <Download /> : <Clear />}\n        >\n            {attachment.loading && (\n                <LinearProgress\n                    className={'attachment__progress'}\n                    mode=\"indeterminate\"\n                />\n            )}\n        </FlatButton>\n    )\n}\n\nAttachment.propTypes = {\n    attachment: propTypes.object,\n    cancelAttachment: propTypes.func,\n    dataDirection: propTypes.string,\n    downloadAttachment: propTypes.func,\n    removeAttachment: propTypes.func,\n}\n\nexport default Attachments\n","import React from 'react'\nimport propTypes from '@dhis2/prop-types'\nimport Divider from 'material-ui/Divider'\nimport CardText from 'material-ui/Card/CardText'\nimport Attachments from '../Attachments/Attachments'\nimport i18n from '@dhis2/d2-i18n'\nimport Linkify from 'react-linkify'\nimport theme from '../../styles/theme'\nimport { fontFamily } from '../../constants/development'\nimport moment from 'moment'\n\nconst styles = {\n    canvas(backgroundColor) {\n        return {\n            backgroundColor,\n            padding: '16px 16px 16px 16px',\n        }\n    },\n    innerCanvas: {\n        margin: '',\n        paddingBottom: '0px',\n    },\n    cardText: {\n        padding: '16px 0px 16px 0px',\n        fontFamily,\n        whiteSpace: 'pre-wrap',\n        wordBreak: 'break-word',\n    },\n    fromFormat: {\n        fontFamily,\n    },\n    datePlacement: {\n        display: 'flex',\n        justifyContent: 'flex-end',\n        marginRight: '10px',\n    },\n    dateFormat: {\n        overflow: 'hidden',\n        textOverflow: 'ellipsis',\n        whiteSpace: 'nowrap',\n        fontFamily,\n    },\n}\n\nconst Message = ({\n    displayTimeDiff,\n    message,\n    currentUser,\n    lastMessage,\n    downloadAttachment,\n    cancelAttachment,\n    enableAttachments,\n}) => {\n    const fromTitle = message.sender\n        ? currentUser && currentUser.id === message.sender.id\n            ? 'me'\n            : message.sender.displayName\n        : 'system'\n    const today = moment()\n    const messageDate = moment(message.created).add(displayTimeDiff)\n\n    return (\n        <div style={styles.canvas(theme.palette.canvasColor)}>\n            <div style={styles.innerCanvas}>\n                <div style={styles.fromFormat}>\n                    {message.internal\n                        ? i18n.t(`Internal message from ${fromTitle}`)\n                        : i18n.t(`Message from ${fromTitle}`)}\n                </div>\n\n                <div placement={'bottom'} style={styles.datePlacement}>\n                    <div style={styles.dateFormat}>\n                        {today.diff(messageDate, 'hours') < 72\n                            ? `${messageDate.from(today)}, ${messageDate.format(\n                                  'HH:mm'\n                              )}`\n                            : today.year() === messageDate.year()\n                            ? messageDate.format('MMM DD, HH:mm')\n                            : messageDate.format('MMM DD, YYYY HH:mm')}\n                    </div>\n                </div>\n\n                {enableAttachments && (\n                    <Attachments\n                        dataDirection={'download'}\n                        style={{ paddingLeft: 0 }}\n                        attachments={message.attachments}\n                        downloadAttachment={downloadAttachment}\n                        cancelAttachment={cancelAttachment}\n                    />\n                )}\n\n                <CardText style={styles.cardText}>\n                    <Linkify>{message.text}</Linkify>\n                </CardText>\n            </div>\n            {!lastMessage && <Divider />}\n        </div>\n    )\n}\n\nMessage.propTypes = {\n    cancelAttachment: propTypes.func,\n    currentUser: propTypes.object,\n    displayTimeDiff: propTypes.number,\n    downloadAttachment: propTypes.func,\n    enableAttachments: propTypes.bool,\n    lastMessage: propTypes.bool,\n    message: propTypes.object,\n}\n\nexport default Message\n","import React from 'react'\nimport propTypes from '@dhis2/prop-types'\nimport FlatButton from 'material-ui/FlatButton'\nimport AttachFile from 'material-ui-icons/AttachFile'\nimport i18n from '@dhis2/d2-i18n'\nimport './AttachmentUploadButton.css'\n\nconst createHandleChange = addAttachment => event => {\n    const files = event.target.files\n    const hasFile = files.length > 0\n\n    if (hasFile) {\n        addAttachment(files[0])\n    }\n}\n\nconst AttachmentUploadButton = ({ addAttachment }) => (\n    <FlatButton\n        className=\"attachment__upload-button\"\n        label={i18n.t('Upload attachment')}\n        labelPosition=\"after\"\n        containerElement=\"label\"\n        icon={<AttachFile />}\n    >\n        <input\n            className=\"attachment__upload-button--input\"\n            type=\"file\"\n            onChange={createHandleChange(addAttachment)}\n        />\n    </FlatButton>\n)\n\nAttachmentUploadButton.propTypes = {\n    addAttachment: propTypes.func,\n}\n\nexport default AttachmentUploadButton\n","import React, { Component } from 'react'\nimport propTypes from '@dhis2/prop-types'\nimport { connect } from 'react-redux'\nimport { compose } from 'recompose'\nimport { Card, CardActions, CardText } from 'material-ui/Card'\nimport RaisedButton from 'material-ui/RaisedButton'\nimport FlatButton from 'material-ui/FlatButton'\nimport TextField from 'material-ui/TextField'\nimport AttachmentUploadButton from '../Attachments/AttachmentUploadButton'\nimport Attachments from '../Attachments/Attachments'\nimport { supportsAttachments } from '../../utils/helpers'\nimport i18n from '@dhis2/d2-i18n'\nimport {\n    replyMessage,\n    setSelectedMessageType,\n    updateInputFields,\n    displaySnackMessage,\n    addAttachment,\n    removeAttachment,\n    cancelAttachment,\n} from '../../actions'\nimport { NEGATIVE } from '../../constants/development'\n\nclass ReplyCard extends Component {\n    constructor(props) {\n        super(props)\n\n        this.state = {\n            discardState: false,\n        }\n    }\n\n    componentWillUnmount() {\n        this.wipeInput()\n    }\n\n    replyMessage = internalReply => {\n        const {\n            input: message,\n            selectedMessageConversation: messageConversation,\n            selectedMessageType: messageType,\n        } = this.props\n\n        this.props.replyMessage({\n            message,\n            internalReply,\n            messageConversation,\n            messageType,\n        })\n\n        this.wipeInput()\n    }\n\n    wipeInput = () => {\n        this.props.updateInputFields('', '', [])\n        this.props.attachments.length > 0 && this.props.clearAttachments()\n        this.setState({\n            inputError: false,\n        })\n    }\n\n    texFieldUpdate = (event, newValue) => {\n        this.props.updateInputFields('', newValue, [])\n    }\n\n    handleDiscard = () => {\n        const message = i18n.t('Reply discarded')\n        const snackType = NEGATIVE\n        const onSnackActionClick = () => this.setState({ discardState: false })\n        const onSnackRequestClose = () => {\n            this.setState({ discardState: false })\n            this.wipeInput()\n        }\n\n        this.setState({ discardState: true })\n        this.props.displaySnackMessage({\n            message,\n            onSnackActionClick,\n            onSnackRequestClose,\n            snackType,\n        })\n        this.setState({\n            expanded: false,\n        })\n    }\n\n    render() {\n        return (\n            <Card style={{ marginTop: '5px' }} expanded>\n                <CardText style={{ padding: '0px 0px 0px 16px' }}>\n                    <TextField\n                        key={this.props.messageConversation.id}\n                        id={this.props.messageConversation.id}\n                        rows={5}\n                        underlineShow={false}\n                        value={this.state.discardState ? '' : this.props.input}\n                        multiLine\n                        fullWidth\n                        floatingLabelText={i18n.t('Message')}\n                        onChange={this.texFieldUpdate}\n                    />\n                    {this.props.enableAttachments &&\n                        !this.state.discardState && (\n                            <Attachments\n                                dataDirection={'upload'}\n                                attachments={this.props.attachments}\n                                removeAttachment={attachment =>\n                                    this.props.removeAttachment(attachment.id)\n                                }\n                                cancelAttachment={this.props.cancelAttachment}\n                            />\n                        )}\n\n                    <CardActions style={{ paddingLeft: '0px' }}>\n                        <RaisedButton\n                            primary\n                            label={i18n.t('Reply')}\n                            disabled={\n                                this.props.input === '' ||\n                                this.state.discardState\n                            }\n                            onClick={() => this.replyMessage(false)}\n                        />\n                        {this.props.isInFeedbackRecipientGroup &&\n                            this.props.selectedMessageType.id === 'TICKET' && (\n                                <FlatButton\n                                    primary\n                                    label={i18n.t('Internal reply')}\n                                    disabled={\n                                        this.props.input === '' ||\n                                        this.state.discardState\n                                    }\n                                    onClick={() => this.replyMessage(true)}\n                                />\n                            )}\n                        <FlatButton\n                            label={i18n.t('Discard')}\n                            disabled={\n                                this.props.input === '' ||\n                                this.state.discardState\n                            }\n                            onClick={this.handleDiscard}\n                        />\n                        {this.props.enableAttachments && (\n                            <AttachmentUploadButton\n                                addAttachment={attachment => {\n                                    this.props.addAttachment(attachment)\n                                }}\n                            />\n                        )}\n                        )\n                    </CardActions>\n                </CardText>\n            </Card>\n        )\n    }\n}\n\nReplyCard.propTypes = {\n    addAttachment: propTypes.func,\n    attachments: propTypes.array,\n    cancelAttachment: propTypes.func,\n    clearAttachments: propTypes.func,\n    displaySnackMessage: propTypes.func,\n    enableAttachments: propTypes.bool,\n    input: propTypes.string,\n    isInFeedbackRecipientGroup: propTypes.bool,\n    messageConversation: propTypes.object,\n    removeAttachment: propTypes.func,\n    replyMessage: propTypes.func,\n    selectedMessageConversation: propTypes.object,\n    selectedMessageType: propTypes.object,\n    updateInputFields: propTypes.func,\n}\n\nconst mapStateToProps = state => ({\n    selectedMessageConversation: state.messaging.selectedMessageConversation,\n    selectedMessageType: state.messaging.selectedMessageType,\n    messageTypes: state.messaging.messageTypes,\n    input: state.messaging.input,\n    isInFeedbackRecipientGroup: state.messaging.isInFeedbackRecipientGroup,\n    attachments: state.messaging.attachments,\n    enableAttachments: supportsAttachments(state.messaging.dhis2CoreVersion),\n})\n\nexport default compose(\n    connect(\n        mapStateToProps,\n        {\n            replyMessage,\n            setSelectedMessageType,\n            updateInputFields,\n            displaySnackMessage,\n            addAttachment,\n            removeAttachment,\n            cancelAttachment,\n        },\n        null,\n        { pure: false }\n    )\n)(ReplyCard)\n","import React, { Component } from 'react'\nimport { connect } from 'react-redux'\nimport propTypes from '@dhis2/prop-types'\nimport ChipInput from 'material-ui-chip-input'\nimport { debounce } from '../../utils/helpers'\nimport i18n from '@dhis2/d2-i18n'\nimport * as api from '../../api/api'\n\nconst searchDelay = 300\nconst minCharLength = 2\n\n/*\n * An AutoComplete text field with suggestions from a given list of\n * identifiable objects. Selected objects are shown as chips in the text field.\n */\n\nclass SuggestionField extends Component {\n    state = {\n        input: '',\n        searchResult: [],\n        searchOnlyUsers: this.props.searchOnlyUsers,\n        searchOnlyFeedbackRecipients: this.props.searchOnlyFeedbackRecipients,\n        lastSearch: '',\n        errorText: undefined,\n    }\n\n    debouncedSearch = debounce(this.search.bind(this), searchDelay)\n\n    search(input) {\n        const doSearch =\n            !this.state.searchResult.find(\n                result => result.displayName === input\n            ) &&\n            input !== '' &&\n            input.length >= minCharLength\n\n        if (doSearch) {\n            const {\n                feedbackRecipientsId,\n                searchOnlyUsers,\n                searchOnlyFeedbackRecipients,\n                dhis2CoreVersion,\n            } = this.props\n\n            api.searchRecipients({\n                searchValue: input,\n                searchOnlyUsers,\n                searchOnlyFeedbackRecipients,\n                feedbackRecipientsId,\n                dhis2CoreVersion,\n            }).then(({ users, userGroups, organisationUnits }) => {\n                const addType = type => result => ({ ...result, type })\n                let internalSearchResult = users.map(addType('user'))\n\n                if (!this.state.searchOnlyUsers) {\n                    internalSearchResult = internalSearchResult\n                        .concat(userGroups.map(addType('userGroup')))\n                        .concat(\n                            organisationUnits.map(addType('organisationUnit'))\n                        )\n                }\n\n                this.setState({\n                    searchResult: internalSearchResult,\n                    errorText:\n                        internalSearchResult.length === 0\n                            ? i18n.t('No results found')\n                            : undefined,\n                })\n            })\n        } else {\n            this.setState({\n                lastSearch: input,\n                searchResult:\n                    (this.state.lastSearch !== '' && input === '') ||\n                    input.length < minCharLength\n                        ? []\n                        : this.state.searchResult,\n                errorText:\n                    input !== '' && input.length < minCharLength\n                        ? i18n.t(\n                              `Please enter at least ${minCharLength} characters`\n                          )\n                        : this.state.searchWarning,\n            })\n        }\n    }\n\n    onSuggestionClick = chip => {\n        if (this.props.onSuggestionClick !== undefined) {\n            this.props.onSuggestionClick(chip)\n        } else {\n            this.wipeInput()\n            this.debouncedSearch('')\n\n            const doInsert = !this.props.recipients.find(\n                recipient => recipient.id === chip.id\n            )\n\n            doInsert &&\n                this.props.updateRecipients([\n                    ...this.props.recipients,\n                    this.state.searchResult.find(\n                        result => result.id === chip.id\n                    ),\n                ])\n        }\n    }\n\n    onRemoveChip = id => {\n        this.props.updateRecipients(\n            this.props.recipients.filter(recipient => recipient.id !== id)\n        )\n    }\n\n    wipeInput = () => {\n        this.setState({\n            input: '',\n            searchResult: [],\n        })\n    }\n\n    updateInput = input => {\n        this.debouncedSearch(input)\n        this.setState({\n            input,\n        })\n    }\n\n    render() {\n        return (\n            <div\n                style={{ ...this.props.style, height: this.props.inputHeight }}\n            >\n                <ChipInput\n                    style={{ marginBottom: 16 }}\n                    disabled={\n                        this.props.disabled === undefined\n                            ? false\n                            : this.props.disabled\n                    }\n                    errorText={this.props.errorText || this.state.errorText}\n                    value={this.props.recipients}\n                    fullWidth\n                    openOnFocus\n                    searchText={this.state.input}\n                    floatingLabelText={this.props.label}\n                    dataSource={this.state.searchResult}\n                    dataSourceConfig={{ text: 'displayName', value: 'id' }}\n                    onUpdateInput={this.updateInput}\n                    onRequestAdd={chip => this.onSuggestionClick(chip)}\n                    onRequestDelete={id => this.onRemoveChip(id)}\n                />\n            </div>\n        )\n    }\n}\n\nSuggestionField.propTypes = {\n    dhis2CoreVersion: propTypes.number,\n    disabled: propTypes.bool,\n    errorText: propTypes.string,\n    feedbackRecipientsId: propTypes.string,\n    inputHeight: propTypes.string,\n    label: propTypes.string,\n    recipients: propTypes.array,\n    searchOnlyFeedbackRecipients: propTypes.bool,\n    searchOnlyUsers: propTypes.bool,\n    style: propTypes.object,\n    updateRecipients: propTypes.func,\n    onSuggestionClick: propTypes.func,\n}\n\nexport default connect(state => ({\n    dhis2CoreVersion: state.messaging.dhis2CoreVersion,\n}))(SuggestionField)\n","import React from 'react'\nimport propTypes from '@dhis2/prop-types'\nimport Subheader from 'material-ui/Subheader/Subheader'\n\nconst styles = {\n    subheaderTitle: {\n        height: '32px',\n        color: 'black',\n        paddingLeft: 0,\n        paddingRight: 16,\n    },\n    subheader(color, fontWeight) {\n        return {\n            height: '32px',\n            overflow: 'hidden',\n            textOverflow: 'ellipsis',\n            whiteSpace: 'nowrap',\n            padding: 0,\n            color,\n            fontWeight,\n        }\n    },\n}\n\nconst ExtendedChoiceLabel = ({\n    showTitle,\n    title,\n    label,\n    color,\n    fontWeight,\n}) => {\n    const displayLabel =\n        label && label !== 'NONE'\n            ? title === 'Assignee'\n                ? label\n                : `${label.charAt(0)}${label\n                      .toLowerCase()\n                      .substr(1, label.length)}`\n            : '-'\n\n    return (\n        <div style={{ flex: 2, paddingLeft: 10, maxWidth: 200 }}>\n            {showTitle && (\n                <Subheader style={styles.subheaderTitle}> {title} </Subheader>\n            )}\n            <Subheader style={styles.subheader(color, fontWeight)}>\n                {displayLabel}\n            </Subheader>\n        </div>\n    )\n}\n\nExtendedChoiceLabel.propTypes = {\n    color: propTypes.string,\n    fontWeight: propTypes.string,\n    label: propTypes.string,\n    showTitle: propTypes.bool,\n    title: propTypes.string,\n}\n\nexport default ExtendedChoiceLabel\n","import theme from '../styles/theme';\nimport { fontFamily } from '../constants/development';\nexport const styles = {\n  canvas: {\n    flex: '3 0',\n    overflowY: 'scroll',\n    overflowX: 'hidden',\n    height: 'calc(100vh - 110px)',\n    paddingTop: '10px'\n  },\n  innerCanvas: {\n    display: 'flex',\n    flexDirection: 'column',\n    margin: '0px 10px 0px 10px'\n  },\n  header: {\n    display: 'flex'\n  },\n  iconButton: {\n    display: 'flex',\n    alignSelf: 'center'\n  },\n  subjectSubheader: {\n    display: 'flex',\n    alignSelf: 'center',\n    fontSize: '20px',\n    fontFamily\n  },\n  participantsCanvas: {\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  participants: {\n    paddingLeft: '12px',\n    paddingTop: '10px',\n    display: 'flex',\n    flexWrap: 'wrap'\n  },\n  chip: {\n    height: '32px',\n    marginRight: '3px',\n    marginBottom: '3px'\n  },\n  participantAddRow: {\n    display: 'flex'\n  },\n  participantsSuggestionField: {\n    paddingLeft: '12px',\n    marginBottom: '0px',\n    flex: 1\n  },\n  participantsAdd: {\n    alignSelf: 'flex-end',\n    marginBottom: '28px',\n    paddingLeft: '12px'\n  },\n  messagesCanvas: {\n    marginBottom: '50px',\n    display: 'flex',\n    flexDirection: 'column',\n    backgroundColor: theme.palette.accent2Color,\n    margin: '0px 10px 10px 10px'\n  },\n  messagesInnerCanvas: {\n    padding: '0px'\n  }\n};\nexport default styles;","import React, { Component } from 'react'\nimport propTypes from '@dhis2/prop-types'\nimport { connect } from 'react-redux'\n\nimport history from '../../utils/history'\nimport {\n    addRecipients,\n    downloadAttachment,\n    cancelAttachment,\n    clearSelectedMessageConversation,\n} from '../../actions'\nimport { supportsAttachments } from '../../utils/helpers'\n\nimport Subheader from 'material-ui/Subheader/Subheader'\nimport AddIcon from 'material-ui-icons/Add'\nimport NavigationBack from 'material-ui-icons/ArrowBack'\nimport FlatButton from 'material-ui/FlatButton'\nimport IconButton from 'material-ui/IconButton'\nimport Chip from 'material-ui/Chip'\nimport Paper from 'material-ui/Paper'\nimport i18n from '@dhis2/d2-i18n'\nimport Message from './Message'\nimport ReplyCard from './ReplyCard'\nimport SuggestionField from '../Common/SuggestionField'\nimport ExtendedChoiceLabel from '../Common/ExtendedChoiceLabel'\nimport { styles } from '../../styles/messageConversationStyles'\nimport theme from '../../styles/theme'\n\nconst NOTIFICATIONS = ['TICKET', 'VALIDATION_RESULT']\nconst maxParticipantsDisplay = 30\n\nclass MessageConversation extends Component {\n    constructor(props) {\n        super(props)\n\n        this.state = {\n            recipients: [],\n            cursor: 'auto',\n        }\n    }\n\n    backToList = () => {\n        const {\n            clearSelectedMessageConversation,\n            messageConversation,\n        } = this.props\n        history.push(`/${messageConversation.messageType}`)\n        clearSelectedMessageConversation()\n    }\n\n    addRecipients = () => {\n        const users = this.state.recipients.filter(r => r.type === 'user')\n        const userGroups = this.state.recipients.filter(\n            r => r.type === 'userGroup'\n        )\n        const organisationUnits = this.state.recipients.filter(\n            r => r.type === 'organisationUnit'\n        )\n        const {\n            messageConversation,\n            selectedMessageType: messageType,\n        } = this.props\n\n        this.props.addRecipients({\n            users,\n            userGroups,\n            organisationUnits,\n            messageConversation,\n            messageType,\n        })\n\n        this.setState({\n            recipients: [],\n        })\n    }\n\n    updateRecipients = recipients => {\n        this.setState({\n            recipients,\n        })\n    }\n\n    render() {\n        const { messageConversation, currentUser } = this.props\n        const messages = messageConversation.messages\n        const notification = !!(\n            NOTIFICATIONS.indexOf(messageConversation.messageType) + 1\n        )\n        const participants = messageConversation.userMessages\n            .slice(0, maxParticipantsDisplay)\n            .map(userMessage =>\n                !currentUser.id ||\n                this.state.recipientsExpanded ||\n                currentUser.id !== userMessage.user.id\n                    ? userMessage.user.displayName\n                    : i18n.t('me')\n            )\n        const userMessagesLength = messageConversation.userMessages.length\n\n        if (userMessagesLength > maxParticipantsDisplay) {\n            participants.push(\n                ' + '.concat(userMessagesLength - maxParticipantsDisplay)\n            )\n        }\n\n        return (\n            <div id=\"messageconversation\" style={styles.canvas}>\n                <div style={styles.innerCanvas}>\n                    <div style={styles.header}>\n                        <IconButton\n                            style={styles.iconButton}\n                            tooltipPosition=\"bottom-right\"\n                            onClick={this.backToList}\n                            tooltip={i18n.t('Show all messages')}\n                        >\n                            <NavigationBack />\n                        </IconButton>\n                        <Subheader style={styles.subjectSubheader}>\n                            {messageConversation.subject}\n                        </Subheader>\n                        {this.props.displayExtendedChoices && (\n                            <ExtendedChoiceLabel\n                                color={theme.palette.darkGray}\n                                showTitle\n                                title={i18n.t('Status')}\n                                label={messageConversation.status}\n                            />\n                        )}\n                        {this.props.displayExtendedChoices && (\n                            <ExtendedChoiceLabel\n                                color={theme.palette.darkGray}\n                                showTitle\n                                title={i18n.t('Priority')}\n                                label={messageConversation.priority}\n                            />\n                        )}\n                        {notification && (\n                            <ExtendedChoiceLabel\n                                color={theme.palette.darkGray}\n                                showTitle\n                                title={i18n.t('Assignee')}\n                                label={\n                                    messageConversation.assignee\n                                        ? messageConversation.assignee\n                                              .displayName\n                                        : undefined\n                                }\n                            />\n                        )}\n                    </div>\n                    <div style={styles.participantsCanvas}>\n                        <Subheader\n                            style={{\n                                paddingLeft: '12px',\n                                paddingTop: '10px',\n                            }}\n                        >\n                            {i18n.t('Participants')}\n                        </Subheader>\n                        <div style={styles.participants}>\n                            {participants.map(participant => (\n                                <Chip key={participant} style={styles.chip}>\n                                    {participant}\n                                </Chip>\n                            ))}\n                        </div>\n                    </div>\n                    <div style={styles.participantAddRow}>\n                        <SuggestionField\n                            style={styles.participantsSuggestionField}\n                            label={i18n.t('Add participants to conversation')}\n                            messageConversation={messageConversation}\n                            recipients={this.state.recipients}\n                            updateRecipients={this.updateRecipients}\n                            limitSearchArray={messageConversation.userMessages}\n                        />\n                        <div style={styles.participantsAdd}>\n                            <FlatButton\n                                icon={<AddIcon />}\n                                onClick={() => this.addRecipients()}\n                                label={i18n.t('Add')}\n                            />\n                        </div>\n                    </div>\n                </div>\n                <div style={styles.messagesCanvas}>\n                    <Paper style={styles.messagesInnerCanvas}>\n                        {messages.map((message, i) => (\n                            <Message\n                                key={message.id}\n                                displayTimeDiff={this.props.displayTimeDiff}\n                                message={message}\n                                messageConversation={messageConversation}\n                                notification={notification}\n                                currentUser={this.state.currentUser}\n                                lastMessage={i + 1 === messages.length}\n                                downloadAttachment={attachment =>\n                                    this.props.downloadAttachment(\n                                        messageConversation.id,\n                                        message.id,\n                                        attachment.id\n                                    )\n                                }\n                                cancelAttachment={this.props.cancelAttachment}\n                                enableAttachments={this.props.enableAttachments}\n                            />\n                        ))}\n                    </Paper>\n                    <ReplyCard\n                        {...this.props}\n                        messageConversation={messageConversation}\n                    />\n                </div>\n            </div>\n        )\n    }\n}\n\nMessageConversation.propTypes = {\n    addRecipients: propTypes.func,\n    cancelAttachment: propTypes.func,\n    clearSelectedMessageConversation: propTypes.func,\n    currentUser: propTypes.object,\n    displayExtendedChoices: propTypes.bool,\n    displayTimeDiff: propTypes.number,\n    downloadAttachment: propTypes.func,\n    enableAttachments: propTypes.bool,\n    messageConversation: propTypes.object,\n    selectedMessageType: propTypes.object,\n}\n\nconst mapStateToProps = state => ({\n    currentUser: state.messaging.currentUser,\n    selectedMessageType: state.messaging.selectedMessageType,\n    displayTimeDiff: state.messaging.displayTimeDiff,\n    enableAttachments: supportsAttachments(state.messaging.dhis2CoreVersion),\n})\n\nexport default connect(mapStateToProps, {\n    addRecipients,\n    downloadAttachment,\n    cancelAttachment,\n    clearSelectedMessageConversation,\n})(MessageConversation)\n","import React, { Component } from 'react'\nimport propTypes from '@dhis2/prop-types'\n\nimport CircularProgress from 'material-ui/CircularProgress'\nimport Badge from 'material-ui/Badge'\nimport Subheader from 'material-ui/Subheader/Subheader'\n\nimport i18n from '@dhis2/d2-i18n'\n\nimport theme from '../../styles/theme'\n\nclass MessageTypeItem extends Component {\n    constructor(props) {\n        super(props)\n\n        this.state = {\n            backgroundColor: theme.palette.accent2Color,\n            textColor: theme.palette.darkGray,\n        }\n    }\n\n    onClick = () => {\n        this.props.onClick()\n    }\n\n    onMouseEnter = () => {\n        this.setHoverText()\n        this.setState({ cursor: 'pointer' })\n    }\n    onMouseLeave = () => {\n        this.setNeutralText()\n        this.setState({ cursor: 'auto' })\n    }\n\n    setNeutralText = () => this.setTextColor(theme.palette.accent2Color)\n    setHoverText = () => this.setTextColor(theme.palette.accent3Color)\n\n    setTextColor = color => {\n        this.setState({\n            backgroundColor: color,\n        })\n    }\n\n    getBackgroundColor = (selectedValue, id) =>\n        selectedValue && id === selectedValue.id\n            ? theme.palette.accent3Color\n            : this.state.backgroundColor\n\n    render() {\n        return (\n            <div\n                role=\"presentation\"\n                style={{\n                    ...this.state,\n                    backgroundColor: this.getBackgroundColor(\n                        this.props.selectedMessageType,\n                        this.props.messageType.id\n                    ),\n                    cursor: this.state.cursor,\n                    alignItems: 'center',\n                    height: '49px',\n                    display: 'flex',\n                    flexDirection: 'row',\n                    justifyContent: 'space-between',\n                }}\n                onMouseEnter={this.onMouseEnter}\n                onMouseLeave={this.onMouseLeave}\n                onClick={() => this.onClick()}\n            >\n                <Subheader\n                    style={{\n                        marginLeft: '5px',\n                        fontSize:\n                            this.props.selectedMessageType &&\n                            this.props.messageType.id ===\n                                this.props.selectedMessageType.id\n                                ? '18px'\n                                : '16px',\n                        overflow: 'hidden',\n                        textOverflow: 'ellipsis',\n                        whiteSpace: 'nowrap',\n                        color:\n                            this.props.selectedMessageType &&\n                            this.props.messageType.id ===\n                                this.props.selectedMessageType.id\n                                ? theme.palette.primary1Color\n                                : this.state.textColor,\n                    }}\n                >\n                    {i18n.t(this.props.messageType.displayName)}\n                </Subheader>\n                {this.props.loading ? (\n                    <CircularProgress\n                        style={{ marginRight: '10px' }}\n                        color={theme.palette.primary1Color}\n                        size={24}\n                    />\n                ) : (\n                    this.props.messageType.unread > 0 && (\n                        <Badge\n                            style={{ marginTop: '12px', marginRight: '5px' }}\n                            badgeContent={\n                                this.props.messageType.unread > 100\n                                    ? '99+'\n                                    : this.props.messageType.unread\n                            }\n                            secondary\n                            badgeStyle={{ backgroundColor: '#439E8E' }}\n                        />\n                    )\n                )}\n            </div>\n        )\n    }\n}\n\nMessageTypeItem.propTypes = {\n    loading: propTypes.bool,\n    messageType: propTypes.object,\n    selectedMessageType: propTypes.object,\n    onClick: propTypes.func,\n}\n\nexport default MessageTypeItem\n","import React, { Component } from 'react'\nimport propTypes from '@dhis2/prop-types'\nimport { connect } from 'react-redux'\nimport { compose } from 'recompose'\nimport { List } from 'material-ui/List'\nimport Divider from 'material-ui/Divider'\nimport Toggle from 'material-ui/Toggle'\nimport i18n from '@dhis2/d2-i18n'\nimport history from '../../utils/history'\nimport { setSelectedMessageType, clearCheckedIds } from '../../actions'\nimport MessageTypeItem from './MessageTypeItem'\nimport theme from '../../styles/theme'\nimport moment from 'moment'\n\nconst styles = {\n    canvas: {\n        display: 'flex',\n        flexDirection: 'column',\n        justifyContent: 'space-between',\n        height: 'calc(100vh - 95px)',\n        borderLeftStyle: 'solid',\n        borderLeftWidth: '0.5px',\n        borderLeftColor: theme.palette.accent4Color,\n        borderRightStyle: 'solid',\n        borderRightWidth: '1px',\n        borderRightColor: theme.palette.accent4Color,\n        overflowY: 'auto',\n        overflowX: 'hidden',\n        minWidth: '200px',\n    },\n}\n\nclass SidebarList extends Component {\n    constructor(props) {\n        super(props)\n        this.props.setSelectedMessageType(this.props.match.params.messageType)\n    }\n\n    render() {\n        const messageTypes = this.props.messageTypes\n\n        return (\n            <div style={styles.canvas}>\n                <List\n                    style={{\n                        padding: '0px',\n                    }}\n                >\n                    {messageTypes &&\n                        messageTypes.map(messageType => (\n                            <div key={messageType.id}>\n                                <MessageTypeItem\n                                    messageType={messageType}\n                                    onClick={() => {\n                                        this.props.setSelectedMessageType(\n                                            messageType.id\n                                        )\n                                        this.props.updateInputFields('', '', [])\n                                        this.props.attachments.length > 0 &&\n                                            this.props.clearAttachments()\n                                        history.push(`/${messageType.id}`)\n                                    }}\n                                    selectedMessageType={\n                                        this.props.selectedMessageType\n                                    }\n                                    loading={messageType.loading}\n                                />\n                                <Divider />\n                            </div>\n                        ))}\n                </List>\n                <Toggle\n                    style={{ width: '', margin: '20px' }}\n                    label={`${i18n.t('Auto refresh')} (${moment(\n                        this.props.refreshTimer\n                    ).format('mm:ss')})`}\n                    toggled={this.props.autoRefresh}\n                    onToggle={() =>\n                        this.props.setAutoRefresh(!this.props.autoRefresh)\n                    }\n                />\n            </div>\n        )\n    }\n}\n\nSidebarList.propTypes = {\n    attachments: propTypes.array,\n    autoRefresh: propTypes.bool,\n    clearAttachments: propTypes.func,\n    match: propTypes.object,\n    messageTypes: propTypes.array,\n    refreshTimer: propTypes.number,\n    selectedMessageType: propTypes.object,\n    setAutoRefresh: propTypes.func,\n    setSelectedMessageType: propTypes.func,\n    updateInputFields: propTypes.func,\n}\n\nconst mapStateToProps = state => ({\n    selectedMessageType: state.messaging.selectedMessageType,\n    messageTypes: state.messaging.messageTypes,\n})\n\nexport default compose(\n    connect(\n        mapStateToProps,\n        {\n            setSelectedMessageType,\n            clearCheckedIds,\n        },\n        null,\n        { pure: false }\n    )\n)(SidebarList)\n","import theme from '../styles/theme';\nexport const messagePanelContainer = {\n  overflowY: 'scroll',\n  overflowX: 'hidden',\n  borderRightWidth: '1px',\n  borderRightColor: theme.palette.accent4Color,\n  height: 'calc(100vh - 95px)'\n};\nexport const subheader = {\n  paddingLeft: '0px',\n  fontSize: '20px'\n};","import React, { Component } from 'react'\nimport propTypes from '@dhis2/prop-types'\nimport { connect } from 'react-redux'\nimport { compose } from 'recompose'\nimport Subheader from 'material-ui/Subheader/Subheader'\nimport Checkbox from 'material-ui/Checkbox'\nimport Paper from 'material-ui/Paper'\nimport i18n from '@dhis2/d2-i18n'\nimport { setAllChecked, clearCheckedIds } from '../../actions'\nimport theme from '../../styles/theme'\nimport { fontFamily } from '../../constants/development'\n\nconst fontSize = '16px'\n\nconst styles = {\n    canvas(backgroundColor) {\n        return {\n            backgroundColor,\n            display: 'flex',\n            transition: 'all 0.2s ease-in-out',\n            boxSizing: 'border-box',\n            position: 'relative',\n            whiteSpace: 'nowrap',\n            alignSelf: 'center',\n            boxShadow: 'none',\n            borderBottom: '1px solid #dfdfdf',\n        }\n    },\n    checkBox: {\n        flex: '0 0 32px',\n        display: 'flex',\n        alignSelf: 'center',\n        paddingLeft: '12px',\n    },\n    sender: {\n        fontFamily,\n        fontSize,\n        flex: 3,\n        overflow: 'hidden',\n        textOverflow: 'ellipsis',\n        whiteSpace: 'nowrap',\n        color: 'black',\n        paddingLeft: 10,\n        alignSelf: 'center',\n    },\n    subject: {\n        flex: 8,\n        overflow: 'hidden',\n        textOverflow: 'ellipsis',\n        whiteSpace: 'nowrap',\n        fontFamily,\n        fontSize,\n        color: 'black',\n        paddingLeft: 10,\n    },\n    extendedLabel: {\n        flex: 2,\n        color: 'black',\n        fontSize,\n        overflow: 'hidden',\n        textOverflow: 'ellipsis',\n        whiteSpace: 'nowrap',\n        padding: '0 0 0 10px',\n    },\n}\n\nclass MessageConversationListItem extends Component {\n    constructor(props) {\n        super(props)\n\n        this.state = {\n            cursor: 'auto',\n            allChecked: false,\n        }\n    }\n\n    componentDidUpdate() {\n        if (\n            this.state.allChecked &&\n            this.props.checkedIds.length < this.props.messages.length\n        ) {\n            this.setState({ allChecked: false })\n        }\n    }\n\n    render() {\n        const displayExtendedChoices = this.props.displayExtendedChoices\n\n        return (\n            <Paper style={styles.canvas(theme.palette.canvasColor)}>\n                <Checkbox\n                    checked={this.state.allChecked}\n                    style={styles.checkBox}\n                    onCheck={() => {\n                        this.state.allChecked\n                            ? this.props.clearCheckedIds()\n                            : this.props.setAllChecked(\n                                  this.props.messages.map(child => ({\n                                      id: child.id,\n                                  }))\n                              )\n\n                        this.setState({ allChecked: !this.state.allChecked })\n                    }}\n                />\n                <div style={styles.sender}>{i18n.t('Sender')}</div>\n                <Subheader style={styles.subject}>\n                    {i18n.t('Subject')}\n                </Subheader>\n                {displayExtendedChoices && (\n                    <Subheader style={styles.extendedLabel}>\n                        {i18n.t('Status')}\n                    </Subheader>\n                )}\n                {displayExtendedChoices && (\n                    <Subheader style={styles.extendedLabel}>\n                        {i18n.t('Priority')}\n                    </Subheader>\n                )}\n                {this.props.notification && (\n                    <Subheader style={styles.extendedLabel}>\n                        {i18n.t('Assignee')}\n                    </Subheader>\n                )}\n                <Subheader style={styles.extendedLabel}>\n                    {i18n.t('Date')}\n                </Subheader>\n            </Paper>\n        )\n    }\n}\n\nMessageConversationListItem.propTypes = {\n    checkedIds: propTypes.array,\n    clearCheckedIds: propTypes.func,\n    displayExtendedChoices: propTypes.bool,\n    messages: propTypes.array,\n    notification: propTypes.bool,\n    setAllChecked: propTypes.func,\n}\n\nconst mapStateToProps = state => ({\n    checkedIds: state.messaging.checkedIds,\n    isInFeedbackRecipientGroup: state.messaging.isInFeedbackRecipientGroup,\n})\n\nexport default compose(\n    connect(mapStateToProps, {\n        setAllChecked,\n        clearCheckedIds,\n    })\n)(MessageConversationListItem)\n","import React, { Component } from 'react'\nimport propTypes from '@dhis2/prop-types'\nimport { connect } from 'react-redux'\nimport { compose } from 'recompose'\nimport Subheader from 'material-ui/Subheader/Subheader'\nimport Checkbox from 'material-ui/Checkbox'\nimport Paper from 'material-ui/Paper'\nimport Flag from 'material-ui-icons/Flag'\nimport i18n from '@dhis2/d2-i18n'\nimport history from '../../utils/history'\nimport {\n    setChecked,\n    setSelectedMessageConversation,\n    markMessageConversations,\n    clearCheckedIds,\n    setFilter,\n    updateInputFields,\n    clearAttachments,\n} from '../../actions'\nimport ExtendedChoiceLabel from '../Common/ExtendedChoiceLabel'\nimport theme from '../../styles/theme'\nimport { fontFamily } from '../../constants/development'\nimport moment from 'moment'\n\nconst styles = {\n    container(backgroundColor, wideview, cursor) {\n        return {\n            backgroundColor,\n            display: 'flex',\n            transition: 'all 0.2s ease-in-out',\n            cursor: cursor,\n            boxSizing: 'border-box',\n            position: 'relative',\n            whiteSpace: 'nowrap',\n            boxShadow: 'none',\n            borderBottom: '1px solid #dfdfdf',\n            flexWrap: wideview ? 'nowrap' : 'wrap',\n        }\n    },\n    checkBox(wideview) {\n        return {\n            flex: '0 0 32px',\n            display: 'flex',\n            alignSelf: 'center',\n            paddingLeft: wideview ? 12 : 6,\n        }\n    },\n    flag: {\n        color: theme.palette.followUp,\n        marginRight: 4,\n    },\n    sender(wideview, fontWeight) {\n        return {\n            fontFamily,\n            fontSize: '14px',\n            flex: 3,\n            overflow: 'hidden',\n            textOverflow: 'ellipsis',\n            whiteSpace: 'nowrap',\n            display: 'flex',\n            alignItems: 'center',\n            color: 'black',\n            paddingLeft: wideview ? 10 : 0,\n            fontWeight,\n        }\n    },\n    subject(wideview, fontColor, fontWeight) {\n        return {\n            flex: 8,\n            overflow: 'hidden',\n            textOverflow: 'ellipsis',\n            whiteSpace: 'nowrap',\n            paddingLeft: 10,\n            fontFamily,\n            color: fontColor,\n            fontWeight,\n            order: wideview ? 'inherit' : 10,\n            marginTop: wideview ? 0 : -10,\n            flexBasis: wideview ? '0%' : '100%',\n        }\n    },\n    dateFormat(wideview, fontColor, fontWeight) {\n        return {\n            flex: 2,\n            fontFamily,\n            paddingLeft: wideview ? 10 : 0,\n            paddingRight: wideview ? 0 : 10,\n            overflow: 'hidden',\n            textOverflow: 'ellipsis',\n            whiteSpace: 'nowrap',\n            textAlign: wideview ? '' : 'end',\n            color: fontColor,\n            fontWeight,\n        }\n    },\n}\n\nclass MessageConversationListItem extends Component {\n    constructor(props) {\n        super(props)\n\n        this.state = {\n            backgroundColor: theme.palette.canvasColor,\n            cursor: 'auto',\n        }\n    }\n\n    onClick = messageConversation => {\n        this.props.setSelectedMessageConversation(messageConversation)\n        if (messageConversation && !messageConversation.read) {\n            this.props.markMessageConversations(\n                'read',\n                [messageConversation.id],\n                this.props.selectedMessageType\n            )\n        }\n        this.props.updateInputFields('', '', [])\n        this.props.attachments.length > 0 && this.props.clearAttachments()\n        history.push(\n            `/${messageConversation.messageType}/${messageConversation.id}`\n        )\n    }\n\n    onMouseEnter = () =>\n        this.setState({\n            cursor: 'pointer',\n            backgroundColor: theme.palette.accent2Color,\n        })\n    onMouseLeave = () =>\n        this.setState({\n            cursor: 'auto',\n            backgroundColor: theme.palette.canvasColor,\n        })\n\n    getBackgroundColor = (messageConversation, checked) => {\n        const selectedMessageConversation =\n            this.props.selectedMessageConversation &&\n            messageConversation.id === this.props.selectedMessageConversation.id\n\n        if (checked && !selectedMessageConversation) {\n            return theme.palette.blue50\n        } else if (selectedMessageConversation) {\n            return theme.palette.accent3Color\n        }\n        return this.state.backgroundColor\n    }\n\n    render() {\n        const messageConversation = this.props.messageConversation\n        const title = messageConversation.lastSender\n            ? messageConversation.lastSender.displayName\n            : this.props.selectedMessageType.displayName\n        const checked = !!this.props.checkedIds.find(\n            x => x.id === messageConversation.id\n        )\n\n        const displayExtendedChoices = this.props.displayExtendedChoices\n\n        const displayTimeDiff = this.props.displayTimeDiff\n\n        const today = moment()\n        const messageDate = moment(messageConversation.lastMessage).add(\n            displayTimeDiff\n        )\n        const fontWeight = !messageConversation.read ? 'bold' : ''\n        const fontColor = this.props.messageConversation.read\n            ? 'black'\n            : theme.palette.darkGray\n\n        const containerBackgroundColor = this.getBackgroundColor(\n            messageConversation,\n            checked\n        )\n\n        return (\n            <Paper\n                style={styles.container(\n                    containerBackgroundColor,\n                    this.props.wideview,\n                    this.state.cursor\n                )}\n                onClick={event => {\n                    const onClick =\n                        event.target.innerText !== undefined &&\n                        event.target.innerText !== ''\n\n                    if (\n                        onClick &&\n                        !this.props.settingSelectedMessageConversation\n                    ) {\n                        this.onClick(messageConversation)\n                        this.props.checkedIds.length > 0 &&\n                            this.props.clearCheckedIds()\n                        if (\n                            this.props.wideview &&\n                            (this.props.messageFilter !== undefined ||\n                                this.props.priorityFilter !== undefined ||\n                                this.props.statusFilter !== undefined)\n                        ) {\n                            this.props.setFilter(undefined, 'MESSAGE')\n                        }\n                    }\n                }}\n                onMouseEnter={this.onMouseEnter}\n                onMouseLeave={this.onMouseLeave}\n            >\n                <Checkbox\n                    checked={checked}\n                    style={styles.checkBox(this.props.wideview)}\n                    onCheck={() => {\n                        this.props.setChecked(messageConversation, !checked)\n                    }}\n                />\n                <div style={styles.sender(this.props.wideview, fontWeight)}>\n                    {messageConversation.followUp && (\n                        <Flag style={styles.flag} />\n                    )}\n                    <span>{title}</span>\n                </div>\n                <Subheader\n                    style={styles.subject(\n                        this.props.wideview,\n                        fontColor,\n                        fontWeight\n                    )}\n                >\n                    {messageConversation.subject}\n                </Subheader>\n                {displayExtendedChoices && (\n                    <ExtendedChoiceLabel\n                        showTitle={false}\n                        title={i18n.t('Status')}\n                        color={fontColor}\n                        fontWeight={fontWeight}\n                        label={messageConversation.status}\n                    />\n                )}\n                {displayExtendedChoices && (\n                    <ExtendedChoiceLabel\n                        showTitle={false}\n                        title={i18n.t('Priority')}\n                        color={fontColor}\n                        fontWeight={fontWeight}\n                        label={messageConversation.priority}\n                    />\n                )}\n                {this.props.notification && this.props.wideview && (\n                    <ExtendedChoiceLabel\n                        showTitle={false}\n                        title={i18n.t('Assignee')}\n                        color={fontColor}\n                        fontWeight={fontWeight}\n                        label={\n                            messageConversation.assignee\n                                ? messageConversation.assignee.displayName\n                                : undefined\n                        }\n                    />\n                )}\n                <Subheader\n                    style={styles.dateFormat(\n                        this.props.wideview,\n                        fontColor,\n                        fontWeight\n                    )}\n                >\n                    {today.diff(messageDate, 'hours') < 72\n                        ? messageDate.from(today)\n                        : today.year() === messageDate.year()\n                        ? messageDate.format('MMM DD')\n                        : messageDate.format('ll')}\n                </Subheader>\n            </Paper>\n        )\n    }\n}\n\nMessageConversationListItem.propTypes = {\n    attachments: propTypes.array,\n    checkedIds: propTypes.array,\n    clearAttachments: propTypes.func,\n    clearCheckedIds: propTypes.func,\n    displayExtendedChoices: propTypes.bool,\n    displayTimeDiff: propTypes.number,\n    markMessageConversations: propTypes.func,\n    messageConversation: propTypes.object,\n    messageFilter: propTypes.string,\n    notification: propTypes.bool,\n    priorityFilter: propTypes.string,\n    selectedMessageConversation: propTypes.object,\n    selectedMessageType: propTypes.object,\n    setChecked: propTypes.func,\n    setFilter: propTypes.func,\n    setSelectedMessageConversation: propTypes.func,\n    settingSelectedMessageConversation: propTypes.bool,\n    statusFilter: propTypes.string,\n    updateInputFields: propTypes.func,\n    wideview: propTypes.bool,\n}\n\nconst mapStateToProps = state => ({\n    selectedMessageConversation: state.messaging.selectedMessageConversation,\n    settingSelectedMessageConversation:\n        state.messaging.settingSelectedMessageConversation,\n    selectedMessageType: state.messaging.selectedMessageType,\n    checkedIds: state.messaging.checkedIds,\n    displayTimeDiff: state.messaging.displayTimeDiff,\n    messageFilter: state.messaging.messageFilter,\n    statusFilter: state.messaging.statusFilter,\n    priorityFilter: state.messaging.priorityFilter,\n    attachments: state.messaging.attachments,\n})\n\nexport default compose(\n    connect(\n        mapStateToProps,\n        {\n            setChecked,\n            setSelectedMessageConversation,\n            markMessageConversations,\n            clearCheckedIds,\n            setFilter,\n            updateInputFields,\n            clearAttachments,\n        },\n        null,\n        { pure: false }\n    )\n)(MessageConversationListItem)\n","import React, { Component } from 'react'\nimport propTypes from '@dhis2/prop-types'\nimport { connect } from 'react-redux'\nimport { compose } from 'recompose'\nimport Subheader from 'material-ui/Subheader/Subheader'\nimport CircularProgress from 'material-ui/CircularProgress'\nimport i18n from '@dhis2/d2-i18n'\nimport { loadMessageConversations } from '../../actions'\nimport { messagePanelContainer } from '../../styles/style'\nimport theme from '../../styles/theme'\nimport ListItemHeader from './ListItemHeader'\nimport MessageConversationListItem from './MessageConversationListItem'\nimport { dedupeById, debounce } from '../../utils/helpers'\n\nconst NOTIFICATIONS = ['VALIDATION_RESULT', 'TICKET']\nconst bottomEmptyHeight = 50\n\nconst styles = {\n    canvas(wideview) {\n        return {\n            flex: '1 0',\n            maxWidth: wideview ? 'none' : '350px',\n            minWidth: wideview ? 'none' : '250px',\n            borderRightStyle: wideview ? '' : 'solid',\n            ...messagePanelContainer,\n        }\n    },\n    loading: {\n        backgroundColor: theme.palette.accent2Color,\n        height: `${bottomEmptyHeight}px`,\n        transition: 'all 0.2s ease-in-out',\n        display: 'flex',\n        justifyContent: 'center',\n    },\n}\n\nclass MessageConversationList extends Component {\n    onScroll = messageType => {\n        const messageList = document.getElementById('messagelist')\n        if (\n            !this.props.selectedMessageType.loading &&\n            this.isBottom(messageList) &&\n            messageType.loaded < messageType.total\n        ) {\n            this.props.loadMessageConversations(\n                messageType,\n                messageType.id,\n                true\n            )\n        }\n    }\n\n    debouncedOnScroll = debounce(this.onScroll, 150)\n    isBottom = el => el.scrollHeight - el.scrollTop < window.outerHeight\n\n    render() {\n        const messages = dedupeById(\n            this.props.messageConversations[this.props.selectedMessageType.id]\n        )\n\n        const messageType = this.props.selectedMessageType\n            ? this.props.selectedMessageType\n            : ''\n        const selectedValue = this.props.selectedMessageConversation\n            ? this.props.selectedMessageConversation.id\n            : ''\n\n        const notification = !!(NOTIFICATIONS.indexOf(messageType.id) + 1)\n        return (\n            <div\n                id={'messagelist'}\n                onScroll={() =>\n                    this.debouncedOnScroll(this.props.selectedMessageType)\n                }\n                style={styles.canvas(this.props.wideview)}\n            >\n                {this.props.wideview && (\n                    <ListItemHeader\n                        notification={notification}\n                        displayExtendedChoices={\n                            this.props.displayExtendedChoices\n                        }\n                        messages={messages}\n                    />\n                )}\n                {messages && messages.length !== 0\n                    ? messages.map(child => (\n                          <MessageConversationListItem\n                              key={child.id}\n                              messageConversation={child}\n                              wideview={this.props.wideview}\n                              selectedValue={selectedValue}\n                              notification={notification}\n                              displayExtendedChoices={\n                                  this.props.displayExtendedChoices\n                              }\n                          />\n                      ))\n                    : !this.props.selectedMessageType.loading && (\n                          <Subheader>\n                              {i18n.t(\n                                  `No ${messageType.displayName.toLowerCase()} messages`\n                              )}\n                          </Subheader>\n                      )}\n                {this.props.selectedMessageType.loading && (\n                    <div style={styles.loading}>\n                        <CircularProgress\n                            style={{ marginTop: '10px' }}\n                            color={theme.palette.primary1Color}\n                        />\n                    </div>\n                )}\n            </div>\n        )\n    }\n}\n\nMessageConversationList.propTypes = {\n    displayExtendedChoices: propTypes.bool,\n    loadMessageConversations: propTypes.func,\n    messageConversations: propTypes.object,\n    selectedMessageConversation: propTypes.object,\n    selectedMessageType: propTypes.shape({\n        id: propTypes.string,\n        loading: propTypes.bool,\n    }),\n    wideview: propTypes.bool,\n}\n\nconst mapStateToProps = state => ({\n    messageTypes: state.messaging.messageTypes,\n    messageFilter: state.messaging.messageFilter,\n    statusFilter: state.messaging.statusFilter,\n    priorityFilter: state.messaging.priorityFilter,\n    messageConversations: state.messaging.messageConversations,\n    selectedMessageConversation: state.messaging.selectedMessageConversation,\n    selectedMessageType: state.messaging.selectedMessageType,\n})\n\nexport default compose(\n    connect(\n        mapStateToProps,\n        {\n            loadMessageConversations,\n        },\n        null,\n        { pure: false }\n    )\n)(MessageConversationList)\n","import React, { Component } from 'react'\nimport propTypes from '@dhis2/prop-types'\nimport { connect } from 'react-redux'\nimport { compose } from 'recompose'\nimport i18n from '@dhis2/d2-i18n'\nimport { Card, CardActions, CardText } from 'material-ui/Card'\nimport RaisedButton from 'material-ui/RaisedButton'\nimport FlatButton from 'material-ui/FlatButton'\nimport TextField from 'material-ui/TextField'\nimport Subheader from 'material-ui/Subheader/Subheader'\nimport RadioButton from 'material-ui/RadioButton'\nimport {\n    sendMessage,\n    sendFeedbackMessage,\n    displaySnackMessage,\n    updateInputFields,\n    addAttachment,\n    removeAttachment,\n    cancelAttachment,\n    addRecipientByUserId,\n} from '../../actions'\nimport history from '../../utils/history'\nimport { supportsAttachments } from '../../utils/helpers'\nimport SuggestionField from '../Common/SuggestionField'\nimport AttachmentUploadButton from '../Attachments/AttachmentUploadButton'\nimport { NEGATIVE } from '../../constants/development'\nimport Attachments from '../Attachments/Attachments'\nimport { subheader } from '../../styles/style'\n\nconst styles = {\n    canvas: {\n        flex: '3 0',\n        margin: '10px',\n        overflowY: 'scroll',\n        overflowX: 'hidden',\n        height: 'calc(100vh - 110px)',\n    },\n    messageTypeField: {\n        display: 'flex',\n        flexDirection: 'row',\n    },\n    messageType: { width: '300px', marginTop: '10px' },\n}\n\nclass CreateMessage extends Component {\n    constructor(props) {\n        super(props)\n\n        this.state = {\n            isMessageFeedback: false,\n        }\n    }\n\n    componentDidMount() {\n        const { addRecipientByUserId } = this.props\n        const { messageId, recipientId } = this.props.match.params\n\n        // This happens when the \"Send message\" button in the user-app is clicked\n        if (messageId === 'create' && recipientId) {\n            addRecipientByUserId(recipientId)\n        }\n    }\n\n    subjectUpdate = (event, newValue) => {\n        this.props.updateInputFields(\n            newValue,\n            this.props.input,\n            this.props.recipients\n        )\n    }\n\n    inputUpdate = (event, newValue) => {\n        this.props.updateInputFields(\n            this.props.subject,\n            newValue,\n            this.props.recipients\n        )\n    }\n\n    updateRecipients = recipients => {\n        this.props.updateInputFields(\n            this.props.subject,\n            this.props.input,\n            recipients\n        )\n    }\n\n    sendMessage = () => {\n        const messageTypeId = this.state.isMessageFeedback\n            ? 'TICKET'\n            : 'PRIVATE'\n        const messageType = this.props.messageTypes.find(\n            messageType => messageType.id === messageTypeId\n        )\n\n        if (this.state.isMessageFeedback) {\n            this.props.sendFeedbackMessage(messageType)\n            history.push('/TICKET')\n        } else {\n            const users = this.props.recipients.filter(r => r.type === 'user')\n            const userGroups = this.props.recipients.filter(\n                r => r.type === 'userGroup'\n            )\n            const organisationUnits = this.props.recipients.filter(\n                r => r.type === 'organisationUnit'\n            )\n\n            this.props.sendMessage({\n                users,\n                userGroups,\n                organisationUnits,\n                messageType,\n            })\n            history.push('/PRIVATE')\n        }\n    }\n\n    wipeInput = () => {\n        this.props.updateInputFields('', '', [])\n        this.props.attachments.length > 0 && this.props.clearAttachments()\n    }\n\n    handleDiscard = () => {\n        const message = i18n.t('Message discarded')\n        const snackType = NEGATIVE\n        const onSnackActionClick = () => history.push('/PRIVATE/create')\n        const onSnackRequestClose = () => this.wipeInput()\n\n        this.props.displaySnackMessage({\n            message,\n            onSnackActionClick,\n            onSnackRequestClose,\n            snackType,\n        })\n\n        history.push('/PRIVATE')\n    }\n\n    render() {\n        const disabled =\n            this.props.subject === '' ||\n            this.props.input === '' ||\n            (!this.state.isMessageFeedback &&\n                this.props.recipients.length === 0)\n\n        const discardDisabled =\n            this.props.subject === '' &&\n            this.props.input === '' &&\n            !this.state.isMessageFeedback &&\n            this.props.recipients.length === 0\n\n        return (\n            <div style={styles.canvas}>\n                <Subheader style={subheader}> {i18n.t('Create')}</Subheader>\n                <Card>\n                    <CardText>\n                        <SuggestionField\n                            style={{ margin: '0px' }}\n                            label={i18n.t('To')}\n                            disabled={this.state.isMessageFeedback}\n                            recipients={\n                                this.state.isMessageFeedback\n                                    ? [\n                                          {\n                                              id: 'id',\n                                              displayName: i18n.t(\n                                                  'Feedback recipient group'\n                                              ),\n                                          },\n                                      ]\n                                    : this.props.recipients\n                            }\n                            updateRecipients={this.updateRecipients}\n                            inputHeight={'100px'}\n                        />\n                        <div style={styles.messageTypeField}>\n                            <div style={styles.messageType}>\n                                <RadioButton\n                                    label={i18n.t('Private message')}\n                                    checked={!this.state.isMessageFeedback}\n                                    onCheck={() => {\n                                        this.setState({\n                                            isMessageFeedback: !this.state\n                                                .isMessageFeedback,\n                                        })\n                                    }}\n                                />\n                            </div>\n                            <div style={styles.messageType}>\n                                <RadioButton\n                                    label={i18n.t('Feedback message')}\n                                    checked={this.state.isMessageFeedback}\n                                    onCheck={() => {\n                                        this.setState({\n                                            isMessageFeedback: !this.state\n                                                .isMessageFeedback,\n                                        })\n                                    }}\n                                />\n                            </div>\n                        </div>\n                        <TextField\n                            floatingLabelText={i18n.t('Subject')}\n                            fullWidth\n                            value={this.props.subject}\n                            onChange={this.subjectUpdate}\n                        />\n                        <TextField\n                            key={'createMessage'}\n                            id={'createMessage'}\n                            rows={5}\n                            underlineShow={false}\n                            value={this.props.input}\n                            multiLine\n                            fullWidth\n                            floatingLabelText={i18n.t('Message')}\n                            onChange={this.inputUpdate}\n                        />\n                        {this.props.enableAttachments && (\n                            <Attachments\n                                dataDirection={'upload'}\n                                attachments={this.props.attachments}\n                                removeAttachment={attachment =>\n                                    this.props.removeAttachment(attachment.id)\n                                }\n                                cancelAttachment={this.props.cancelAttachment}\n                            />\n                        )}\n                        <CardActions style={{ paddingLeft: '0px' }}>\n                            <RaisedButton\n                                primary\n                                disabled={disabled}\n                                label={i18n.t('Send')}\n                                onClick={() => this.sendMessage()}\n                            />\n                            <FlatButton\n                                label={i18n.t('Discard')}\n                                disabled={discardDisabled}\n                                onClick={this.handleDiscard}\n                            />\n                            {this.props.enableAttachments && (\n                                <AttachmentUploadButton\n                                    addAttachment={attachment => {\n                                        this.props.addAttachment(attachment)\n                                    }}\n                                />\n                            )}\n                        </CardActions>\n                    </CardText>\n                </Card>\n            </div>\n        )\n    }\n}\n\nCreateMessage.propTypes = {\n    addAttachment: propTypes.func,\n    addRecipientByUserId: propTypes.func,\n    attachments: propTypes.array,\n    cancelAttachment: propTypes.func,\n    clearAttachments: propTypes.func,\n    displaySnackMessage: propTypes.func,\n    enableAttachments: propTypes.bool,\n    input: propTypes.string,\n    match: propTypes.object,\n    messageTypes: propTypes.array,\n    recipients: propTypes.array,\n    removeAttachment: propTypes.func,\n    sendFeedbackMessage: propTypes.func,\n    sendMessage: propTypes.func,\n    subject: propTypes.string,\n    updateInputFields: propTypes.func,\n}\n\nconst mapStateToProps = state => ({\n    messageTypes: state.messaging.messageTypes,\n    subject: state.messaging.subject,\n    input: state.messaging.input,\n    recipients: state.messaging.recipients,\n    attachments: state.messaging.attachments,\n    enableAttachments: supportsAttachments(state.messaging.dhis2CoreVersion),\n})\n\nexport default compose(\n    connect(\n        mapStateToProps,\n        {\n            sendMessage,\n            sendFeedbackMessage,\n            displaySnackMessage,\n            updateInputFields,\n            addAttachment,\n            removeAttachment,\n            cancelAttachment,\n            addRecipientByUserId,\n        },\n        null,\n        { pure: false }\n    )\n)(CreateMessage)\n","import i18n from '@dhis2/d2-i18n';\nconst extendedChoices = {\n  STATUS: [{\n    key: 'NONE',\n    value: 'NONE',\n    primaryText: i18n.t('No status')\n  }, {\n    key: 'OPEN',\n    value: 'OPEN',\n    primaryText: i18n.t('Open')\n  }, {\n    key: 'PENDING',\n    value: 'PENDING',\n    primaryText: i18n.t('Pending')\n  }, {\n    key: 'INVALID',\n    value: 'INVALID',\n    primaryText: i18n.t('Invalid')\n  }, {\n    key: 'SOLVED',\n    value: 'SOLVED',\n    primaryText: i18n.t('Solved')\n  }],\n  PRIORITY: [{\n    key: 'NONE',\n    value: 'NONE',\n    primaryText: i18n.t('No priority')\n  }, {\n    key: 'HIGH',\n    value: 'HIGH',\n    primaryText: i18n.t('High')\n  }, {\n    key: 'MEDIUM',\n    value: 'MEDIUM',\n    primaryText: i18n.t('Medium')\n  }, {\n    key: 'LOW',\n    value: 'LOW',\n    primaryText: i18n.t('Low')\n  }]\n};\nexport default extendedChoices;","import React from 'react';\nimport propTypes from '@dhis2/prop-types';\nimport { Provider, ReactReduxContext } from 'react-redux';\nimport Dialog from 'material-ui/Dialog';\nexport default function DialogWithReduxState(props) {\n  return <ReactReduxContext.Consumer>\n            {ctx => <Dialog {...props}>\n                    <Provider store={ctx.store}>{props.children}</Provider>\n                </Dialog>}\n        </ReactReduxContext.Consumer>;\n}\nDialogWithReduxState.propTypes = {\n  children: propTypes.node\n};","import React from 'react'\nimport propTypes from '@dhis2/prop-types'\nimport i18n from '@dhis2/d2-i18n'\nimport SuggestionField from './SuggestionField'\nimport DialogWithReduxState from './DialogWithReduxState'\n\nconst AssignToDialog = ({\n    open,\n    onRequestClose,\n    updateMessageConversations,\n    messageType,\n    feedbackRecipientsId,\n}) => (\n    <DialogWithReduxState\n        open={open}\n        onRequestClose={() => {\n            onRequestClose()\n        }}\n    >\n        <SuggestionField\n            onSuggestionClick={chip => {\n                updateMessageConversations([chip.id])\n                onRequestClose()\n            }}\n            searchOnlyUsers\n            searchOnlyFeedbackRecipients={messageType.id === 'TICKET'}\n            feedbackRecipientsId={feedbackRecipientsId}\n            recipients={[]}\n            key={'suggestionField'}\n            label={i18n.t('Assignee')}\n        />\n    </DialogWithReduxState>\n)\n\nAssignToDialog.propTypes = {\n    feedbackRecipientsId: propTypes.string,\n    messageType: propTypes.shape({ id: propTypes.string }),\n    open: propTypes.bool,\n    updateMessageConversations: propTypes.func,\n    onRequestClose: propTypes.func,\n}\n\nexport default AssignToDialog\n","import React, { Component } from 'react'\nimport propTypes from '@dhis2/prop-types'\nimport { connect } from 'react-redux'\nimport { compose } from 'recompose'\nimport FlatButton from 'material-ui/FlatButton'\nimport MoreVertIcon from 'material-ui/svg-icons/navigation/more-vert'\nimport ArrowDropRight from 'material-ui/svg-icons/navigation-arrow-drop-right'\nimport Assignment from 'material-ui-icons/Assignment'\nimport IconMenu from 'material-ui/IconMenu'\nimport MenuItem from 'material-ui/MenuItem'\nimport IconButton from 'material-ui/IconButton'\nimport Subheader from 'material-ui/Subheader'\nimport Divider from 'material-ui/Divider'\nimport Delete from 'material-ui-icons/Delete'\nimport MarkUnread from 'material-ui-icons/Markunread'\nimport Done from 'material-ui-icons/Done'\nimport i18n from '@dhis2/d2-i18n'\nimport {\n    clearCheckedIds,\n    clearSelectedMessageConversation,\n    deleteMessageConversations,\n    updateMessageConversations,\n    markMessageConversations,\n} from '../../actions'\nimport extendedChoices from '../../constants/extendedChoices'\nimport history from '../../utils/history'\nimport AssignToDialog from './AssignToDialog'\nimport DialogWithReduxState from './DialogWithReduxState'\n\nconst multiSelectDisplayLimit = 99\n\nconst styles = {\n    canvas: {\n        width: '400px',\n        display: 'flex',\n    },\n    extendedChoices: {\n        display: 'flex',\n        justifyContent: 'flex-start',\n    },\n    nrSelected: {\n        padding: '0px 0px',\n        overflow: 'hidden',\n        textOverflow: 'ellipsis',\n        whiteSpace: 'nowrap',\n    },\n}\n\nclass ToolbarExtendedChoicePicker extends Component {\n    constructor(props) {\n        super(props)\n\n        this.state = {\n            checkedItems: false,\n            dialogOpen: false,\n            assignToOpen: false,\n        }\n    }\n\n    getIds = () =>\n        this.props.selectedMessageConversation &&\n        this.props.checkedIds.length === 0\n            ? [this.props.selectedMessageConversation.id]\n            : this.props.checkedIds.map(id => id.id)\n\n    updateMessageConversation = (identifier, value) => {\n        const {\n            selectedMessageType: messageType,\n            selectedMessageConversation,\n        } = this.props\n        const messageConversationIds = this.getIds()\n\n        this.props.updateMessageConversations({\n            messageConversationIds,\n            identifier,\n            value,\n            messageType,\n            selectedMessageConversation,\n        })\n        this.props.checkedIds.length > 0 && this.props.clearCheckedIds()\n    }\n\n    markMessageConversations = mode => {\n        const ids = this.getIds()\n        this.props.markMessageConversations(\n            mode,\n            ids,\n            this.props.selectedMessageType\n        )\n        this.props.checkedIds.length > 0 && this.props.clearCheckedIds()\n    }\n\n    toggleDialog = () => {\n        this.setState({ dialogOpen: !this.state.dialogOpen })\n    }\n\n    render() {\n        const messageConversation = this.props.selectedMessageConversation\n        const multiSelect = this.props.checkedIds.length > 0\n        const display = multiSelect || messageConversation !== undefined\n\n        const actionButtons = (\n            <>\n                <FlatButton\n                    label={i18n.t('Cancel')}\n                    primary\n                    onClick={() => this.toggleDialog()}\n                />\n                <FlatButton\n                    label={i18n.t('Submit')}\n                    primary\n                    keyboardFocused\n                    onClick={() => {\n                        this.props.deleteMessageConversations(\n                            this.getIds(),\n                            this.props.selectedMessageType\n                        )\n                        this.props.clearCheckedIds()\n                        this.toggleDialog()\n\n                        if (this.props.selectedMessageConversation) {\n                            this.props.clearSelectedMessageConversation()\n                            history.push(\n                                `/${this.props.selectedMessageType.id}`\n                            )\n                        }\n                    }}\n                />\n            </>\n        )\n\n        const displayNumberOfCheckedIds =\n            this.props.checkedIds.length > multiSelectDisplayLimit\n                ? `${multiSelectDisplayLimit}+`\n                : this.props.checkedIds.length\n\n        return display ? (\n            <div style={styles.canvas}>\n                <DialogWithReduxState\n                    title={i18n.t(\n                        'Are you sure you want to delete selected message conversation(s)?'\n                    )}\n                    actions={actionButtons}\n                    modal={false}\n                    open={this.state.dialogOpen}\n                    onRequestClose={this.toggleDialog}\n                />\n                <AssignToDialog\n                    open={this.state.assignToOpen}\n                    onRequestClose={() =>\n                        this.setState({\n                            assignToOpen: !this.state.assignToOpen,\n                        })\n                    }\n                    updateMessageConversations={id =>\n                        this.updateMessageConversation('ASSIGNEE', id)\n                    }\n                    messageType={this.props.selectedMessageType}\n                    feedbackRecipientsId={this.props.feedbackRecipientsId}\n                />\n\n                <div style={styles.extendedChoices}>\n                    <IconButton\n                        tooltip={i18n.t('Delete selected')}\n                        onClick={() => {\n                            this.toggleDialog()\n                        }}\n                    >\n                        <Delete />\n                    </IconButton>\n\n                    <IconButton\n                        tooltip={i18n.t('Mark selected as unread')}\n                        onClick={() => {\n                            this.markMessageConversations('unread')\n                        }}\n                    >\n                        <MarkUnread />\n                    </IconButton>\n\n                    <IconButton\n                        tooltip={i18n.t('Mark selected as read')}\n                        onClick={() => {\n                            this.markMessageConversations('read')\n                        }}\n                    >\n                        <Done />\n                    </IconButton>\n                    {this.props.displayExtendedChoices && (\n                        <IconButton\n                            onClick={() =>\n                                this.setState({\n                                    assignToOpen: !this.state.assignToOpen,\n                                })\n                            }\n                            tooltip={i18n.t('Assign selected')}\n                        >\n                            <Assignment />\n                        </IconButton>\n                    )}\n                    {\n                        <IconMenu\n                            iconButtonElement={\n                                <IconButton>\n                                    <MoreVertIcon />\n                                </IconButton>\n                            }\n                            anchorOrigin={{\n                                horizontal: 'left',\n                                vertical: 'top',\n                            }}\n                            targetOrigin={{\n                                horizontal: 'left',\n                                vertical: 'top',\n                            }}\n                        >\n                            <MenuItem\n                                key={'markFollowUp'}\n                                value={'markFollowUp'}\n                                primaryText={i18n.t('Mark for followup')}\n                                onClick={() =>\n                                    this.updateMessageConversation(\n                                        'FOLLOW_UP',\n                                        true\n                                    )\n                                }\n                            />\n                            <MenuItem\n                                key={'clearFollowUp'}\n                                value={'clearFollowUp'}\n                                primaryText={i18n.t('Clear followup')}\n                                onClick={() =>\n                                    this.updateMessageConversation(\n                                        'FOLLOW_UP',\n                                        false\n                                    )\n                                }\n                            />\n                            {this.props.displayExtendedChoices && <Divider />}\n                            {this.props.displayExtendedChoices && (\n                                <MenuItem\n                                    key={'clearAssigned'}\n                                    value={'clearAssigned'}\n                                    primaryText={i18n.t('Clear assignee')}\n                                    onClick={() =>\n                                        this.updateMessageConversation(\n                                            'ASSIGNEE',\n                                            undefined\n                                        )\n                                    }\n                                />\n                            )}\n                            {this.props.displayExtendedChoices && (\n                                <MenuItem\n                                    primaryText={i18n.t('Set status')}\n                                    key={'setStatus'}\n                                    rightIcon={<ArrowDropRight />}\n                                    menuItems={extendedChoices.STATUS.map(\n                                        elem => (\n                                            <MenuItem\n                                                key={`${elem.key}_status`}\n                                                value={elem.value}\n                                                primaryText={elem.primaryText}\n                                                onClick={() =>\n                                                    this.updateMessageConversation(\n                                                        'STATUS',\n                                                        elem.key\n                                                    )\n                                                }\n                                            />\n                                        )\n                                    )}\n                                />\n                            )}\n                            {this.props.displayExtendedChoices && (\n                                <MenuItem\n                                    primaryText={i18n.t('Set priority')}\n                                    key={'setPriority'}\n                                    rightIcon={<ArrowDropRight />}\n                                    menuItems={extendedChoices.PRIORITY.map(\n                                        elem => (\n                                            <MenuItem\n                                                key={`${elem.key}_priority`}\n                                                value={elem.value}\n                                                primaryText={elem.primaryText}\n                                                onClick={() =>\n                                                    this.updateMessageConversation(\n                                                        'PRIORITY',\n                                                        elem.key\n                                                    )\n                                                }\n                                            />\n                                        )\n                                    )}\n                                />\n                            )}\n                        </IconMenu>\n                    }\n                </div>\n                {multiSelect && (\n                    <Subheader style={styles.nrSelected}>\n                        {`${displayNumberOfCheckedIds} ${i18n.t('selected')}`}\n                    </Subheader>\n                )}\n            </div>\n        ) : (\n            <div />\n        )\n    }\n}\n\nToolbarExtendedChoicePicker.propTypes = {\n    checkedIds: propTypes.array,\n    clearCheckedIds: propTypes.func,\n    clearSelectedMessageConversation: propTypes.func,\n    deleteMessageConversations: propTypes.func,\n    displayExtendedChoices: propTypes.bool,\n    feedbackRecipientsId: propTypes.string,\n    markMessageConversations: propTypes.func,\n    selectedMessageConversation: propTypes.object,\n    selectedMessageType: propTypes.object,\n    updateMessageConversations: propTypes.func,\n}\n\nconst mapStateToProps = state => ({\n    selectedMessageType: state.messaging.selectedMessageType,\n    selectedMessageConversation: state.messaging.selectedMessageConversation,\n    checkedIds: state.messaging.checkedIds,\n    feedbackRecipientsId: state.messaging.feedbackRecipientsId,\n})\n\nexport default compose(\n    connect(\n        mapStateToProps,\n        {\n            clearCheckedIds,\n            clearSelectedMessageConversation,\n            deleteMessageConversations,\n            updateMessageConversations,\n            markMessageConversations,\n        },\n        null,\n        { pure: false }\n    )\n)(ToolbarExtendedChoicePicker)\n","import React, { Component } from 'react'\nimport propTypes from '@dhis2/prop-types'\nimport ViewFancy from 'material-ui-icons/ViewList'\nimport ViewList from 'material-ui-icons/ViewHeadline'\nimport FlatButton from 'material-ui/FlatButton'\nimport Paper from 'material-ui/Paper'\nimport CreateMessageIcon from 'material-ui-icons/Add'\nimport NavigationBack from 'material-ui-icons/ArrowBack'\nimport TextField from 'material-ui/TextField'\nimport SelectField from 'material-ui/SelectField'\nimport MenuItem from 'material-ui/MenuItem'\nimport Subheader from 'material-ui/Subheader'\nimport IconMenu from 'material-ui/IconMenu'\nimport IconButton from 'material-ui/IconButton'\nimport Checkbox from 'material-ui/Checkbox/Checkbox'\nimport MoreVertIcon from 'material-ui/svg-icons/navigation/more-vert'\nimport i18n from '@dhis2/d2-i18n'\nimport history from '../../utils/history'\nimport theme from '../../styles/theme'\nimport extendedChoices from '../../constants/extendedChoices'\nimport ToolbarExtendedChoicePicker from './ToolbarExtendedChoicePicker'\nimport { debounce } from '../../utils/helpers'\n\nconst headerHeight = '48px'\nconst searchDelay = 300\n\nconst styles = {\n    canvas(checkedOptions) {\n        return {\n            display: 'flex',\n            justifyContent: 'flex-start',\n            alignItems: 'center',\n            backgroundColor: checkedOptions\n                ? theme.palette.blue50\n                : theme.palette.accent2Color,\n            zIndex: 10,\n        }\n    },\n    checkedOption: {\n        display: 'flex',\n        justifyContent: 'flex-start',\n        minWidth: '200px',\n        margin: '6px 0',\n    },\n    filterControl: {\n        flex: 2,\n        height: headerHeight,\n        marginRight: 16,\n        maxWidth: 256,\n    },\n    rightHandCanvas: {\n        flex: '2 0',\n        display: 'flex',\n        paddingLeft: 16,\n    },\n    // IE11 has buggy support for `justifyContent: flex-end;`\n    // to achieve the same result we use a spacer div\n    ie11Spacer: {\n        flexGrow: 1,\n    },\n    iconMenu: {\n        width: '30px',\n        display: 'flex',\n    },\n}\n\nclass Toolbar extends Component {\n    state = {\n        lastMessageFilter: '',\n    }\n    debouncedSearch = debounce(this.search, searchDelay)\n\n    search(messageFilter) {\n        if (\n            this.props.selectedMessageType &&\n            this.state.lastMessageFilter !== messageFilter\n        ) {\n            this.props.loadMessageConversations(\n                this.props.selectedMessageType,\n                this.props.selectedMessageType.id\n            )\n            this.setState({ lastMessageFilter: messageFilter })\n        }\n    }\n\n    componentDidUpdate(prevProps) {\n        if (\n            prevProps.selectedMessageType &&\n            this.props.selectedMessageType.id !==\n                prevProps.selectedMessageType.id\n        ) {\n            this.debouncedSearch('')\n            this.props.messageFilter !== undefined &&\n                this.props.setFilter(undefined, 'MESSAGE')\n            this.props.statusFilter !== undefined &&\n                this.props.setFilter(undefined, 'STATUS')\n            this.props.priorityFilter !== undefined &&\n                this.props.setFilter(undefined, 'PRIORITY')\n            this.props.assignedToMeFilter &&\n                this.props.setFilter(false, 'ASSIGNED_TO_ME')\n            this.props.markedForFollowUpFilter &&\n                this.props.setFilter(false, 'MARKED_FOR_FOLLOWUP')\n            this.props.unreadFilter && this.props.setFilter(false, 'UNREAD')\n        }\n\n        if (\n            this.props.selectedMessageType !== undefined &&\n            !this.props.selectedMessageType.loading &&\n            (prevProps.statusFilter !== this.props.statusFilter ||\n                prevProps.priorityFilter !== this.props.priorityFilter ||\n                prevProps.assignedToMeFilter !==\n                    this.props.assignedToMeFilter ||\n                prevProps.markedForFollowUpFilter !==\n                    this.props.markedForFollowUpFilter ||\n                prevProps.unreadFilter !== this.props.unreadFilter ||\n                prevProps.selectedMessageType === undefined ||\n                prevProps.selectedMessageType.id !==\n                    this.props.selectedMessageType.id)\n        ) {\n            this.props.loadMessageConversations(\n                this.props.selectedMessageType,\n                this.props.selectedMessageType.id\n            )\n        }\n    }\n\n    render() {\n        const id = this.props.id\n        const displayExtendedChoices = this.props.displayExtendedChoices\n        const checkedOptions = this.props.checkedOptions\n\n        const displaySearch =\n            !this.props.wideview ||\n            (this.props.selectedMessageConversation === undefined &&\n                id !== 'create')\n\n        return (\n            <Paper style={styles.canvas(checkedOptions)}>\n                <div>\n                    {!checkedOptions && (\n                        <FlatButton\n                            style={styles.checkedOption}\n                            icon={<CreateMessageIcon />}\n                            onClick={() => history.push('/PRIVATE/create')}\n                            label={i18n.t('Compose')}\n                        />\n                    )}\n\n                    {checkedOptions && (\n                        <FlatButton\n                            style={styles.checkedOption}\n                            icon={<NavigationBack />}\n                            onClick={() => this.props.clearCheckedIds()}\n                            label={i18n.t('Deselect all')}\n                        />\n                    )}\n                </div>\n\n                <ToolbarExtendedChoicePicker\n                    displayExtendedChoices={displayExtendedChoices}\n                />\n\n                <div style={styles.rightHandCanvas}>\n                    <div style={styles.ie11Spacer} />\n                    {displayExtendedChoices &&\n                        displaySearch &&\n                        !checkedOptions && (\n                            <SelectField\n                                style={styles.filterControl}\n                                labelStyle={{\n                                    color:\n                                        this.props.statusFilter === undefined\n                                            ? 'lightGray'\n                                            : 'black',\n                                    top:\n                                        this.props.statusFilter === undefined\n                                            ? '-15px'\n                                            : '-2px',\n                                }}\n                                selectedMenuItemStyle={{\n                                    color: theme.palette.primary1Color,\n                                }}\n                                floatingLabelText={\n                                    this.props.statusFilter === undefined\n                                        ? i18n.t('Status')\n                                        : ''\n                                }\n                                floatingLabelStyle={{\n                                    top: '15px',\n                                }}\n                                iconStyle={{\n                                    top:\n                                        this.props.statusFilter === undefined\n                                            ? '-15px'\n                                            : '0px',\n                                }}\n                                value={this.props.statusFilter}\n                                onChange={(event, key, payload) => {\n                                    this.props.setFilter(\n                                        payload === null ? undefined : payload,\n                                        'STATUS'\n                                    )\n                                }}\n                            >\n                                <MenuItem\n                                    key={null}\n                                    value={null}\n                                    primaryText={''}\n                                />\n                                {extendedChoices.STATUS.map(elem => (\n                                    <MenuItem\n                                        key={elem.key}\n                                        value={elem.value}\n                                        primaryText={elem.primaryText}\n                                    />\n                                ))}\n                            </SelectField>\n                        )}\n\n                    {displayExtendedChoices &&\n                        displaySearch &&\n                        !checkedOptions && (\n                            <SelectField\n                                style={styles.filterControl}\n                                labelStyle={{\n                                    color:\n                                        this.props.priorityFilter === undefined\n                                            ? 'lightGray'\n                                            : 'black',\n                                    top:\n                                        this.props.priorityFilter === undefined\n                                            ? '-15px'\n                                            : '-2px',\n                                }}\n                                selectedMenuItemStyle={{\n                                    color: theme.palette.primary1Color,\n                                }}\n                                floatingLabelText={\n                                    this.props.priorityFilter === undefined\n                                        ? i18n.t('Priority')\n                                        : ''\n                                }\n                                floatingLabelStyle={{\n                                    top: '15px',\n                                }}\n                                iconStyle={{\n                                    top:\n                                        this.props.priorityFilter === undefined\n                                            ? '-15px'\n                                            : '0px',\n                                }}\n                                value={this.props.priorityFilter}\n                                onChange={(event, key, payload) => {\n                                    this.props.setFilter(\n                                        payload === null ? undefined : payload,\n                                        'PRIORITY'\n                                    )\n                                }}\n                            >\n                                <MenuItem\n                                    key={null}\n                                    value={null}\n                                    primaryText={''}\n                                />\n                                {extendedChoices.PRIORITY.map(elem => (\n                                    <MenuItem\n                                        key={elem.key}\n                                        value={elem.value}\n                                        primaryText={elem.primaryText}\n                                    />\n                                ))}\n                            </SelectField>\n                        )}\n\n                    {!checkedOptions && displaySearch && (\n                        <TextField\n                            style={styles.filterControl}\n                            fullWidth\n                            hintText={i18n.t('Search')}\n                            value={this.props.messageFilter || ''}\n                            onChange={(event, messageFilter) => {\n                                this.debouncedSearch(messageFilter)\n                                this.props.setFilter(messageFilter, 'MESSAGE')\n                            }}\n                            type=\"search\"\n                        />\n                    )}\n\n                    {!checkedOptions && displaySearch && (\n                        <IconMenu\n                            iconButtonElement={\n                                <IconButton>\n                                    <MoreVertIcon />\n                                </IconButton>\n                            }\n                            anchorOrigin={{\n                                horizontal: 'right',\n                                vertical: 'top',\n                            }}\n                            targetOrigin={{\n                                horizontal: 'right',\n                                vertical: 'top',\n                            }}\n                            style={styles.iconMenu}\n                            menuStyle={{ overflowX: 'hidden' }}\n                        >\n                            <Subheader style={{ padding: '0px 16px' }}>\n                                {i18n.t('Set filter')}\n                            </Subheader>\n                            {this.props.displayExtendedChoices && (\n                                <Checkbox\n                                    style={{ padding: '0px 16px' }}\n                                    key={'assignedToMeFilter'}\n                                    label={i18n.t('Assigned to me')}\n                                    checked={this.props.assignedToMeFilter}\n                                    onClick={() => {\n                                        this.props.setFilter(\n                                            !this.props.assignedToMeFilter,\n                                            'ASSIGNED_TO_ME'\n                                        )\n                                    }}\n                                />\n                            )}\n                            <Checkbox\n                                style={{ padding: '0px 16px' }}\n                                key={'markedForFollowUpFilter'}\n                                label={i18n.t('Marked for followup')}\n                                checked={this.props.markedForFollowUpFilter}\n                                onClick={() => {\n                                    this.props.setFilter(\n                                        !this.props.markedForFollowUpFilter,\n                                        'MARKED_FOR_FOLLOWUP'\n                                    )\n                                }}\n                            />\n                            <Checkbox\n                                style={{ padding: '0px 16px' }}\n                                key={'unreadFilter'}\n                                label={i18n.t('Unread messages')}\n                                checked={this.props.unreadFilter}\n                                onClick={() => {\n                                    this.props.setFilter(\n                                        !this.props.unreadFilter,\n                                        'UNREAD'\n                                    )\n                                }}\n                            />\n                        </IconMenu>\n                    )}\n                    <FlatButton\n                        style={{\n                            width: '50px',\n                            alignSelf: 'center',\n                        }}\n                        icon={\n                            !this.props.wideview ? <ViewList /> : <ViewFancy />\n                        }\n                        onClick={() => this.props.toogleWideview()}\n                    />\n                </div>\n            </Paper>\n        )\n    }\n}\nToolbar.propTypes = {\n    assignedToMeFilter: propTypes.bool,\n    checkedOptions: propTypes.bool,\n    clearCheckedIds: propTypes.func,\n    displayExtendedChoices: propTypes.bool,\n    id: propTypes.string,\n    loadMessageConversations: propTypes.func,\n    markedForFollowUpFilter: propTypes.bool,\n    messageFilter: propTypes.string,\n    priorityFilter: propTypes.string,\n    selectedMessageConversation: propTypes.object,\n    selectedMessageType: propTypes.object,\n    setFilter: propTypes.func,\n    statusFilter: propTypes.string,\n    toogleWideview: propTypes.func,\n    unreadFilter: propTypes.bool,\n    wideview: propTypes.bool,\n}\n\nexport default Toolbar\n","import React, { Component } from 'react'\nimport propTypes from '@dhis2/prop-types'\nimport { connect } from 'react-redux'\nimport { compose } from 'recompose'\nimport Subheader from 'material-ui/Subheader/Subheader'\nimport MailIcon from 'material-ui-icons/MailOutline'\nimport i18n from '@dhis2/d2-i18n'\nimport * as api from '../../api/api'\nimport {\n    loadMessageConversations,\n    setIsInFeedbackRecipientGroup,\n    clearCheckedIds,\n    setSelectedMessageConversation,\n    setSelectedMessageType,\n    clearSelectedMessageConversation,\n    updateInputFields,\n    setFilter,\n    setDisplayTimeDiff,\n    clearAttachments,\n    setDhis2CoreVersion,\n} from '../../actions'\nimport theme from '../../styles/theme'\nimport MessageConversation from '../MessageConversation/MessageConversation'\nimport SidebarList from '../List/SidebarList'\nimport MessageConversationList from '../List/MessageConversationList'\nimport CreateMessage from '../MessageConversation/CreateMessage'\nimport Toolbar from '../Common/Toolbar'\nimport { subheader } from '../../styles/style'\nimport './MessagingCenter.css'\n\nconst EXTENDED_CHOICES = ['TICKET', 'VALIDATION_RESULT']\nconst refreshTimerTotal = 300000 // 5 minutes\nconst refreshTimerInterval = 10000 // 10 seconds\n\nclass MessagingCenter extends Component {\n    constructor(props) {\n        super(props)\n\n        this.intervalId = null\n        this.state = {\n            autoRefresh: false,\n            checkedItems: false,\n            refreshTimer: refreshTimerTotal,\n            wideview: true,\n        }\n    }\n\n    componentDidMount() {\n        const selectedMessageType = this.props.match.params.messageType\n        const selectedId = this.props.match.params.messageId\n\n        this.props.setDhis2CoreVersion(this.context.d2.system.version.minor)\n\n        if (\n            selectedId &&\n            selectedId !== selectedMessageType &&\n            selectedId !== 'create'\n        ) {\n            const initialMessageConversation = { id: selectedId }\n            this.props.setSelectedMessageConversation(\n                initialMessageConversation\n            )\n        }\n\n        api.isInFeedbackRecipientGroup(this.props.currentUser).then(result =>\n            this.props.setIsInFeedbackRecipientGroup(result)\n        )\n\n        this.props.messageTypes.map(messageType =>\n            this.props.loadMessageConversations(\n                messageType,\n                selectedMessageType\n            )\n        )\n\n        this.props.setDisplayTimeDiff()\n    }\n\n    componentDidUpdate() {\n        const selectedMessageType = this.props.match.params.messageType\n        const selectedId = this.props.match.params.messageId\n\n        if (\n            !this.props.settingSelectedMessageConversation &&\n            selectedId &&\n            selectedMessageType !== selectedId &&\n            selectedId !== 'create' &&\n            (this.props.selectedMessageConversation === undefined ||\n                selectedId !== this.props.selectedMessageConversation.id)\n        ) {\n            const initialMessageConversation = { id: selectedId }\n            this.props.setSelectedMessageConversation(\n                initialMessageConversation\n            )\n        }\n\n        if (\n            selectedMessageType === selectedId &&\n            selectedMessageType !== this.props.selectedMessageType.id\n        ) {\n            this.props.setSelectedMessageType(selectedMessageType)\n        }\n\n        if (\n            (selectedMessageType === selectedId || selectedId === 'create') &&\n            this.props.selectedMessageConversation !== undefined\n        ) {\n            this.props.clearSelectedMessageConversation()\n        }\n    }\n\n    componentWillUnmount() {\n        if (this.intervalId) {\n            clearInterval(this.intervalId)\n        }\n    }\n\n    setAutoRefresh = autoRefresh => {\n        // Cancel existing interval if it shouldn't autorefresh\n        if (!autoRefresh && this.intervalId) {\n            clearInterval(this.intervalId)\n            this.intervalId = null\n        }\n\n        if (autoRefresh) {\n            this.intervalId = setInterval(this.tick, refreshTimerInterval)\n        }\n\n        this.setState({\n            autoRefresh,\n            refreshTimer: refreshTimerTotal,\n        })\n    }\n\n    tick = () => {\n        const timerHasElapsed =\n            this.state.refreshTimer - refreshTimerInterval <= 0\n\n        if (timerHasElapsed) {\n            this.refresh()\n            this.setState({\n                refreshTimer: refreshTimerTotal,\n            })\n        } else {\n            this.setState(prevState => ({\n                refreshTimer: prevState.refreshTimer - refreshTimerInterval,\n            }))\n        }\n    }\n\n    refresh = () => {\n        this.props.messageTypes.map(messageType =>\n            this.props.loadMessageConversations(\n                messageType,\n                this.props.selectedMessageType\n            )\n        )\n\n        if (this.props.selectedMessageConversation) {\n            this.props.setSelectedMessageConversation(\n                this.props.selectedMessageConversation\n            )\n        }\n    }\n\n    toogleWideview = () => {\n        this.setState({ wideview: !this.state.wideview })\n    }\n\n    render() {\n        const id = this.props.match.params.messageId\n\n        const displayExtendedChoices =\n            (this.props.selectedMessageType\n                ? !!(\n                      EXTENDED_CHOICES.indexOf(\n                          this.props.selectedMessageType.id\n                      ) + 1\n                  )\n                : false) && this.props.isInFeedbackRecipientGroup\n\n        return (\n            <div className=\"messaging-center\">\n                <Toolbar\n                    {...this.props}\n                    id={id}\n                    wideview={this.state.wideview}\n                    displayExtendedChoices={displayExtendedChoices}\n                    toogleWideview={this.toogleWideview}\n                />\n                <div className=\"messaging-center__main-content\">\n                    <SidebarList\n                        {...this.props}\n                        drawerOpen={this.state.drawerOpen}\n                        messageTypes={this.props.messageTypes}\n                        autoRefresh={this.state.autoRefresh}\n                        refreshTimer={this.state.refreshTimer}\n                        setAutoRefresh={this.setAutoRefresh}\n                    />\n\n                    {this.props.selectedMessageConversation === undefined &&\n                        !(this.state.wideview && id === 'create') && (\n                            <MessageConversationList\n                                wideview={this.state.wideview}\n                                displayExtendedChoices={\n                                    displayExtendedChoices &&\n                                    this.state.wideview\n                                }\n                            />\n                        )}\n\n                    {id === 'create' && (\n                        <CreateMessage\n                            {...this.props}\n                            wideview={this.state.wideview}\n                        />\n                    )}\n\n                    {this.props.selectedMessageConversation !== undefined &&\n                        !this.state.wideview && (\n                            <MessageConversationList\n                                wideview={this.state.wideview}\n                                displayExtendedChoices={\n                                    displayExtendedChoices &&\n                                    this.state.wideview\n                                }\n                            />\n                        )}\n\n                    {this.props.selectedMessageConversation && id !== 'create'\n                        ? this.props.selectedMessageConversation !==\n                              undefined && (\n                              <MessageConversation\n                                  {...this.props}\n                                  messageConversation={\n                                      this.props.selectedMessageConversation\n                                  }\n                                  wideview={this.state.wideview}\n                                  disableLink\n                                  displayExtendedChoices={\n                                      displayExtendedChoices\n                                  }\n                              />\n                          )\n                        : !this.state.wideview &&\n                          id !== 'create' && (\n                              <div className=\"messaging-center__no-message-selected\">\n                                  <Subheader style={subheader}>\n                                      {i18n.t('Select a message')}\n                                  </Subheader>\n                                  <MailIcon\n                                      style={{\n                                          color: theme.palette.primary1Color,\n                                          width: 120,\n                                          height: 120,\n                                      }}\n                                  />\n                              </div>\n                          )}\n                </div>\n            </div>\n        )\n    }\n}\n\nMessagingCenter.propTypes = {\n    clearSelectedMessageConversation: propTypes.func,\n    currentUser: propTypes.object,\n    isInFeedbackRecipientGroup: propTypes.bool,\n    loadMessageConversations: propTypes.func,\n    match: propTypes.object,\n    messageTypes: propTypes.array,\n    selectedMessageConversation: propTypes.object,\n    selectedMessageType: propTypes.object,\n    setDhis2CoreVersion: propTypes.func,\n    setDisplayTimeDiff: propTypes.func,\n    setIsInFeedbackRecipientGroup: propTypes.func,\n    setSelectedMessageConversation: propTypes.func,\n    setSelectedMessageType: propTypes.func,\n    settingSelectedMessageConversation: propTypes.bool,\n}\n\nMessagingCenter.contextTypes = {\n    d2: propTypes.object,\n}\n\nconst mapStateToProps = state => ({\n    currentUser: state.messaging.currentUser,\n    snackMessage: state.messaging.snackMessage,\n    messageTypes: state.messaging.messageTypes,\n    messageConversations: state.messaging.messageConversations,\n    messageFilter: state.messaging.messageFilter,\n    statusFilter: state.messaging.statusFilter,\n    priorityFilter: state.messaging.priorityFilter,\n    assignedToMeFilter: state.messaging.assignedToMeFilter,\n    markedForFollowUpFilter: state.messaging.markedForFollowUpFilter,\n    unreadFilter: state.messaging.unreadFilter,\n    selectedMessageType: state.messaging.selectedMessageType,\n    selectedMessageConversation: state.messaging.selectedMessageConversation,\n    settingSelectedMessageConversation:\n        state.messaging.settingSelectedMessageConversation,\n    checkedIds: state.messaging.checkedIds,\n    checkedOptions: state.messaging.checkedIds.length > 0,\n    loaded: state.messaging.loaded,\n    isInFeedbackRecipientGroup: state.messaging.isInFeedbackRecipientGroup,\n    attachments: state.messaging.attachments,\n})\n\nexport default compose(\n    connect(\n        mapStateToProps,\n        {\n            loadMessageConversations,\n            setIsInFeedbackRecipientGroup,\n            clearCheckedIds,\n            setSelectedMessageConversation,\n            setSelectedMessageType,\n            clearSelectedMessageConversation,\n            updateInputFields,\n            setFilter,\n            setDisplayTimeDiff,\n            clearAttachments,\n            setDhis2CoreVersion,\n        },\n        null,\n        { pure: false }\n    )\n)(MessagingCenter)\n","import { Router, Route } from 'react-router-dom'\nimport { Redirect } from 'react-router'\nimport React from 'react'\nimport MessagingCenter from '../MessagingCenter/MessagingCenter'\nimport history from '../../utils/history'\n\nconst Routes = () => (\n    <Router history={history}>\n        <div>\n            <Route\n                exact\n                path=\"/\"\n                component={() => <Redirect to=\"/PRIVATE\" />}\n            />\n            <Route\n                path=\"/:messageType/:messageId?/:recipientId?\"\n                component={MessagingCenter}\n            />\n        </div>\n    </Router>\n)\n\nexport default Routes\n","import React, { useEffect } from 'react'\nimport propTypes from '@dhis2/prop-types'\nimport cx from 'classnames'\nimport { connect } from 'react-redux'\nimport { CircularProgress } from 'material-ui'\n\nimport CustomSnackBar from '../Common/CustomSnackBar'\nimport Routes from './Routes'\nimport { setCurrentUser } from '../../actions'\n\nimport classes from './App.module.css'\n\nconst App = ({ currentUser, setCurrentUser }) => {\n    const { loading, error } = currentUser\n\n    useEffect(() => {\n        setCurrentUser()\n    }, [])\n\n    if (loading) {\n        return (\n            <div className={classes.center}>\n                <CircularProgress size={48} />\n            </div>\n        )\n    }\n\n    if (error) {\n        return <div className={cx(classes.center, classes.error)}>{error}</div>\n    }\n\n    return (\n        <div>\n            <CustomSnackBar />\n            <Routes />\n        </div>\n    )\n}\n\nApp.propTypes = {\n    currentUser: propTypes.object.isRequired,\n    setCurrentUser: propTypes.func.isRequired,\n}\n\nexport default connect(\n    state => ({\n        currentUser: state.messaging.currentUser,\n    }),\n    {\n        setCurrentUser,\n    }\n)(App)\n","const messageTypes = [{\n  id: 'PRIVATE',\n  displayName: 'Inbox',\n  unread: 0,\n  loaded: 0,\n  loading: false,\n  total: 0,\n  page: 1\n}, {\n  id: 'VALIDATION_RESULT',\n  displayName: 'Validation',\n  unread: 0,\n  loaded: 0,\n  loading: false,\n  total: 0,\n  page: 1\n}, {\n  id: 'TICKET',\n  displayName: 'Ticket',\n  unread: 0,\n  loaded: 0,\n  loading: false,\n  total: 0,\n  page: 1\n}, {\n  id: 'SYSTEM',\n  displayName: 'System',\n  unread: 0,\n  loaded: 0,\n  loading: false,\n  total: 0,\n  page: 1\n}];\nexport default messageTypes;","import i18n from '@dhis2/d2-i18n';\nimport log from 'loglevel';\nimport * as actions from '../constants/actions';\nimport messageTypes from '../constants/messageTypes';\nimport { POSITIVE, NEGATIVE, NEUTRAL } from '../constants/development';\nimport { findIndexOfId } from '../utils/helpers';\nexport const initialState = {\n  currentUser: {\n    loading: true,\n    error: null,\n    id: null,\n    authorities: null,\n    userGroups: null\n  },\n  // Message conversation\n  messageConversations: {},\n  messageTypes,\n  selectedMessageType: undefined,\n  selectedMessageConversation: undefined,\n  settingSelectedMessageConversation: false,\n  checkedIds: [],\n  messageFilter: undefined,\n  statusFilter: undefined,\n  priorityFilter: undefined,\n  assignedToMeFilter: false,\n  markedForFollowUpFilter: false,\n  unreadFilter: false,\n  isInFeedbackRecipientGroup: false,\n  feedbackRecipientsId: undefined,\n  displayTimeDiff: 0,\n  // Input for create and reply\n  subject: '',\n  input: '',\n  recipients: [],\n  // Attachments\n  attachments: [],\n  // Snackbar\n  snackMessage: '',\n  onSnackActionClick: undefined,\n  onSnackRequestClose: undefined,\n  snackType: NEUTRAL\n};\n\nfunction messageReducer(state = initialState, action) {\n  const stateMessageTypes = state.messageTypes;\n  const oldAttachments = state.attachments;\n\n  switch (action.type) {\n    case actions.SET_CURRENT_USER:\n      return { ...state,\n        currentUser: {\n          loading: true,\n          error: null,\n          id: null,\n          authorities: null,\n          userGroups: null\n        }\n      };\n\n    case actions.SET_CURRENT_USER_SUCCESS:\n      return { ...state,\n        currentUser: {\n          loading: false,\n          error: null,\n          id: action.payload.id,\n          authorities: action.payload.authorities,\n          userGroups: action.payload.userGroups\n        }\n      };\n\n    case actions.SET_CURRENT_USER_ERROR:\n      return { ...state,\n        currentUser: {\n          loading: false,\n          error: action.payload,\n          id: null,\n          authorities: null,\n          userGroups: null\n        }\n      };\n\n    case actions.SET_DISPLAY_TIME_DIFF_SUCCESS:\n      return { ...state,\n        displayTimeDiff: action.payload,\n        error: action.payload,\n        id: null,\n        authorities: null\n      };\n\n    case actions.MESSAGE_CONVERSATIONS_LOAD_SUCCESS:\n      {\n        const replaceMessageType = stateMessageTypes.find(type => type.id === action.payload.messageType.id);\n        replaceMessageType.loaded = action.payload.messageConversations.length;\n        replaceMessageType.total = action.payload.pager.total;\n        replaceMessageType.unread = action.payload.nrOfUnread;\n        replaceMessageType.page = action.payload.pager.page;\n        replaceMessageType.loading = false;\n        messageTypes.splice([findIndexOfId(stateMessageTypes, replaceMessageType.id)], 1, replaceMessageType);\n        const setSelectedMessageType = action.payload.selectedMessageType === replaceMessageType.id && (action.payload.selectedMessageType === state.selectedMessageType || state.selectedMessageType === undefined);\n        return { ...state,\n          messageTypes,\n          messageConversations: { ...state.messageConversations,\n            [replaceMessageType.id]: action.payload.messageConversations\n          },\n          selectedMessageType: setSelectedMessageType ? replaceMessageType : state.selectedMessageType\n        };\n      }\n\n    case actions.MESSAGE_CONVERSATION_UPDATE_ERROR:\n      return { ...state,\n        snackMessage: action.payload.error.message,\n        snackType: NEGATIVE\n      };\n\n    case actions.MESSAGE_CONVERSATION_UPDATE_SUCCESS:\n      {\n        let snackMessage = '';\n\n        switch (action.payload.identifier) {\n          case 'STATUS':\n            snackMessage = i18n.t('Successfully updated status');\n            break;\n\n          case 'PRIORITY':\n            snackMessage = i18n.t('Successfully updated priority');\n            break;\n\n          case 'ASSIGNEE':\n            snackMessage = i18n.t('Successfully updated assignee');\n            break;\n\n          case 'FOLLOW_UP':\n            snackMessage = i18n.t('Successfully changed followup');\n            break;\n\n          default:\n            log.error('Unexpected identifier for updateMessageConversations success');\n            break;\n        }\n\n        return { ...state,\n          snackMessage,\n          snackType: POSITIVE\n        };\n      }\n\n    case actions.SEND_MESSAGE_ERROR:\n      return { ...state,\n        snackMessage: action.payload.error.message,\n        snackType: NEGATIVE\n      };\n\n    case actions.MESSAGE_CONVERSATIONS_DELETE_ERROR:\n      return { ...state,\n        snackMessage: action.payload.error.message,\n        snackType: NEGATIVE\n      };\n\n    case actions.MESSAGE_CONVERSATIONS_DELETE_SUCCESS:\n      return { ...state,\n        snackMessage: i18n.t('Successfully deleted message conversation(s)'),\n        snackType: POSITIVE\n      };\n\n    case actions.DISPLAY_SNACK_MESSAGE:\n      return { ...state,\n        snackMessage: action.payload.message,\n        snackType: action.payload.snackType,\n        onSnackActionClick: action.payload.onSnackActionClick,\n        onSnackRequestClose: action.payload.onSnackRequestClose\n      };\n\n    case actions.CLEAR_SNACK_MESSAGE:\n      return { ...state,\n        snackMessage: '',\n        snackType: NEUTRAL\n      };\n\n    case actions.SET_CHECKED:\n      {\n        const messageConversation = action.payload.messageConversation;\n        let checkedIds = state.checkedIds;\n\n        if (action.payload.selectedValue) {\n          checkedIds.push(messageConversation);\n        } else {\n          checkedIds = checkedIds.filter(element => element.id !== messageConversation.id);\n        }\n\n        return { ...state,\n          checkedIds\n        };\n      }\n\n    case actions.SET_ALL_CHECKED:\n      return { ...state,\n        checkedIds: action.payload.messageConversationIds\n      };\n\n    case actions.CLEAR_CHECKED:\n      return { ...state,\n        checkedIds: []\n      };\n\n    case actions.SET_SELECTED_MESSAGE_CONVERSATION_SUCCESS:\n      return { ...state,\n        selectedMessageConversation: action.payload.messageConversation,\n        settingSelectedMessageConversation: false\n      };\n\n    case actions.SET_SELECTED_MESSAGE_CONVERSATION:\n      return { ...state,\n        settingSelectedMessageConversation: true\n      };\n\n    case actions.CLEAR_SELECTED_MESSAGE_CONVERSATION:\n      return { ...state,\n        selectedMessageConversation: undefined\n      };\n\n    case actions.SET_SELECTED_MESSAGE_TYPE:\n      return { ...state,\n        checkedIds: [],\n        selectedMessageType: stateMessageTypes.find(type => type.id === action.payload.messageTypeId),\n        selectedMessageConversations: state.messageConversations[action.payload.messageTypeId],\n        selectedMessageConversation: undefined\n      };\n\n    case actions.UPDATE_INPUT_FIELDS:\n      return { ...state,\n        subject: action.payload.subject,\n        input: action.payload.input,\n        recipients: action.payload.recipients\n      };\n\n    case actions.ADD_RECIPIENT_BY_ID_SUCCESS:\n      return { ...state,\n        recipients: [...state.recipients, action.payload]\n      };\n\n    case actions.SET_FILTER:\n      return { ...state,\n        messageFilter: action.payload.filterType === 'MESSAGE' ? action.payload.filter : state.messageFilter,\n        statusFilter: action.payload.filterType === 'STATUS' ? action.payload.filter : state.statusFilter,\n        priorityFilter: action.payload.filterType === 'PRIORITY' ? action.payload.filter : state.priorityFilter,\n        assignedToMeFilter: action.payload.filterType === 'ASSIGNED_TO_ME' ? action.payload.filter : state.assignedToMeFilter,\n        markedForFollowUpFilter: action.payload.filterType === 'MARKED_FOR_FOLLOWUP' ? action.payload.filter : state.markedForFollowUpFilter,\n        unreadFilter: action.payload.filterType === 'UNREAD' ? action.payload.filter : state.unreadFilter\n      };\n\n    case actions.LOAD_MESSAGE_CONVERSATIONS:\n      {\n        const loadingMessageType = action.payload.messageType;\n        loadingMessageType.loading = true;\n\n        if (action.payload.loadMore) {\n          loadingMessageType.page++;\n        }\n\n        messageTypes[findIndexOfId(messageTypes, loadingMessageType.id)] = loadingMessageType; // TODO: This can probably be removed because action.payload.messageType === state.selectedMessageType\n\n        const selectedMessageType = state.selectedMessageType;\n\n        if (selectedMessageType) {\n          selectedMessageType.loading = true;\n\n          if (action.payload.loadMore) {\n            selectedMessageType.page++;\n          }\n        }\n\n        return { ...state,\n          messageTypes,\n          selectedMessageType\n        };\n      }\n\n    case actions.SET_IN_FEEDBACK_RECIPIENT_GROUP:\n      return { ...state,\n        isInFeedbackRecipientGroup: action.payload.isInFeedbackRecipientGroup.authorized,\n        feedbackRecipientsId: action.payload.isInFeedbackRecipientGroup.feedbackRecipientsId\n      };\n\n    case actions.ADD_ATTACHMENT_SUCCESS:\n      return { ...state,\n        attachments: state.attachments.map(attachment => attachment.name === action.payload.name ? {\n          id: action.payload.id,\n          name: attachment.name,\n          contentLength: attachment.contentLength,\n          loading: false\n        } : attachment)\n      };\n\n    case actions.ADD_ATTACHMENT_ERROR:\n      return { ...state,\n        attachments: oldAttachments.filter(attachment => attachment.id !== action.payload.attachmentId),\n        snackMessage: action.payload.error.message,\n        snackType: NEGATIVE\n      };\n\n    case actions.ADD_ATTACHMENT:\n      return { ...state,\n        attachments: state.attachments.concat({\n          name: action.payload.name,\n          contentLength: action.payload.size,\n          loading: true\n        })\n      };\n\n    case actions.REMOVE_ATTACHMENT:\n      return { ...state,\n        attachments: oldAttachments.filter(attachment => attachment.id !== action.payload.attachmentId)\n      };\n\n    case actions.CANCEL_ATTACHMENT:\n      return { ...state,\n        attachments: oldAttachments.filter(attachment => attachment.name !== action.payload.attachmentName)\n      };\n\n    case actions.CLEAR_ATTACHMENTS:\n      return { ...state,\n        attachments: []\n      };\n\n    case actions.SET_DHIS2_CORE_VERSION:\n      return { ...state,\n        dhis2CoreVersion: action.payload\n      };\n\n    default:\n      return state;\n  }\n}\n\nexport default messageReducer;","import { createStore, applyMiddleware, combineReducers, compose } from 'redux';\nimport ReduxThunk from 'redux-thunk';\nimport messageReducer from './reducers/messageReducer';\nconst middlewares = [ReduxThunk];\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\nconst reducer = combineReducers({\n  messaging: messageReducer\n});\nexport default createStore(reducer, composeEnhancers(applyMiddleware(...middlewares)));","import React from 'react'\nimport propTypes from '@dhis2/prop-types'\nimport MuiThemeProvider from 'material-ui/styles/MuiThemeProvider'\nimport theme from '../../styles/theme'\n\nclass AddD2Context extends React.Component {\n    getChildContext = () => ({\n        d2: this.props.d2,\n    })\n\n    render = () => (\n        <MuiThemeProvider muiTheme={theme}>\n            {this.props.children}\n        </MuiThemeProvider>\n    )\n}\n\nAddD2Context.propTypes = {\n    children: propTypes.object.isRequired,\n    d2: propTypes.object,\n}\n\nAddD2Context.childContextTypes = {\n    d2: propTypes.object,\n}\n\nexport default AddD2Context\n","import React from 'react'\nimport { useConfig, useDataEngine } from '@dhis2/app-runtime'\nimport { useD2 } from '@dhis2/app-runtime-adapter-d2'\nimport { CircularProgress } from 'material-ui'\nimport { Provider } from 'react-redux'\n\nimport App from './App'\nimport store from '../../store'\nimport { setEngine } from '../../api/api'\nimport AddD2Context from './AddD2Context'\n\nimport '../../index.css'\nimport 'typeface-roboto'\n\nconst AppWrapper = () => {\n    const { baseUrl } = useConfig()\n    const engine = useDataEngine()\n    const { d2 } = useD2({\n        d2Config: {\n            schemas: ['messageConversation'],\n            // This app prefers doing unversioned API calls\n            baseUrl: `${baseUrl}/api`,\n        },\n    })\n\n    if (!d2) {\n        return (\n            <AddD2Context>\n                <div className=\"page-loader-wrap\">\n                    <CircularProgress size={48} />\n                </div>\n            </AddD2Context>\n        )\n    }\n\n    // This makes the engine instance available in the api module\n    setEngine(engine)\n\n    return (\n        <Provider store={store}>\n            <AddD2Context d2={d2}>\n                <App />\n            </AddD2Context>\n        </Provider>\n    )\n}\n\nexport default AppWrapper\n"],"sourceRoot":""}